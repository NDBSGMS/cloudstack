(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f4a6c92"],{d04c:function(t,e,a){},dacc:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-spin",{attrs:{spinning:t.loading}},[a("a-form",{staticClass:"form",attrs:{form:t.form,layout:"vertical"},on:{submit:t.handleSubmit}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("a-alert",{attrs:{type:"warning"}},[a("span",{attrs:{slot:"message"},domProps:{innerHTML:t._s(t.$t("message.confirm.attach.disk"))},slot:"message"})])],1),a("a-form-item",{attrs:{label:t.$t("label.virtualmachineid")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["virtualmachineid",{rules:[{required:!0,message:t.$t("message.error.select")}]}],expression:"['virtualmachineid', {\n          rules: [{ required: true, message: $t('message.error.select') }]\n        }]"}],attrs:{placeholder:t.apiParams.virtualmachineid.description}},t._l(t.virtualmachines,(function(e){return a("a-select-option",{key:e.id},[t._v(" "+t._s(e.name||e.displayname)+" ")])})),1)],1)],1),a("div",{staticClass:"actions"},[a("a-button",{on:{click:t.closeAction}},[t._v(t._s(t.$t("label.cancel")))]),a("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("label.ok")))])],1)],1)},r=[],s=(a("99af"),a("4160"),a("b0c0"),a("d3b7"),a("159b"),a("365c")),o={name:"AttachVolume",props:{resource:{type:Object,required:!0}},inject:["parentFetchData"],data:function(){return{virtualmachines:[],loading:!0}},beforeCreate:function(){var t=this;this.form=this.$form.createForm(this),this.apiConfig=this.$store.getters.apis.attachVolume||{},this.apiParams={},this.apiConfig.params.forEach((function(e){t.apiParams[e.name]=e}))},mounted:function(){this.fetchData()},methods:{fetchData:function(){var t=this,e={zoneid:this.resource.zoneid};this.resource.hypervisor&&"None"!==this.resource.hypervisor&&(e.hypervisor=this.resource.hypervisor),this.resource.projectid?e.projectid=this.resource.projectid:(e.account=this.resource.account,e.domainid=this.resource.domainid),this.loading=!0;var a=["Running","Stopped"];a.forEach((function(a){e.state=a,Object(s["a"])("listVirtualMachines",e).then((function(e){t.virtualmachines=t.virtualmachines.concat(e.listvirtualmachinesresponse.virtualmachine||[])})).catch((function(e){t.$notifyError(e)})).finally((function(){t.loading=!1}))}))},closeAction:function(){this.$emit("close-action")},handleSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t,a){t||(e.loading=!0,Object(s["a"])("attachVolume",{id:e.resource.id,virtualmachineid:a.virtualmachineid}).then((function(t){e.$store.dispatch("AddAsyncJob",{title:e.$t("label.action.attach.disk"),jobid:t.attachvolumeresponse.jobid,status:"progress"}),e.$pollJob({jobId:t.attachvolumeresponse.jobid,successMethod:function(){e.parentFetchData()},errorMessage:"".concat(e.$t("message.attach.volume.failed"),": ").concat(e.resource.name||e.resource.id),loadingMessage:"".concat(e.$t("message.attach.volume.progress"),": ").concat(e.resource.name||e.resource.id),catchMessage:e.$t("error.fetching.async.job.result")}),e.closeAction()})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1,e.parentFetchData()})))}))}}},n=o,c=(a("e978"),a("2877")),l=Object(c["a"])(n,i,r,!1,null,"da81c558",null);e["default"]=l.exports},e978:function(t,e,a){"use strict";var i=a("d04c"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-4f4a6c92.72969b7a.js.map