{"version":3,"sources":["webpack:///./src/views/compute/UpgradeKubernetesCluster.vue?71ab","webpack:///./src/views/compute/UpgradeKubernetesCluster.vue?664e","webpack:///src/views/compute/UpgradeKubernetesCluster.vue","webpack:///./src/views/compute/UpgradeKubernetesCluster.vue?3947","webpack:///./src/views/compute/UpgradeKubernetesCluster.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","loading","domProps","_s","$t","slot","form","on","handleSubmit","_v","apiParams","kubernetesversionid","description","staticStyle","directives","name","rawName","value","rules","required","expression","input","option","componentOptions","children","text","toLowerCase","indexOf","kubernetesVersionLoading","_l","opt","optIndex","key","closeAction","staticRenderFns","props","resource","type","Object","data","kubernetesVersions","minCpu","minMemory","beforeCreate","$form","createForm","apiConfig","$store","getters","apis","upgradeKubernetesCluster","params","forEach","created","mounted","fetchData","methods","fetchKubernetesVersionData","isValidValueForKey","obj","arrayHasItems","array","undefined","Array","isArray","length","isObjectEmpty","keys","constructor","minimumkubernetesversionid","clusterVersion","j","versionObjs","id","i","e","preventDefault","validateFields","err","title","jobid","jobId","status","loadingMessage","catchMessage","successMessage","successMethod","$emit","component"],"mappings":"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","file":"js/chunk-2ca83b28.6ba7dbe2.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpgradeKubernetesCluster.vue?vue&type=style&index=0&id=62c365dd&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpgradeKubernetesCluster.vue?vue&type=style&index=0&id=62c365dd&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"form-layout\"},[_c('a-spin',{attrs:{\"spinning\":_vm.loading}},[_c('a-alert',{attrs:{\"type\":\"warning\"}},[_c('span',{attrs:{\"slot\":\"message\"},domProps:{\"innerHTML\":_vm._s(_vm.$t('message.kubernetes.cluster.upgrade'))},slot:\"message\"})]),_c('br'),_c('a-form',{attrs:{\"form\":_vm.form,\"layout\":\"vertical\"},on:{\"submit\":_vm.handleSubmit}},[_c('a-form-item',[_c('span',{attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\" \"+_vm._s(_vm.$t('label.kubernetesversionid'))+\" \"),_c('a-tooltip',{attrs:{\"title\":_vm.apiParams.kubernetesversionid.description}},[_c('a-icon',{staticStyle:{\"color\":\"rgba(0,0,0,.45)\"},attrs:{\"type\":\"info-circle\"}})],1)],1),_c('a-select',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['kubernetesversionid', {\n            rules: [{ required: true }]\n          }]),expression:\"['kubernetesversionid', {\\n            rules: [{ required: true }]\\n          }]\"}],attrs:{\"id\":\"version-selection\",\"showSearch\":\"\",\"optionFilterProp\":\"children\",\"filterOption\":function (input, option) {\n            return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n          },\"loading\":_vm.kubernetesVersionLoading,\"placeholder\":_vm.apiParams.kubernetesversionid.description}},_vm._l((this.kubernetesVersions),function(opt,optIndex){return _c('a-select-option',{key:optIndex},[_vm._v(\" \"+_vm._s(opt.name || opt.description)+\" \")])}),1)],1),_c('div',{staticClass:\"action-button\",attrs:{\"span\":24}},[_c('a-button',{on:{\"click\":_vm.closeAction}},[_vm._v(_vm._s(this.$t('label.cancel')))]),_c('a-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},on:{\"click\":_vm.handleSubmit}},[_vm._v(_vm._s(this.$t('label.ok')))])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <div class=\"form-layout\">\n    <a-spin :spinning=\"loading\">\n      <a-alert type=\"warning\">\n        <span slot=\"message\" v-html=\"$t('message.kubernetes.cluster.upgrade')\" />\n      </a-alert>\n      <br />\n      <a-form\n        :form=\"form\"\n        @submit=\"handleSubmit\"\n        layout=\"vertical\">\n        <a-form-item>\n          <span slot=\"label\">\n            {{ $t('label.kubernetesversionid') }}\n            <a-tooltip :title=\"apiParams.kubernetesversionid.description\">\n              <a-icon type=\"info-circle\" style=\"color: rgba(0,0,0,.45)\" />\n            </a-tooltip>\n          </span>\n          <a-select\n            id=\"version-selection\"\n            v-decorator=\"['kubernetesversionid', {\n              rules: [{ required: true }]\n            }]\"\n            showSearch\n            optionFilterProp=\"children\"\n            :filterOption=\"(input, option) => {\n              return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n            }\"\n            :loading=\"kubernetesVersionLoading\"\n            :placeholder=\"apiParams.kubernetesversionid.description\">\n            <a-select-option v-for=\"(opt, optIndex) in this.kubernetesVersions\" :key=\"optIndex\">\n              {{ opt.name || opt.description }}\n            </a-select-option>\n          </a-select>\n        </a-form-item>\n\n        <div :span=\"24\" class=\"action-button\">\n          <a-button @click=\"closeAction\">{{ this.$t('label.cancel') }}</a-button>\n          <a-button :loading=\"loading\" type=\"primary\" @click=\"handleSubmit\">{{ this.$t('label.ok') }}</a-button>\n        </div>\n      </a-form>\n    </a-spin>\n  </div>\n</template>\n\n<script>\nimport { api } from '@/api'\n\nexport default {\n  name: 'UpgradeKubernetesCluster',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    }\n  },\n  data () {\n    return {\n      kubernetesVersions: [],\n      kubernetesVersionLoading: false,\n      minCpu: 2,\n      minMemory: 2048,\n      loading: false\n    }\n  },\n  beforeCreate () {\n    this.form = this.$form.createForm(this)\n    this.apiConfig = this.$store.getters.apis.upgradeKubernetesCluster || {}\n    this.apiParams = {}\n    this.apiConfig.params.forEach(param => {\n      this.apiParams[param.name] = param\n    })\n  },\n  created () {\n  },\n  mounted () {\n    this.fetchData()\n  },\n  methods: {\n    fetchData () {\n      this.fetchKubernetesVersionData()\n    },\n    isValidValueForKey (obj, key) {\n      return key in obj && obj[key] != null\n    },\n    arrayHasItems (array) {\n      return array !== null && array !== undefined && Array.isArray(array) && array.length > 0\n    },\n    isObjectEmpty (obj) {\n      return !(obj !== null && obj !== undefined && Object.keys(obj).length > 0 && obj.constructor === Object)\n    },\n    fetchKubernetesVersionData () {\n      this.kubernetesVersions = []\n      const params = {}\n      if (!this.isObjectEmpty(this.resource)) {\n        params.minimumkubernetesversionid = this.resource.kubernetesversionid\n      }\n      this.kubernetesVersionLoading = true\n      api('listKubernetesSupportedVersions', params).then(json => {\n        const versionObjs = json.listkubernetessupportedversionsresponse.kubernetessupportedversion\n        if (this.arrayHasItems(versionObjs)) {\n          var clusterVersion = null\n          for (var j = 0; j < versionObjs.length; j++) {\n            if (versionObjs[j].id === this.resource.kubernetesversionid) {\n              clusterVersion = versionObjs[j]\n              break\n            }\n          }\n          for (var i = 0; i < versionObjs.length; i++) {\n            if (versionObjs[i].id !== this.resource.kubernetesversionid &&\n              (clusterVersion == null || (clusterVersion != null && versionObjs[i].semanticversion !== clusterVersion.semanticversion)) &&\n              versionObjs[i].state === 'Enabled' && versionObjs[i].isostate === 'Ready') {\n              this.kubernetesVersions.push({\n                id: versionObjs[i].id,\n                description: versionObjs[i].name\n              })\n            }\n          }\n        }\n      }).finally(() => {\n        this.kubernetesVersionLoading = false\n        if (this.arrayHasItems(this.kubernetesVersions)) {\n          this.form.setFieldsValue({\n            kubernetesversionid: 0\n          })\n        }\n      })\n    },\n    handleSubmit (e) {\n      e.preventDefault()\n      this.form.validateFields((err, values) => {\n        if (err) {\n          return\n        }\n        this.loading = true\n        const params = {\n          id: this.resource.id\n        }\n        if (this.isValidValueForKey(values, 'kubernetesversionid') && this.arrayHasItems(this.kubernetesVersions)) {\n          params.kubernetesversionid = this.kubernetesVersions[values.kubernetesversionid].id\n        }\n        api('upgradeKubernetesCluster', params).then(json => {\n          this.$emit('refresh-data')\n          const jobId = json.upgradekubernetesclusterresponse.jobid\n          this.$store.dispatch('AddAsyncJob', {\n            title: this.$t('label.kubernetes.cluster.upgrade'),\n            jobid: jobId,\n            description: this.resource.name,\n            status: 'progress'\n          })\n          this.$pollJob({\n            jobId,\n            loadingMessage: `${this.$t('label.kubernetes.cluster.upgrade')} ${this.resource.name} ${this.$t('label.in.progress')}`,\n            catchMessage: this.$t('error.fetching.async.job.result'),\n            successMessage: `${this.$t('message.success.upgrade.kubernetes')} ${this.resource.name}`,\n            successMethod: result => {\n              this.$emit('refresh-data')\n            }\n          })\n          this.$emit('refresh-data')\n          this.closeAction()\n        }).catch(error => {\n          this.$notifyError(error)\n        }).finally(() => {\n          this.loading = false\n        })\n      })\n    },\n    closeAction () {\n      this.$emit('close-action')\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n  .form-layout {\n    width: 60vw;\n\n    @media (min-width: 500px) {\n      width: 450px;\n    }\n  }\n\n  .action-button {\n    text-align: right;\n\n    button {\n      margin-right: 5px;\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpgradeKubernetesCluster.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpgradeKubernetesCluster.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UpgradeKubernetesCluster.vue?vue&type=template&id=62c365dd&scoped=true&\"\nimport script from \"./UpgradeKubernetesCluster.vue?vue&type=script&lang=js&\"\nexport * from \"./UpgradeKubernetesCluster.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UpgradeKubernetesCluster.vue?vue&type=style&index=0&id=62c365dd&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"62c365dd\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}