{"version":3,"sources":["webpack:///./src/components/view/DetailSettings.vue?9a39","webpack:///./node_modules/core-js/modules/es.string.trim.js","webpack:///./src/components/view/DetailSettings.vue?a35f","webpack:///src/components/view/DetailSettings.vue","webpack:///./src/components/view/DetailSettings.vue?658f","webpack:///./src/components/view/DetailSettings.vue","webpack:///./node_modules/core-js/internals/string-trim-forced.js"],"names":["$","$trim","trim","forcedStringTrimMethod","target","proto","forced","this","render","_vm","_h","$createElement","_c","_self","attrs","loading","$t","directives","name","rawName","value","showAddDetail","expression","staticStyle","$store","getters","apis","isAdminOrOwner","on","onShowAddDetail","_v","_s","ref","staticClass","filterOption","newKey","Object","keys","detailOptions","e","onAddInputChange","newValue","slot","addDetail","closeDetail","error","_e","_l","item","index","key","val","handleInputChange","updateDetail","disableSettings","allowEditOfDetail","$event","hideEditDetail","edit","showEditDetail","deleteDetail","staticRenderFns","props","resource","type","required","data","details","resourceType","watch","updateResource","newItem","mounted","methods","$route","meta","map","readonlyuidetails","split","originalValue","$set","obj","includes","userInfo","roletype","runApi","apiName","length","params","cleanupdetails","forEach","json","updatevirtualmachineresponse","virtualmachine","updatetemplateresponse","template","$notification","message","description","push","splice","setTimeout","component","fails","whitespaces","non","module","exports","METHOD_NAME"],"mappings":"kHAAA,yBAAokB,EAAG,G,oCCCvkB,IAAIA,EAAI,EAAQ,QACZC,EAAQ,EAAQ,QAA4BC,KAC5CC,EAAyB,EAAQ,QAIrCH,EAAE,CAAEI,OAAQ,SAAUC,OAAO,EAAMC,OAAQH,EAAuB,SAAW,CAC3ED,KAAM,WACJ,OAAOD,EAAMM,U,gECTjB,IAAIC,EAAS,WAAa,IAAIC,EAAIF,KAASG,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,SAAS,CAACE,MAAM,CAAC,SAAWL,EAAIM,UAAU,CAAEN,EAAmB,gBAAEG,EAAG,UAAU,CAACE,MAAM,CAAC,OAAS,GAAG,QAAUL,EAAIO,GAAG,iDAAiDJ,EAAG,MAAM,CAACA,EAAG,MAAM,CAACK,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,OAAQX,EAAIY,cAAeC,WAAW,oBAAoB,CAACV,EAAG,WAAW,CAACW,YAAY,CAAC,MAAQ,QAAQT,MAAM,CAAC,KAAO,SAAS,KAAO,OAAO,WAAa,mBAAoBL,EAAIe,OAAOC,QAAQC,MAAQ,yBAA0BjB,EAAIe,OAAOC,QAAQC,MAAQjB,EAAIkB,mBAAmBC,GAAG,CAAC,MAAQnB,EAAIoB,kBAAkB,CAACpB,EAAIqB,GAAG,IAAIrB,EAAIsB,GAAGtB,EAAIO,GAAG,sBAAsB,QAAQ,GAAGJ,EAAG,MAAM,CAACK,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOX,EAAiB,cAAEa,WAAW,mBAAmB,CAACV,EAAG,gBAAgB,CAACE,MAAM,CAAC,KAAO,OAAO,QAAU,KAAK,CAACF,EAAG,kBAAkB,CAACoB,IAAI,SAASC,YAAY,eAAenB,MAAM,CAAC,aAAeL,EAAIyB,aAAa,MAAQzB,EAAI0B,OAAO,WAAaC,OAAOC,KAAK5B,EAAI6B,eAAe,YAAc7B,EAAIO,GAAG,eAAeY,GAAG,CAAC,OAAS,SAAUW,GAAK,OAAO9B,EAAI+B,iBAAiBD,EAAG,cAAgB3B,EAAG,UAAU,CAACW,YAAY,CAAC,MAAQ,OAAO,cAAc,IAAI,iBAAiB,OAAO,gBAAkB,QAAQT,MAAM,CAAC,YAAc,IAAI,SAAW,MAAMF,EAAG,kBAAkB,CAACqB,YAAY,eAAenB,MAAM,CAAC,aAAeL,EAAIyB,aAAa,MAAQzB,EAAIgC,SAAS,WAAahC,EAAI6B,cAAc7B,EAAI0B,QAAQ,YAAc1B,EAAIO,GAAG,gBAAgBY,GAAG,CAAC,OAAS,SAAUW,GAAK,OAAO9B,EAAI+B,iBAAiBD,EAAG,gBAAkB3B,EAAG,YAAY,CAACE,MAAM,CAAC,mBAAqB,GAAG,UAAY,aAAa,CAACF,EAAG,WAAW,CAAC8B,KAAK,SAAS,CAACjC,EAAIqB,GAAG,IAAIrB,EAAIsB,GAAGtB,EAAIO,GAAG,sBAAsB,OAAOJ,EAAG,WAAW,CAACqB,YAAY,gBAAgBnB,MAAM,CAAC,KAAO,SAASc,GAAG,CAAC,MAAQnB,EAAIkC,cAAc,GAAG/B,EAAG,YAAY,CAACE,MAAM,CAAC,mBAAqB,GAAG,UAAY,aAAa,CAACF,EAAG,WAAW,CAAC8B,KAAK,SAAS,CAACjC,EAAIqB,GAAG,IAAIrB,EAAIsB,GAAGtB,EAAIO,GAAG,iBAAiB,OAAOJ,EAAG,WAAW,CAACqB,YAAY,gBAAgBnB,MAAM,CAAC,KAAO,SAASc,GAAG,CAAC,MAAQnB,EAAImC,gBAAgB,IAAI,GAAInC,EAAS,MAAEG,EAAG,IAAI,CAACW,YAAY,CAAC,MAAQ,QAAQ,CAACd,EAAIqB,GAAG,IAAIrB,EAAIsB,GAAGtB,EAAIO,GAAGP,EAAIoC,QAAQ,OAAOpC,EAAIqC,MAAM,KAAKlC,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,UAAUL,EAAIsC,GAAItC,EAAW,SAAE,SAASuC,EAAKC,GAAO,OAAOrC,EAAG,cAAc,CAACsC,IAAID,GAAO,CAACrC,EAAG,mBAAmB,CAACA,EAAG,OAAO,CAACE,MAAM,CAAC,KAAO,SAAS4B,KAAK,SAAS,CAACjC,EAAIqB,GAAG,IAAIrB,EAAIsB,GAAGiB,EAAK9B,MAAM,OAAON,EAAG,OAAO,CAACW,YAAY,CAAC,aAAa,aAAaT,MAAM,CAAC,KAAO,eAAe4B,KAAK,eAAe,CAAEM,EAAS,KAAEpC,EAAG,OAAO,CAACW,YAAY,CAAC,QAAU,SAAS,CAACX,EAAG,kBAAkB,CAACW,YAAY,CAAC,MAAQ,QAAQT,MAAM,CAAC,MAAQkC,EAAK5B,MAAM,WAAaX,EAAI6B,cAAcU,EAAK9B,OAAOU,GAAG,CAAC,OAAS,SAAUuB,GAAO,OAAO1C,EAAI2C,kBAAkBD,EAAKF,IAAU,WAAa,SAAUV,GAAK,OAAO9B,EAAI4C,aAAaJ,QAAc,GAAGrC,EAAG,OAAO,CAACH,EAAIqB,GAAGrB,EAAIsB,GAAGiB,EAAK5B,eAAgBX,EAAI6C,iBAAmB,mBAAoB7C,EAAIe,OAAOC,QAAQC,MACp2F,yBAA0BjB,EAAIe,OAAOC,QAAQC,MAAQjB,EAAIkB,kBAAoBlB,EAAI8C,kBAAkBP,EAAK9B,MAAON,EAAG,MAAM,CAACE,MAAM,CAAC,KAAO,WAAW4B,KAAK,WAAW,CAAEM,EAAS,KAAEpC,EAAG,WAAW,CAACE,MAAM,CAAC,MAAQ,SAAS,KAAO,WAAWc,GAAG,CAAC,MAAQ,SAAS4B,GAAQ,OAAO/C,EAAI4C,aAAaJ,MAAU,CAACrC,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,eAAe,MAAQ,UAAU,aAAe,cAAc,GAAGL,EAAIqC,KAAME,EAAS,KAAEpC,EAAG,WAAW,CAACE,MAAM,CAAC,MAAQ,SAAS,KAAO,WAAWc,GAAG,CAAC,MAAQ,SAAS4B,GAAQ,OAAO/C,EAAIgD,eAAeR,MAAU,CAACrC,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,eAAe,MAAQ,UAAU,aAAe,cAAc,GAAGL,EAAIqC,KAAOE,EAAKU,KAA8HjD,EAAIqC,KAA5HlC,EAAG,WAAW,CAACE,MAAM,CAAC,MAAQ,SAAS,KAAO,QAAQc,GAAG,CAAC,MAAQ,SAAS4B,GAAQ,OAAO/C,EAAIkD,eAAeV,QAAqB,GAAGxC,EAAIqC,MAAOrC,EAAI6C,iBAAmB,mBAAoB7C,EAAIe,OAAOC,QAAQC,MACp1B,yBAA0BjB,EAAIe,OAAOC,QAAQC,MAAQjB,EAAIkB,kBAAoBlB,EAAI8C,kBAAkBP,EAAK9B,MAAON,EAAG,MAAM,CAACE,MAAM,CAAC,KAAO,WAAW4B,KAAK,WAAW,CAAC9B,EAAG,eAAe,CAACE,MAAM,CAAC,MAAUL,EAAIO,GAAG,wBAA2B,IAAK,OAASP,EAAIO,GAAG,aAAa,WAAaP,EAAIO,GAAG,YAAY,UAAY,QAAQY,GAAG,CAAC,QAAU,SAAS4B,GAAQ,OAAO/C,EAAImD,aAAaX,MAAU,CAACrC,EAAG,WAAW,CAACE,MAAM,CAAC,MAAQ,SAAS,KAAO,SAAS,KAAO,aAAa,IAAI,GAAGL,EAAIqC,MAAM,MAAK,IAAI,IAC5ee,EAAkB,G,gJC2HtB,GACE3C,KAAM,iBACN4C,MAAO,CACLC,SAAU,CACRC,KAAM5B,OACN6B,UAAU,IAGdC,KARF,WASI,MAAO,CACLC,QAAS,GACT7B,cAAe,GACfjB,eAAe,EACfiC,iBAAiB,EACjBnB,OAAQ,GACRM,SAAU,GACV1B,SAAS,EACTqD,aAAc,SACdvB,OAAO,IAGXwB,MAAO,CACLN,SAAU,SAAd,KACMxD,KAAK+D,eAAeC,KAGxBC,QA1BF,WA2BIjE,KAAK+D,eAAe/D,KAAKwD,WAE3BU,QAAS,CACPvC,aADJ,SACA,KACM,OACN,+EAGIoC,eANJ,SAMA,cACM/D,KAAK4D,QAAU,GACVJ,IAGLxD,KAAKwD,SAAWA,EAChBxD,KAAK6D,aAAe7D,KAAKmE,OAAOC,KAAKP,aACjCL,EAASI,UACX5D,KAAK4D,QAAU/B,OAAOC,KAAK9B,KAAKwD,SAASI,SAASS,KAAI,SAA9D,GACU,MAAO,CAAjB,gDAGM,OAAN,OAAM,CAAN,oGACQ,EAAR,mEAEMrE,KAAK+C,gBAAX,OAA6B,KAA7B,oDAEIC,kBAvBJ,SAuBA,GACM,OAAIhD,KAAKwD,SAASc,oBACZtE,KAAKwD,SAASc,kBAAkBC,MAAM,KAAKF,KAAI,SAA3D,mCAMIjB,eA/BJ,SA+BA,GACMpD,KAAK4D,QAAQlB,GAAOS,MAAO,EAC3BnD,KAAK4D,QAAQlB,GAAO8B,cAAgBxE,KAAK4D,QAAQlB,GAAO7B,MACxDb,KAAKyE,KAAKzE,KAAK4D,QAASlB,EAAO1C,KAAK4D,QAAQlB,KAE9CQ,eApCJ,SAoCA,GACMlD,KAAK4D,QAAQlB,GAAOS,MAAO,EAC3BnD,KAAK4D,QAAQlB,GAAO7B,MAAQb,KAAK4D,QAAQlB,GAAO8B,cAChDxE,KAAKyE,KAAKzE,KAAK4D,QAASlB,EAAO1C,KAAK4D,QAAQlB,KAE9CG,kBAzCJ,SAyCA,KACM7C,KAAK4D,QAAQlB,GAAO7B,MAAQ+B,EAC5B5C,KAAKyE,KAAKzE,KAAK4D,QAASlB,EAAO1C,KAAK4D,QAAQlB,KAE9CT,iBA7CJ,SA6CA,KACMjC,KAAKsC,OAAQ,EACbtC,KAAK0E,GAAO9B,GAEdxB,eAjDJ,WAkDM,MAAO,CAAC,SAASuD,SAAS3E,KAAKiB,OAAOC,QAAQ0D,SAASC,WAC7D,8HACA,iFAEIC,OAtDJ,WAsDA,WACUC,EAAU,GAMd,GAL0B,WAAtB/E,KAAK6D,aACPkB,EAAU,uBAClB,iCACQA,EAAU,kBAENA,KAAW/E,KAAKiB,OAAOC,QAAQC,KAArC,CAQA,IAAN,wBACkC,IAAxBnB,KAAK4D,QAAQoB,OACfC,EAAOC,gBAAiB,EAExBlF,KAAK4D,QAAQuB,SAAQ,SAAU1C,EAAMC,GACnCuC,EAAO,cAAgBxC,EAAK9B,MAAQ8B,EAAK5B,SAG7Cb,KAAKQ,SAAU,EACf,OAAN,OAAM,CAAN,uBACQ,IAAIoD,EAAU,GACtB,WAAY,EAAZ,oEACUA,EAAUwB,EAAKC,6BAA6BC,eAAe1B,QACrE,yEACUA,EAAUwB,EAAKG,uBAAuBC,SAAS5B,SAEjD,EAAR,wCACU,MAAO,CAAjB,iCAEA,mBACQ,EAAR,mBACA,qBACQ,EAAR,WACQ,EAAR,iBACQ,EAAR,UACQ,EAAR,oBAhCQ5D,KAAKyF,cAAcnD,MAAM,CACvBoD,QAAS1F,KAAKS,GAAG,4BAA8B,IAAMsE,EACrDY,YAAa3F,KAAKS,GAAG,qCAiC3B2B,UAjGJ,WAkG0B,KAAhBpC,KAAK4B,QAAmC,KAAlB5B,KAAKkC,UAI/BlC,KAAKsC,OAAQ,EACbtC,KAAK4D,QAAQgC,KAAK,CAAxB,uCACM5F,KAAK8E,UALH9E,KAAKsC,MAAQtC,KAAKS,GAAG,kCAOzBqC,aA1GJ,SA0GA,GACM9C,KAAK8E,UAEPzB,aA7GJ,SA6GA,GACMrD,KAAK4D,QAAQiC,OAAOnD,EAAO,GAC3B1C,KAAK8E,UAEPxD,gBAjHJ,WAiHA,WACMtB,KAAKc,eAAgB,EACrBgF,YAAW,WACT,EAAR,yBAGIzD,YAvHJ,WAwHMrC,KAAK4B,OAAS,GACd5B,KAAKkC,SAAW,GAChBlC,KAAKsC,OAAQ,EACbtC,KAAKc,eAAgB,KCtR4U,I,wBCQnWiF,EAAY,eACd,EACA9F,EACAqD,GACA,EACA,KACA,WACA,MAIa,aAAAyC,E,8BCnBf,IAAIC,EAAQ,EAAQ,QAChBC,EAAc,EAAQ,QAEtBC,EAAM,MAIVC,EAAOC,QAAU,SAAUC,GACzB,OAAOL,GAAM,WACX,QAASC,EAAYI,MAAkBH,EAAIG,MAAkBH,GAAOD,EAAYI,GAAa1F,OAAS0F","file":"js/chunk-2140c442.42d24739.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailSettings.vue?vue&type=style&index=0&id=59e82484&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailSettings.vue?vue&type=style&index=0&id=59e82484&scoped=true&lang=less&\"","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-spin',{attrs:{\"spinning\":_vm.loading}},[(_vm.disableSettings)?_c('a-alert',{attrs:{\"banner\":\"\",\"message\":_vm.$t('message.action.settings.warning.vm.running')}}):_c('div',[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.showAddDetail),expression:\"!showAddDetail\"}]},[_c('a-button',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"dashed\",\"icon\":\"plus\",\"disabled\":!('updateTemplate' in _vm.$store.getters.apis && 'updateVirtualMachine' in _vm.$store.getters.apis && _vm.isAdminOrOwner())},on:{\"click\":_vm.onShowAddDetail}},[_vm._v(\" \"+_vm._s(_vm.$t('label.add.setting'))+\" \")])],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showAddDetail),expression:\"showAddDetail\"}]},[_c('a-input-group',{attrs:{\"type\":\"text\",\"compact\":\"\"}},[_c('a-auto-complete',{ref:\"keyElm\",staticClass:\"detail-input\",attrs:{\"filterOption\":_vm.filterOption,\"value\":_vm.newKey,\"dataSource\":Object.keys(_vm.detailOptions),\"placeholder\":_vm.$t('label.name')},on:{\"change\":function (e) { return _vm.onAddInputChange(e, 'newKey'); }}}),_c('a-input',{staticStyle:{\"width\":\"30px\",\"border-left\":\"0\",\"pointer-events\":\"none\",\"backgroundColor\":\"#fff\"},attrs:{\"placeholder\":\"=\",\"disabled\":\"\"}}),_c('a-auto-complete',{staticClass:\"detail-input\",attrs:{\"filterOption\":_vm.filterOption,\"value\":_vm.newValue,\"dataSource\":_vm.detailOptions[_vm.newKey],\"placeholder\":_vm.$t('label.value')},on:{\"change\":function (e) { return _vm.onAddInputChange(e, 'newValue'); }}}),_c('a-tooltip',{attrs:{\"arrowPointAtCenter\":\"\",\"placement\":\"topRight\"}},[_c('template',{slot:\"title\"},[_vm._v(\" \"+_vm._s(_vm.$t('label.add.setting'))+\" \")]),_c('a-button',{staticClass:\"detail-button\",attrs:{\"icon\":\"check\"},on:{\"click\":_vm.addDetail}})],2),_c('a-tooltip',{attrs:{\"arrowPointAtCenter\":\"\",\"placement\":\"topRight\"}},[_c('template',{slot:\"title\"},[_vm._v(\" \"+_vm._s(_vm.$t('label.cancel'))+\" \")]),_c('a-button',{staticClass:\"detail-button\",attrs:{\"icon\":\"close\"},on:{\"click\":_vm.closeDetail}})],2)],1),(_vm.error)?_c('p',{staticStyle:{\"color\":\"red\"}},[_vm._v(\" \"+_vm._s(_vm.$t(_vm.error))+\" \")]):_vm._e()],1)]),_c('a-list',{attrs:{\"size\":\"large\"}},_vm._l((_vm.details),function(item,index){return _c('a-list-item',{key:index},[_c('a-list-item-meta',[_c('span',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\" \"+_vm._s(item.name)+\" \")]),_c('span',{staticStyle:{\"word-break\":\"break-all\"},attrs:{\"slot\":\"description\"},slot:\"description\"},[(item.edit)?_c('span',{staticStyle:{\"display\":\"flex\"}},[_c('a-auto-complete',{staticStyle:{\"width\":\"100%\"},attrs:{\"value\":item.value,\"dataSource\":_vm.detailOptions[item.name]},on:{\"change\":function (val) { return _vm.handleInputChange(val, index); },\"pressEnter\":function (e) { return _vm.updateDetail(index); }}})],1):_c('span',[_vm._v(_vm._s(item.value))])])]),(!_vm.disableSettings && 'updateTemplate' in _vm.$store.getters.apis &&\n          'updateVirtualMachine' in _vm.$store.getters.apis && _vm.isAdminOrOwner() && _vm.allowEditOfDetail(item.name))?_c('div',{attrs:{\"slot\":\"actions\"},slot:\"actions\"},[(item.edit)?_c('a-button',{attrs:{\"shape\":\"circle\",\"size\":\"default\"},on:{\"click\":function($event){return _vm.updateDetail(index)}}},[_c('a-icon',{attrs:{\"type\":\"check-circle\",\"theme\":\"twoTone\",\"twoToneColor\":\"#52c41a\"}})],1):_vm._e(),(item.edit)?_c('a-button',{attrs:{\"shape\":\"circle\",\"size\":\"default\"},on:{\"click\":function($event){return _vm.hideEditDetail(index)}}},[_c('a-icon',{attrs:{\"type\":\"close-circle\",\"theme\":\"twoTone\",\"twoToneColor\":\"#f5222d\"}})],1):_vm._e(),(!item.edit)?_c('a-button',{attrs:{\"shape\":\"circle\",\"icon\":\"edit\"},on:{\"click\":function($event){return _vm.showEditDetail(index)}}}):_vm._e()],1):_vm._e(),(!_vm.disableSettings && 'updateTemplate' in _vm.$store.getters.apis &&\n          'updateVirtualMachine' in _vm.$store.getters.apis && _vm.isAdminOrOwner() && _vm.allowEditOfDetail(item.name))?_c('div',{attrs:{\"slot\":\"actions\"},slot:\"actions\"},[_c('a-popconfirm',{attrs:{\"title\":((_vm.$t('label.delete.setting')) + \"?\"),\"okText\":_vm.$t('label.yes'),\"cancelText\":_vm.$t('label.no'),\"placement\":\"left\"},on:{\"confirm\":function($event){return _vm.deleteDetail(index)}}},[_c('a-button',{attrs:{\"shape\":\"circle\",\"type\":\"danger\",\"icon\":\"delete\"}})],1)],1):_vm._e()],1)}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <a-spin :spinning=\"loading\">\n    <a-alert\n      v-if=\"disableSettings\"\n      banner\n      :message=\"$t('message.action.settings.warning.vm.running')\" />\n    <div v-else>\n      <div v-show=\"!showAddDetail\">\n        <a-button\n          type=\"dashed\"\n          style=\"width: 100%\"\n          icon=\"plus\"\n          :disabled=\"!('updateTemplate' in $store.getters.apis && 'updateVirtualMachine' in $store.getters.apis && isAdminOrOwner())\"\n          @click=\"onShowAddDetail\">\n          {{ $t('label.add.setting') }}\n        </a-button>\n      </div>\n      <div v-show=\"showAddDetail\">\n        <a-input-group\n          type=\"text\"\n          compact>\n          <a-auto-complete\n            class=\"detail-input\"\n            ref=\"keyElm\"\n            :filterOption=\"filterOption\"\n            :value=\"newKey\"\n            :dataSource=\"Object.keys(detailOptions)\"\n            :placeholder=\"$t('label.name')\"\n            @change=\"e => onAddInputChange(e, 'newKey')\" />\n          <a-input style=\" width: 30px; border-left: 0; pointer-events: none; backgroundColor: #fff\" placeholder=\"=\" disabled />\n          <a-auto-complete\n            class=\"detail-input\"\n            :filterOption=\"filterOption\"\n            :value=\"newValue\"\n            :dataSource=\"detailOptions[newKey]\"\n            :placeholder=\"$t('label.value')\"\n            @change=\"e => onAddInputChange(e, 'newValue')\" />\n          <a-tooltip arrowPointAtCenter placement=\"topRight\">\n            <template slot=\"title\">\n              {{ $t('label.add.setting') }}\n            </template>\n            <a-button icon=\"check\" @click=\"addDetail\" class=\"detail-button\"></a-button>\n          </a-tooltip>\n          <a-tooltip arrowPointAtCenter placement=\"topRight\">\n            <template slot=\"title\">\n              {{ $t('label.cancel') }}\n            </template>\n            <a-button icon=\"close\" @click=\"closeDetail\" class=\"detail-button\"></a-button>\n          </a-tooltip>\n        </a-input-group>\n        <p v-if=\"error\" style=\"color: red\"> {{ $t(error) }} </p>\n      </div>\n    </div>\n    <a-list size=\"large\">\n      <a-list-item :key=\"index\" v-for=\"(item, index) in details\">\n        <a-list-item-meta>\n          <span slot=\"title\">\n            {{ item.name }}\n          </span>\n          <span slot=\"description\" style=\"word-break: break-all\">\n            <span v-if=\"item.edit\" style=\"display: flex\">\n              <a-auto-complete\n                style=\"width: 100%\"\n                :value=\"item.value\"\n                :dataSource=\"detailOptions[item.name]\"\n                @change=\"val => handleInputChange(val, index)\"\n                @pressEnter=\"e => updateDetail(index)\" />\n            </span>\n            <span v-else>{{ item.value }}</span>\n          </span>\n        </a-list-item-meta>\n        <div\n          slot=\"actions\"\n          v-if=\"!disableSettings && 'updateTemplate' in $store.getters.apis &&\n            'updateVirtualMachine' in $store.getters.apis && isAdminOrOwner() && allowEditOfDetail(item.name)\">\n          <a-button shape=\"circle\" size=\"default\" @click=\"updateDetail(index)\" v-if=\"item.edit\">\n            <a-icon type=\"check-circle\" theme=\"twoTone\" twoToneColor=\"#52c41a\" />\n          </a-button>\n          <a-button shape=\"circle\" size=\"default\" @click=\"hideEditDetail(index)\" v-if=\"item.edit\">\n            <a-icon type=\"close-circle\" theme=\"twoTone\" twoToneColor=\"#f5222d\" />\n          </a-button>\n          <a-button\n            shape=\"circle\"\n            icon=\"edit\"\n            v-if=\"!item.edit\"\n            @click=\"showEditDetail(index)\" />\n        </div>\n        <div\n          slot=\"actions\"\n          v-if=\"!disableSettings && 'updateTemplate' in $store.getters.apis &&\n            'updateVirtualMachine' in $store.getters.apis && isAdminOrOwner() && allowEditOfDetail(item.name)\">\n          <a-popconfirm\n            :title=\"`${$t('label.delete.setting')}?`\"\n            @confirm=\"deleteDetail(index)\"\n            :okText=\"$t('label.yes')\"\n            :cancelText=\"$t('label.no')\"\n            placement=\"left\"\n          >\n            <a-button shape=\"circle\" type=\"danger\" icon=\"delete\" />\n          </a-popconfirm>\n        </div>\n      </a-list-item>\n    </a-list>\n  </a-spin>\n</template>\n\n<script>\nimport { api } from '@/api'\n\nexport default {\n  name: 'DetailSettings',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    }\n  },\n  data () {\n    return {\n      details: [],\n      detailOptions: {},\n      showAddDetail: false,\n      disableSettings: false,\n      newKey: '',\n      newValue: '',\n      loading: false,\n      resourceType: 'UserVm',\n      error: false\n    }\n  },\n  watch: {\n    resource: function (newItem, oldItem) {\n      this.updateResource(newItem)\n    }\n  },\n  mounted () {\n    this.updateResource(this.resource)\n  },\n  methods: {\n    filterOption (input, option) {\n      return (\n        option.componentOptions.children[0].text.toUpperCase().indexOf(input.toUpperCase()) >= 0\n      )\n    },\n    updateResource (resource) {\n      this.details = []\n      if (!resource) {\n        return\n      }\n      this.resource = resource\n      this.resourceType = this.$route.meta.resourceType\n      if (resource.details) {\n        this.details = Object.keys(this.resource.details).map(k => {\n          return { name: k, value: this.resource.details[k], edit: false }\n        })\n      }\n      api('listDetailOptions', { resourcetype: this.resourceType, resourceid: this.resource.id }).then(json => {\n        this.detailOptions = json.listdetailoptionsresponse.detailoptions.details\n      })\n      this.disableSettings = (this.$route.meta.name === 'vm' && this.resource.state !== 'Stopped')\n    },\n    allowEditOfDetail (name) {\n      if (this.resource.readonlyuidetails) {\n        if (this.resource.readonlyuidetails.split(',').map(item => item.trim()).includes(name)) {\n          return false\n        }\n      }\n      return true\n    },\n    showEditDetail (index) {\n      this.details[index].edit = true\n      this.details[index].originalValue = this.details[index].value\n      this.$set(this.details, index, this.details[index])\n    },\n    hideEditDetail (index) {\n      this.details[index].edit = false\n      this.details[index].value = this.details[index].originalValue\n      this.$set(this.details, index, this.details[index])\n    },\n    handleInputChange (val, index) {\n      this.details[index].value = val\n      this.$set(this.details, index, this.details[index])\n    },\n    onAddInputChange (val, obj) {\n      this.error = false\n      this[obj] = val\n    },\n    isAdminOrOwner () {\n      return ['Admin'].includes(this.$store.getters.userInfo.roletype) ||\n        (this.resource.domainid === this.$store.getters.userInfo.domainid && this.resource.account === this.$store.getters.userInfo.account) ||\n        this.resource.project && this.resource.projectid === this.$store.getters.project.id\n    },\n    runApi () {\n      var apiName = ''\n      if (this.resourceType === 'UserVm') {\n        apiName = 'updateVirtualMachine'\n      } else if (this.resourceType === 'Template') {\n        apiName = 'updateTemplate'\n      }\n      if (!(apiName in this.$store.getters.apis)) {\n        this.$notification.error({\n          message: this.$t('error.execute.api.failed') + ' ' + apiName,\n          description: this.$t('message.user.not.permitted.api')\n        })\n        return\n      }\n\n      const params = { id: this.resource.id }\n      if (this.details.length === 0) {\n        params.cleanupdetails = true\n      } else {\n        this.details.forEach(function (item, index) {\n          params['details[0].' + item.name] = item.value\n        })\n      }\n      this.loading = true\n      api(apiName, params).then(json => {\n        var details = {}\n        if (this.resourceType === 'UserVm' && json.updatevirtualmachineresponse.virtualmachine.details) {\n          details = json.updatevirtualmachineresponse.virtualmachine.details\n        } else if (this.resourceType === 'Template' && json.updatetemplateresponse.template.details) {\n          details = json.updatetemplateresponse.template.details\n        }\n        this.details = Object.keys(details).map(k => {\n          return { name: k, value: details[k], edit: false }\n        })\n      }).catch(error => {\n        this.$notifyError(error)\n      }).finally(f => {\n        this.loading = false\n        this.showAddDetail = false\n        this.newKey = ''\n        this.newValue = ''\n      })\n    },\n    addDetail () {\n      if (this.newKey === '' || this.newValue === '') {\n        this.error = this.$t('message.error.provide.setting')\n        return\n      }\n      this.error = false\n      this.details.push({ name: this.newKey, value: this.newValue })\n      this.runApi()\n    },\n    updateDetail (index) {\n      this.runApi()\n    },\n    deleteDetail (index) {\n      this.details.splice(index, 1)\n      this.runApi()\n    },\n    onShowAddDetail () {\n      this.showAddDetail = true\n      setTimeout(() => {\n        this.$refs.keyElm.focus()\n      })\n    },\n    closeDetail () {\n      this.newKey = ''\n      this.newValue = ''\n      this.error = false\n      this.showAddDetail = false\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n.detail-input {\n  width: calc(calc(100% / 2) - 45px);\n}\n\n.detail-button {\n  width: 30px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailSettings.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailSettings.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailSettings.vue?vue&type=template&id=59e82484&scoped=true&\"\nimport script from \"./DetailSettings.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailSettings.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DetailSettings.vue?vue&type=style&index=0&id=59e82484&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"59e82484\",\n  null\n  \n)\n\nexport default component.exports","var fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n"],"sourceRoot":""}