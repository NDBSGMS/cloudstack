(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bbf64dc"],{"52ed":function(e,t,s){},a10c:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=this,s=t.$createElement,a=t._self._c||s;return a("a-spin",{attrs:{spinning:t.loading}},[a("div",{staticClass:"form"},[a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v(t._s(t.$t("label.zonenamelabel")))]),a("a-select",{on:{change:t.fetchPods},model:{value:t.zoneId,callback:function(e){t.zoneId=e},expression:"zoneId"}},t._l(t.zonesList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[t._v(t._s(t.$t("label.hypervisor")))]),a("a-select",{on:{change:t.resetAllFields},model:{value:t.hypervisor,callback:function(e){t.hypervisor=e},expression:"hypervisor"}},t._l(t.hypervisorsList,(function(e){return a("a-select-option",{key:e.name,attrs:{value:e.name}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[t._v(t._s(t.$t("label.podname")))]),a("a-select",{model:{value:t.podId,callback:function(e){t.podId=e},expression:"podId"}},t._l(t.podsList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[a("span",{staticClass:"required"},[t._v("* ")]),t._v(t._s(t.$t("label.clusternamelabel")))]),a("span",{ref:"requiredCluster",staticClass:"required required-label"},[t._v(t._s(t.$t("label.required")))]),a("a-input",{attrs:{placeholder:t.placeholder.clustername},model:{value:t.clustername,callback:function(e){t.clustername=e},expression:"clustername"}})],1),"VMware"===t.hypervisor?[a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[t._v(t._s(t.$t("label.vcenter.host")))]),a("a-input",{model:{value:t.host,callback:function(e){t.host=e},expression:"host"}})],1),a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[t._v(t._s(t.$t("label.vcenterusername")))]),a("a-input",{model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[t._v(t._s(t.$t("label.vcenterpassword")))]),a("a-input",{attrs:{type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[t._v(t._s(t.$t("label.vcenterdatacenter")))]),a("a-input",{model:{value:t.dataCenter,callback:function(e){t.dataCenter=e},expression:"dataCenter"}})],1)]:t._e(),a("div",{staticClass:"form__item"},[a("div",{staticClass:"form__label"},[t._v(t._s(t.$t("label.isdedicated")))]),a("a-checkbox",{on:{change:t.toggleDedicated}})],1),t.showDedicated?[a("DedicateDomain",{attrs:{error:t.domainError},on:{domainChange:function(e){return t.dedicatedDomainId=e},accountChange:function(e){return t.dedicatedAccount=e}}})]:t._e(),a("a-divider"),a("div",{staticClass:"actions"},[a("a-button",{on:{click:function(){return e.$parent.$parent.close()}}},[t._v(t._s(t.$t("label.cancel")))]),a("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmitForm}},[t._v(t._s(t.$t("label.ok")))])],1)],2)])},i=[],n=(s("a4d3"),s("e01a"),s("99af"),s("7db0"),s("4160"),s("b0c0"),s("b64b"),s("d3b7"),s("159b"),s("365c")),o=s("7e77"),r={name:"ClusterAdd",components:{DedicateDomain:o["a"]},props:{resource:{type:Object,required:!0}},inject:["parentFetchData","parentToggleLoading"],data:function(){return{loading:!1,zoneId:null,hypervisor:null,podId:null,clustername:null,clustertype:"CloudManaged",username:null,password:null,url:null,host:null,dataCenter:null,ovm3pool:null,ovm3cluster:null,ovm3vip:null,zonesList:[],hypervisorsList:[],podsList:[],showDedicated:!1,dedicatedDomainId:null,dedicatedAccount:null,domainError:!1,params:[],placeholder:{clustername:null}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.fetchZones(),this.fetchHypervisors(),this.params=this.$store.getters.apis.addCluster.params,Object.keys(this.placeholder).forEach((function(t){e.returnPlaceholder(t)}))},fetchZones:function(){var e=this;this.loading=!0,Object(n["a"])("listZones").then((function(t){e.zonesList=t.listzonesresponse.zone||[],e.zoneId=e.zonesList[0].id||null,e.fetchPods()})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1}))},fetchHypervisors:function(){var e=this;this.loading=!0,Object(n["a"])("listHypervisors").then((function(t){e.hypervisorsList=t.listhypervisorsresponse.hypervisor||[],e.hypervisor=e.hypervisorsList[0].name||null})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1}))},fetchPods:function(){var e=this;this.loading=!0,Object(n["a"])("listPods",{zoneid:this.zoneId}).then((function(t){e.podsList=t.listpodsresponse.pod||[],e.podId=e.podsList[0].id||null})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1}))},toggleDedicated:function(){this.dedicatedDomainId=null,this.dedicatedAccount=null,this.showDedicated=!this.showDedicated},handleSubmitForm:function(){var e=this;if(this.clustername){if(this.$refs.requiredCluster.classList.remove("required-label--visible"),"Ovm3"===this.hypervisor&&(this.ovm3pool="on",this.ovm3cluster="undefined",this.ovm3vip=""),"VMware"===this.hypervisor){this.clustertype="ExternalManaged";var t=this.clustername;this.url="http://".concat(this.host,"/").concat(this.dataCenter,"/").concat(t),this.clustername="".concat(this.host,"/").concat(this.dataCenter,"/").concat(t)}this.loading=!0,this.parentToggleLoading(),Object(n["a"])("addCluster",{},"POST",{zoneId:this.zoneId,hypervisor:this.hypervisor,clustertype:this.clustertype,podId:this.podId,clustername:this.clustername,ovm3pool:this.ovm3pool,ovm3cluster:this.ovm3cluster,ovm3vip:this.ovm3vip,username:this.username,password:this.password,url:this.url}).then((function(t){var s=t.addclusterresponse.cluster[0]||{};s.id&&e.showDedicated&&e.dedicateCluster(s.id),e.parentFetchData(),e.parentToggleLoading(),e.$parent.$parent.close()})).catch((function(t){e.$notification.error({message:"".concat(e.$t("label.error")," ").concat(t.response.status),description:t.response.data.addclusterresponse.errortext,duration:0})})).finally((function(){e.loading=!1}))}else this.$refs.requiredCluster.classList.add("required-label--visible")},dedicateCluster:function(e){var t=this;this.loading=!0,Object(n["a"])("dedicateCluster",{clusterId:e,domainId:this.dedicatedDomainId,account:this.dedicatedAccount}).then((function(e){t.$pollJob({jobId:e.dedicateclusterresponse.jobid,successMessage:t.$t("message.cluster.dedicated"),successMethod:function(){t.loading=!1,t.$store.dispatch("AddAsyncJob",{title:t.$t("message.cluster.dedicated"),jobid:e.dedicateclusterresponse.jobid,description:"".concat(t.$t("label.domainid")," : ").concat(t.dedicatedDomainId),status:"progress"})},errorMessage:t.$t("error.dedicate.cluster.failed"),errorMethod:function(){t.loading=!1},loadingMessage:t.$t("message.dedicate.zone"),catchMessage:t.$t("error.fetching.async.job.result"),catchMethod:function(){t.loading=!1}})})).catch((function(e){t.$notification.error({message:"".concat(t.$t("label.error")," ").concat(e.response.status),description:e.response.data.errorresponse.errortext,duration:0}),t.loading=!1}))},resetAllFields:function(){this.clustertype="CloudManaged",this.username=null,this.password=null,this.url=null,this.host=null,this.dataCenter=null,this.ovm3pool=null,this.ovm3cluster=null,this.ovm3vip=null},returnPlaceholder:function(e){var t=this;this.params.find((function(s){s.name===e&&(t.placeholder[e]=s.description)}))}}},l=r,c=(s("f336"),s("2877")),d=Object(c["a"])(l,a,i,!1,null,"bc34ec9e",null);t["default"]=d.exports},f336:function(e,t,s){"use strict";var a=s("52ed"),i=s.n(a);i.a}}]);
//# sourceMappingURL=chunk-6bbf64dc.306244ee.js.map