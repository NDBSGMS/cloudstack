{"version":3,"sources":["webpack:///./src/views/plugins/quota/QuotaUsage.vue?3c3c","webpack:///src/views/plugins/quota/QuotaUsage.vue","webpack:///./src/views/plugins/quota/QuotaUsage.vue?8562","webpack:///./src/views/plugins/quota/QuotaUsage.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","loading","columns","dataSource","record","name","y","scopedSlots","_u","key","fn","text","undefined","_v","_s","currency","_e","staticRenderFns","props","resource","type","Object","required","tab","String","default","data","pattern","totalQuota","account","computed","watch","newTab","fetchData","mounted","methods","quotaBalance","Promise","params","domainid","resolve","reject","error","quotaStatement","startdate","enddate","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,UAAU,CAACE,MAAM,CAAC,KAAO,QAAQ,QAAUN,EAAIO,QAAQ,QAAUP,EAAIQ,QAAQ,WAAaR,EAAIS,WAAW,OAAS,SAAUC,GAAU,OAAOA,EAAOC,MAAQ,YAAa,EAAM,OAAS,CAAEC,EAAG,SAAUC,YAAYb,EAAIc,GAAG,CAAC,CAACC,IAAI,QAAQC,GAAG,SAASC,GAAM,MAAO,MAASC,IAAPD,EAAkBb,EAAG,OAAO,CAACJ,EAAImB,GAAGnB,EAAIoB,GAAIpB,EAAIqB,SAAW,IAAMJ,MAAUjB,EAAIsB,aAAa,IACxcC,EAAkB,G,6ECsCtB,GACEZ,KAAM,aACNa,MAAO,CACLC,SAAU,CACRC,KAAMC,OACNC,UAAU,GAEZC,IAAK,CACHH,KAAMI,OACNC,QAAS,WAAf,YAGEC,KAZF,WAaI,MAAO,CACLzB,SAAS,EACTE,WAAY,GACZwB,QAAS,aACTZ,SAAU,GACVa,WAAY,EACZC,QAAS,OAGbC,SAAU,CACR5B,QADJ,WAEM,MAAO,CACb,CACQ,MAAR,iCACQ,UAAR,OACQ,MAAR,iBACQ,YAAR,CAAU,aAAV,SAEA,CACQ,MAAR,iCACQ,UAAR,OACQ,MAAR,iBACQ,YAAR,CAAU,aAAV,SAEA,CACQ,MAAR,6BACQ,UAAR,QACQ,MAAR,iBACQ,YAAR,CAAU,aAAV,aAKE6B,MAAO,CACLR,IADJ,SACA,KACM5B,KAAK4B,IAAMS,EACM,0BAAbrC,KAAK4B,KACP5B,KAAKsC,cAIXC,QAtDF,WAuDIvC,KAAKsC,aAEPE,QAAS,CACP,UADJ,WACA,yKACA,aACA,gBACA,6EAHA,kBAMA,iBANA,cAMA,EANA,gBAOA,oBAPA,OAOA,EAPA,OAQA,eACA,oCACA,sBACA,0BACA,mBACA,+CACA,qBAEA,sBACA,OACA,2FACA,yFAEA,aArBA,qDAuBA,kBACA,aAxBA,6DA2BIC,aA5BJ,WA4BA,WACM,OAAO,IAAIC,SAAQ,SAAzB,KACQ,IAAR,KACQC,EAAOC,SAAW,EAA1B,kBACQD,EAAOT,QAAU,EAAzB,QAEQ,OAAR,OAAQ,CAAR,oCACU,IAAV,qCACUW,EAAQJ,MAClB,mBACUK,EAAOC,UAIbC,eA1CJ,SA0CA,cACM,OAAO,IAAIN,SAAQ,SAAzB,KACQ,IAAR,KACQC,EAAOC,SAAW,EAA1B,kBACQD,EAAOT,QAAU,EAAzB,QACQS,EAAOM,UAAY,IAA3B,wCACQN,EAAOO,QAAU,IAAzB,+BAEQ,OAAR,OAAQ,CAAR,sCACU,IAAV,yCACUL,EAAQG,MAClB,mBACUF,EAAOC,YCtJiW,I,YCO9WI,EAAY,eACd,EACArD,EACAwB,GACA,EACA,KACA,KACA,MAIa,aAAA6B,E","file":"js/chunk-2d0c0d79.29c94ad5.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-table',{attrs:{\"size\":\"small\",\"loading\":_vm.loading,\"columns\":_vm.columns,\"dataSource\":_vm.dataSource,\"rowKey\":function (record) { return record.name; },\"pagination\":false,\"scroll\":{ y: '55vh' }},scopedSlots:_vm._u([{key:\"quota\",fn:function(text){return [(text!==undefined)?_c('span',[_vm._v(_vm._s((_vm.currency + \" \" + text)))]):_vm._e()]}}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <div>\n    <a-table\n      size=\"small\"\n      :loading=\"loading\"\n      :columns=\"columns\"\n      :dataSource=\"dataSource\"\n      :rowKey=\"record => record.name\"\n      :pagination=\"false\"\n      :scroll=\"{ y: '55vh' }\"\n    >\n      <template slot=\"quota\" slot-scope=\"text\">\n        <span v-if=\"text!==undefined\">{{ `${currency} ${text}` }}</span>\n      </template>\n    </a-table>\n  </div>\n</template>\n\n<script>\nimport { api } from '@/api'\nimport moment from 'moment'\n\nexport default {\n  name: 'QuotaUsage',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    },\n    tab: {\n      type: String,\n      default: () => ''\n    }\n  },\n  data () {\n    return {\n      loading: false,\n      dataSource: [],\n      pattern: 'YYYY-MM-DD',\n      currency: '',\n      totalQuota: 0,\n      account: null\n    }\n  },\n  computed: {\n    columns () {\n      return [\n        {\n          title: this.$t('label.quota.type.name'),\n          dataIndex: 'name',\n          width: 'calc(100% / 3)',\n          scopedSlots: { customRender: 'name' }\n        },\n        {\n          title: this.$t('label.quota.type.unit'),\n          dataIndex: 'unit',\n          width: 'calc(100% / 3)',\n          scopedSlots: { customRender: 'unit' }\n        },\n        {\n          title: this.$t('label.quota.usage'),\n          dataIndex: 'quota',\n          width: 'calc(100% / 3)',\n          scopedSlots: { customRender: 'quota' }\n        }\n      ]\n    }\n  },\n  watch: {\n    tab (newTab, oldTab) {\n      this.tab = newTab\n      if (this.tab === 'quota.statement.quota') {\n        this.fetchData()\n      }\n    }\n  },\n  mounted () {\n    this.fetchData()\n  },\n  methods: {\n    async fetchData () {\n      this.loading = true\n      this.dataSource = []\n      this.account = this.$route.query && this.$route.query.account ? this.$route.query.account : null\n\n      try {\n        const resource = await this.quotaBalance()\n        const quotaStatement = await this.quotaStatement(resource)\n        const quotaUsage = quotaStatement.quotausage\n        this.dataSource = this.dataSource.concat(quotaUsage)\n        this.currency = quotaStatement.currency\n        this.totalQuota = quotaStatement.totalquota\n        this.dataSource.push({\n          name: `${this.$t('label.quota.total')}: `,\n          quota: this.totalQuota\n        })\n        this.dataSource.unshift({\n          type: 0,\n          name: `${this.$t('startdate')}: ${moment(this.resource.startdate).format(this.pattern)}`,\n          unit: `${this.$t('enddate')}: ${moment(this.resource.enddate).format(this.pattern)}`\n        })\n        this.loading = false\n      } catch (e) {\n        console.log(e)\n        this.loading = false\n      }\n    },\n    quotaBalance () {\n      return new Promise((resolve, reject) => {\n        const params = {}\n        params.domainid = this.resource.domainid\n        params.account = this.account\n\n        api('quotaBalance', params).then(json => {\n          const quotaBalance = json.quotabalanceresponse.balance || {}\n          resolve(quotaBalance)\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    },\n    quotaStatement (resource) {\n      return new Promise((resolve, reject) => {\n        const params = {}\n        params.domainid = this.resource.domainid\n        params.account = this.account\n        params.startdate = moment(this.resource.startdate).format(this.pattern)\n        params.enddate = moment(resource.startdate).format(this.pattern)\n\n        api('quotaStatement', params).then(json => {\n          const quotaStatement = json.quotastatementresponse.statement || {}\n          resolve(quotaStatement)\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuotaUsage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuotaUsage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QuotaUsage.vue?vue&type=template&id=209d6901&\"\nimport script from \"./QuotaUsage.vue?vue&type=script&lang=js&\"\nexport * from \"./QuotaUsage.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}