(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34b7c30a"],{c814:function(e,r,a){},d4c7:function(e,r,a){"use strict";var t=a("c814"),s=a.n(t);s.a},dec5:function(e,r,a){"use strict";a.r(r);var t=function(){var e=this,r=this,a=r.$createElement,t=r._self._c||a;return t("div",{staticClass:"form-layout"},[t("a-spin",{attrs:{spinning:r.loading}},[t("a-form",{attrs:{form:r.form,layout:"vertical"}},[t("a-form-item",{attrs:{label:r.$t("label.name")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name"],expression:"['name']"}]})],1),t("a-form-item",{attrs:{label:r.$t("label.providername")}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["provider",{initialValue:"NFS"}],expression:"[\n            'provider',\n            {\n              initialValue: 'NFS'\n            }]"}],on:{change:function(r){e.provider=r}}},r._l(r.providers,(function(e,a){return t("a-select-option",{key:a,attrs:{value:e}},[r._v(r._s(e))])})),1)],1),"Swift"!==r.provider?t("div",[t("a-form-item",{attrs:{label:r.$t("label.zone")}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["zone",{initialValue:this.zoneSelected,rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'zone',\n              {\n                initialValue: this.zoneSelected,\n                rules: [{ required: true, message: `${$t('label.required')}`}]\n              }]"}],on:{change:function(e){r.zoneSelected=e}}},r._l(r.zones,(function(e){return t("a-select-option",{key:e.id,attrs:{value:e.id}},[r._v(r._s(e.name))])})),1)],1),t("a-form-item",{attrs:{label:r.$t("label.server")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["server",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'server',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1),t("a-form-item",{attrs:{label:r.$t("label.path")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["path",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'path',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1)],1):r._e(),"SMB/CIFS"===r.provider?t("div",[t("a-form-item",{attrs:{label:r.$t("label.smbusername")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["smbUsername",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'smbUsername',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1),t("a-form-item",{attrs:{label:r.$t("label.smbpassword")}},[t("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["smbPassword",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'smbPassword',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1),t("a-form-item",{attrs:{label:r.$t("label.smbdomain")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["smbDomain",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'smbDomain',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1)],1):r._e(),"Swift"===r.provider?t("div",[t("a-form-item",{attrs:{label:r.$t("label.url")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["url",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'url',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1),t("a-form-item",{attrs:{label:r.$t("label.account")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["account",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'account',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1),t("a-form-item",{attrs:{label:r.$t("label.username")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'username',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1),t("a-form-item",{attrs:{label:r.$t("label.key")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["key",{rules:[{required:!0,message:""+r.$t("label.required")}]}],expression:"[\n              'key',\n              {\n                rules: [{ required: true, message: `${$t('label.required')}` }]\n              }]"}]})],1),t("a-form-item",{attrs:{label:r.$t("label.storagepolicy")}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["storagepolicy"],expression:"[\n              'storagepolicy'\n            ]"}]})],1)],1):r._e(),t("div",{staticClass:"actions"},[t("a-button",{on:{click:r.closeModal}},[r._v(r._s(r.$t("label.cancel")))]),t("a-button",{attrs:{type:"primary"},on:{click:r.handleSubmit}},[r._v(r._s(r.$t("label.ok")))])],1)],1)],1)],1)},s=[],n=(a("4160"),a("c975"),a("b0c0"),a("b64b"),a("d3b7"),a("25f0"),a("159b"),a("365c")),i={name:"AddSecondryStorage",props:{resource:{type:Object,required:!0}},inject:["parentFetchData"],data:function(){return{providers:["NFS","SMB/CIFS","Swift"],provider:"",zones:[],zoneSelected:"",loading:!1}},beforeCreate:function(){this.form=this.$form.createForm(this)},mounted:function(){this.fetchData()},methods:{fetchData:function(){this.listZones()},closeModal:function(){this.$parent.$parent.close()},listZones:function(){var e=this;Object(n["a"])("listZones").then((function(r){r&&r.listzonesresponse&&r.listzonesresponse.zone&&(e.zones=r.listzonesresponse.zone,e.zones.length>0&&(e.zoneSelected=e.zones[0].id||""))}))},nfsURL:function(e,r){var a;return"/"!==r.substring(0,1)&&(r="/"+r),a=-1===e.indexOf("://")?"nfs://"+e+r:e+r,a},smbURL:function(e,r,a,t,s){var n="";return"/"!==r.substring(0,1)&&(r="/"+r),-1===e.indexOf("://")&&(n+="cifs://"),n+=e+r,n},handleSubmit:function(e){var r=this;e.preventDefault(),this.form.validateFields((function(e,a){if(!e){var t={name:a.name},s="",i=a.provider;if("NFS"===i&&(s=r.nfsURL(a.server,a.path)),"SMB/CIFS"===i){i="SMB",s=r.smbURL(a.server,a.path,a.smbUsername,a.smbPassword,a.smbDomain);var o={user:a.smbUsername,password:a.smbPassword,domain:a.smbDomain};Object.keys(o).forEach((function(e,r){t["details["+r.toString()+"].key"]=e,t["details["+r.toString()+"].value"]=o[e]}))}if("Swift"===i){s=a.url;var l={account:a.account,username:a.username,key:a.key,storagepolicy:a.storagepolicy};Object.keys(l).forEach((function(e,r){t["details["+r.toString()+"].key"]=e,t["details["+r.toString()+"].value"]=l[e]}))}t.url=s,t.provider=i,a.zone&&"Swift"!==i&&(t.zoneid=a.zone),r.loading=!0,Object(n["a"])("addImageStore",t).then((function(e){r.$notification.success({message:r.$t("label.add.secondary.storage"),description:r.$t("label.add.secondary.storage")}),r.closeModal(),r.parentFetchData()})).catch((function(e){r.$notifyError(e)})).finally((function(){r.loading=!1}))}}))}}},o=i,l=(a("d4c7"),a("2877")),u=Object(l["a"])(o,t,s,!1,null,"47bedaf3",null);r["default"]=u.exports}}]);
//# sourceMappingURL=chunk-34b7c30a.a7871e27.js.map