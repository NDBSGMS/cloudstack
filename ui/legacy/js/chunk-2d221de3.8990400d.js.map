{"version":3,"sources":["webpack:///./src/views/network/PublicIpResource.vue?8b0f","webpack:///src/views/network/PublicIpResource.vue","webpack:///./src/views/network/PublicIpResource.vue?9769","webpack:///./src/views/network/PublicIpResource.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","on","changeResource","attrs","slot","style","float","device","loading","actions","selectedRowKeys","resource","action","execAction","groupAction","dataView","isPublicIpAddress","tabs","_e","staticRenderFns","name","components","AutogenView","ResourceView","ActionButton","data","component","mixins","mixin","provide","parentFetchData","fetchData","parentToggleLoading","toggleLoading","computed","$route","path","startsWith","includes","watch","mounted","methods","fetchAction","meta","portFWRuleCount","loadBalancerRuleCount","filter","fetchPortFWRule","Promise","listAll","ipaddressid","page","pagesize","resolve","reject","e","fetchLoadBalancerRule","publicipid","eventBus"],"mappings":"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","file":"js/chunk-2d221de3.8990400d.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('autogen-view',{on:{\"change-resource\":_vm.changeResource}},[_c('div',{attrs:{\"slot\":\"action\"},slot:\"action\"},[_c('action-button',{style:({ float: _vm.device === 'mobile' ? 'left' : 'right' }),attrs:{\"loading\":_vm.loading,\"actions\":_vm.actions,\"selectedRowKeys\":_vm.selectedRowKeys,\"dataView\":true,\"resource\":_vm.resource},on:{\"exec-action\":function (action) { return _vm.execAction(action, action.groupAction && !_vm.dataView); }}})],1),_c('div',{attrs:{\"slot\":\"resource\"},slot:\"resource\"},[(_vm.isPublicIpAddress && 'id' in _vm.resource)?_c('resource-view',{attrs:{\"loading\":_vm.loading,\"resource\":_vm.resource,\"tabs\":_vm.tabs}}):_vm._e()],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <div>\n    <autogen-view @change-resource=\"changeResource\">\n      <div slot=\"action\">\n        <action-button\n          :style=\"{ float: device === 'mobile' ? 'left' : 'right' }\"\n          :loading=\"loading\"\n          :actions=\"actions\"\n          :selectedRowKeys=\"selectedRowKeys\"\n          :dataView=\"true\"\n          :resource=\"resource\"\n          @exec-action=\"(action) => execAction(action, action.groupAction && !dataView)\" />\n      </div>\n      <div slot=\"resource\">\n        <resource-view\n          v-if=\"isPublicIpAddress && 'id' in resource\"\n          :loading=\"loading\"\n          :resource=\"resource\"\n          :tabs=\"tabs\" />\n      </div>\n    </autogen-view>\n  </div>\n</template>\n\n<script>\nimport { api } from '@api'\nimport { mixinDevice } from '@/utils/mixin.js'\nimport eventBus from '@/config/eventBus'\nimport AutogenView from '@/views/AutogenView.vue'\nimport ResourceView from '@/components/view/ResourceView'\nimport ActionButton from '@/components/view/ActionButton'\n\nexport default {\n  name: 'PublicIpResource',\n  components: {\n    AutogenView,\n    ResourceView,\n    ActionButton\n  },\n  data () {\n    return {\n      loading: false,\n      selectedRowKeys: [],\n      actions: [],\n      resource: {},\n      tabs: [{\n        name: 'details',\n        component: () => import('@/components/view/DetailsTab.vue')\n      }]\n    }\n  },\n  mixins: [mixinDevice],\n  provide: function () {\n    return {\n      parentFetchData: this.fetchData(),\n      parentToggleLoading: this.toggleLoading\n    }\n  },\n  computed: {\n    isPublicIpAddress () {\n      return this.$route.path.startsWith('/publicip') && this.$route.path.includes('/publicip/')\n    }\n  },\n  watch: {\n    resource () {\n      if ('id' in this.resource) {\n        this.fetchData()\n      }\n    }\n  },\n  mounted () {\n    if ('id' in this.resource) {\n      this.fetchData()\n    }\n  },\n  methods: {\n    async fetchData () {\n      if (Object.keys(this.resource).length === 0) {\n        return\n      }\n\n      this.loading = true\n      this.portFWRuleCount = await this.fetchPortFWRule()\n\n      // disable load balancing rules only if port forwarding is enabled and\n      // network belongs to VPC\n      if (this.portFWRuleCount > 0 && this.resource.vpcid) {\n        this.tabs = this.$route.meta.tabs.filter(tab => tab.name !== 'loadbalancing')\n      } else {\n        this.loadBalancerRuleCount = await this.fetchLoadBalancerRule()\n\n        // for isolated networks, display both LB and PF\n        // for VPC they are mutually exclusive\n        if (this.loadBalancerRuleCount > 0) {\n          this.tabs =\n            this.resource.vpcid ? this.$route.meta.tabs.filter(tab => tab.name !== 'portforwarding') : this.$route.meta.tabs\n          this.loading = false\n        } else {\n          this.tabs = this.$route.meta.tabs\n        }\n      }\n\n      await this.fetchAction()\n      this.loading = false\n    },\n    fetchAction () {\n      this.actions = []\n      if (this.$route.meta.actions) {\n        this.actions = this.$route.meta.actions\n      }\n\n      if (this.portFWRuleCount > 0 || this.loadBalancerRuleCount > 0) {\n        this.actions = this.actions.filter(action => action.api !== 'enableStaticNat')\n      }\n    },\n    fetchPortFWRule () {\n      return new Promise((resolve, reject) => {\n        api('listPortForwardingRules', {\n          listAll: true,\n          ipaddressid: this.resource.id,\n          page: 1,\n          pagesize: 1\n        }).then(json => {\n          const portFWRuleCount = json.listportforwardingrulesresponse.count || 0\n          resolve(portFWRuleCount)\n        }).catch(e => {\n          reject(e)\n        })\n      })\n    },\n    fetchLoadBalancerRule () {\n      return new Promise((resolve, reject) => {\n        api('listLoadBalancerRules', {\n          listAll: true,\n          publicipid: this.resource.id,\n          page: 1,\n          pagesize: 1\n        }).then(json => {\n          const loadBalancerRuleCount = json.listloadbalancerrulesresponse.count || 0\n          resolve(loadBalancerRuleCount)\n        }).catch(e => {\n          reject(e)\n        })\n      })\n    },\n    changeResource (resource) {\n      this.resource = resource\n    },\n    toggleLoading () {\n      this.loading = !this.loading\n    },\n    execAction (action, isGroupAction) {\n      eventBus.$emit('exec-action', action, isGroupAction)\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PublicIpResource.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PublicIpResource.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PublicIpResource.vue?vue&type=template&id=74a06dd3&\"\nimport script from \"./PublicIpResource.vue?vue&type=script&lang=js&\"\nexport * from \"./PublicIpResource.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}