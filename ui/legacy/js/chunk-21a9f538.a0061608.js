(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21a9f538"],{1512:function(e,t,a){},"1e1e":function(e,t,a){"use strict";var i=a("5356"),o=a.n(i);o.a},"4ab8":function(e,t,a){"use strict";var i=a("baa9"),o=a.n(i);o.a},5089:function(e,t,a){},5356:function(e,t,a){},"75c5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-spin",{staticClass:"form-layout",attrs:{spinning:e.loading}},[e.loading?e._e():a("a-tabs",{attrs:{defaultActiveKey:"1",animated:!1}},[e.isAdvancedZoneWithoutSGAvailable?a("a-tab-pane",{key:"1",attrs:{tab:e.$t("label.isolated")}},[a("CreateIsolatedNetworkForm",{attrs:{loading:e.loading,resource:e.resource},on:{"close-action":e.closeAction,"refresh-data":e.refreshParent,refresh:e.handleRefresh}})],1):e._e(),a("a-tab-pane",{key:"2",attrs:{tab:e.$t("label.l2")}},[a("CreateL2NetworkForm",{attrs:{loading:e.loading,resource:e.resource},on:{"close-action":e.closeAction,"refresh-data":e.refreshParent,refresh:e.handleRefresh}})],1),this.isAdmin()?a("a-tab-pane",{key:"3",attrs:{tab:e.$t("label.shared")}},[a("CreateSharedNetworkForm",{attrs:{loading:e.loading,resource:e.resource},on:{"close-action":e.closeAction,"refresh-data":e.refreshParent,refresh:e.handleRefresh}})],1):e._e()],1)],1)},o=[],s=(a("caad"),a("d3b7"),a("3ca3"),a("ddb0"),a("365c")),n=function(){var e=this,t=this,a=t.$createElement,i=t._self._c||a;return i("a-spin",{attrs:{spinning:t.loading}},[i("div",{staticClass:"form-layout"},[i("div",{staticClass:"form"},[i("a-form",{attrs:{form:t.form,layout:"vertical"},on:{submit:t.handleSubmit}},[i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.name"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.name.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:t.$t("message.error.name")}]}],expression:"['name', {\n              rules: [{ required: true, message: $t('message.error.name') }]\n            }]"}],attrs:{placeholder:this.$t("label.name")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.displaytext"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.displaytext.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["displaytext",{rules:[{required:!0,message:t.$t("message.error.display.text")}]}],expression:"['displaytext', {\n              rules: [{ required: true, message: $t('message.error.display.text') }]\n            }]"}],attrs:{placeholder:this.$t("label.display.text")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.zoneid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.zoneid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["zoneid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['zoneid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.zoneLoading,placeholder:this.$t("label.zoneid")},on:{change:function(t){e.handleZoneChange(e.zones[t])}}},t._l(this.zones,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1),this.isAdminOrDomainAdmin()?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.domain"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.domainid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["domainid",{}],expression:"['domainid', {}]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.domainLoading,placeholder:this.$t("label.domainid")},on:{change:function(t){e.handleDomainChange(e.domains[t])}}},t._l(this.domains,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1):t._e(),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.networkofferingid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.networkofferingid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["networkofferingid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['networkofferingid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.networkOfferingLoading,placeholder:this.$t("label.networkofferingid")},on:{change:function(t){e.handleNetworkOfferingChange(e.networkOfferings[t])}}},t._l(this.networkOfferings,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1),!this.isObjectEmpty(this.selectedNetworkOffering)&&this.selectedNetworkOffering.specifyvlan?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.vlan"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.vlan.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["vlanid",{rules:[{required:!0,message:t.$t("message.please.enter.value")}]}],expression:"['vlanid', {\n              rules: [{ required: true, message: $t('message.please.enter.value') }]\n            }]"}],attrs:{placeholder:this.$t("label.vlanid")}})],1):t._e(),!this.isObjectEmpty(this.selectedNetworkOffering)&&this.selectedNetworkOffering.forvpc?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.vpcid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.vpcid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["vpcid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['vpcid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.vpcLoading,placeholder:this.$t("label.vpcid")},on:{change:function(t){e.selectedVpc=e.vpcs[t]}}},t._l(this.vpcs,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1):t._e(),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.externalid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.externalid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["externalid",{}],expression:"['externalid', {}]"}],attrs:{placeholder:t.$t("label.externalid")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.gateway"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.gateway.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["gateway",{}],expression:"['gateway', {}]"}],attrs:{placeholder:this.$t("label.gateway")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.netmask"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.netmask.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["netmask",{}],expression:"['netmask', {}]"}],attrs:{placeholder:this.$t("label.netmask")}})],1),this.isObjectEmpty(this.selectedNetworkOffering)||this.selectedNetworkOffering.forvpc?t._e():i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.networkdomain"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.networkdomain.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["networkdomain",{}],expression:"['networkdomain', {}]"}],attrs:{placeholder:this.$t("label.networkdomain")}})],1),this.accountVisible?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.account"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.account.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["account"],expression:"['account']"}],attrs:{placeholder:this.$t("label.account")}})],1):t._e(),i("div",{staticClass:"action-button",attrs:{span:24}},[i("a-button",{attrs:{loading:t.actionLoading},on:{click:t.closeAction}},[t._v(" "+t._s(this.$t("label.cancel"))+" ")]),i("a-button",{attrs:{loading:t.actionLoading,type:"primary"},on:{click:t.handleSubmit}},[t._v(" "+t._s(this.$t("label.ok"))+" ")])],1)],1)],1)])])},r=[],l=(a("99af"),a("4160"),a("b0c0"),a("b64b"),a("159b"),{name:"CreateIsolatedNetworkForm",props:{loading:{type:Boolean,default:!1},vpc:{type:Object,default:null},resource:{type:Object,default:function(){return{}}}},data:function(){return{actionLoading:!1,domains:[],domainLoading:!1,selectedDomain:{},zones:[],zoneLoading:!1,selectedZone:{},networkOfferings:[],networkOfferingLoading:!1,selectedNetworkOffering:{},vpcs:[],vpcLoading:!1,selectedVpc:{},accountVisible:this.isAdminOrDomainAdmin()}},watch:{resource:function(e,t){this.fetchData()}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiConfig=this.$store.getters.apis.createNetwork||{},this.apiParams={},this.apiConfig.params.forEach((function(t){e.apiParams[t.name]=t}))},created:function(){this.domains=[{id:"-1",name:" "}]},mounted:function(){this.fetchData()},methods:{fetchData:function(){this.fetchDomainData(),this.fetchZoneData()},isAdmin:function(){return["Admin"].includes(this.$store.getters.userInfo.roletype)},isAdminOrDomainAdmin:function(){return["Admin","DomainAdmin"].includes(this.$store.getters.userInfo.roletype)},isObjectEmpty:function(e){return!(null!==e&&void 0!==e&&Object.keys(e).length>0&&e.constructor===Object)},arrayHasItems:function(e){return null!==e&&void 0!==e&&Array.isArray(e)&&e.length>0},isValidTextValueForKey:function(e,t){return t in e&&null!=e[t]&&e[t].length>0},fetchZoneData:function(){var e=this;this.zones=[];var t={};this.resource.zoneid&&"deployVirtualMachine"===this.$route.name&&(t.id=this.resource.zoneid),t.listAll=!0,this.zoneLoading=!0,Object(s["a"])("listZones",t).then((function(t){for(var a in t.listzonesresponse.zone){var i=t.listzonesresponse.zone[a];"Advanced"===i.networktype&&!0!==i.securitygroupsenabled&&e.zones.push(i)}e.zoneLoading=!1,e.arrayHasItems(e.zones)&&(e.form.setFieldsValue({zoneid:0}),e.handleZoneChange(e.zones[0]))}))},handleZoneChange:function(e){this.selectedZone=e,this.updateVPCCheckAndFetchNetworkOfferingData()},fetchDomainData:function(){var e=this,t={listAll:!0,details:"min"};this.domainLoading=!0,Object(s["a"])("listDomains",t).then((function(t){var a=t.listdomainsresponse.domain;e.domains=e.domains.concat(a)})).finally((function(){e.domainLoading=!1,e.form.setFieldsValue({domainid:0}),e.handleDomainChange(e.domains[0])}))},handleDomainChange:function(e){this.selectedDomain=e,this.accountVisible="-1"!==e.id,this.isAdminOrDomainAdmin()&&this.updateVPCCheckAndFetchNetworkOfferingData()},updateVPCCheckAndFetchNetworkOfferingData:function(){var e=this;if(null!==this.vpc)this.fetchNetworkOfferingData(!0);else{var t={};this.networkOfferingLoading=!0,Object(s["a"])("listVPCs",t).then((function(t){var a=t.listvpcsresponse.vpc,i=e.arrayHasItems(a);!1===i?e.fetchNetworkOfferingData(!1):e.fetchNetworkOfferingData()}))}},fetchNetworkOfferingData:function(e){var t=this;this.networkOfferingLoading=!0;var a={zoneid:this.selectedZone.id,guestiptype:"Isolated",supportedServices:"SourceNat",state:"Enabled"};this.isAdminOrDomainAdmin()&&"-1"!==this.selectedDomain.id&&(a.domainid=this.selectedDomain.id),this.isAdmin()||(a.specifyvlan=!1),null!==e&&(a.forvpc=e),this.networkOfferings=[],this.selectedNetworkOffering={},Object(s["a"])("listNetworkOfferings",a).then((function(e){t.networkOfferings=e.listnetworkofferingsresponse.networkoffering})).catch((function(e){t.$notifyError(e)})).finally((function(){t.networkOfferingLoading=!1,t.arrayHasItems(t.networkOfferings)&&(t.form.setFieldsValue({networkofferingid:0}),t.handleNetworkOfferingChange(t.networkOfferings[0]))}))},handleNetworkOfferingChange:function(e){this.selectedNetworkOffering=e,e.forvpc&&this.fetchVpcData()},fetchVpcData:function(){var e=this;this.vpcLoading=!0;var t={listAll:!0,details:"min"};null!==this.vpc&&(t.id=this.vpc.id),Object(s["a"])("listVPCs",t).then((function(t){e.vpcs=t.listvpcsresponse.vpc})).finally((function(){e.vpcLoading=!1,e.arrayHasItems(e.vpcs)&&(e.form.setFieldsValue({vpcid:0}),e.selectedVpc=e.vpcs[0])}))},handleSubmit:function(e){var t=this;this.form.validateFields((function(e,a){if(!e){t.actionLoading=!0;var i={zoneId:t.selectedZone.id,name:a.name,displayText:a.displaytext,networkOfferingId:t.selectedNetworkOffering.id};t.isValidTextValueForKey(a,"gateway")&&(i.gateway=a.gateway),t.isValidTextValueForKey(a,"netmask")&&(i.netmask=a.netmask),t.isValidTextValueForKey(a,"externalid")&&(i.externalid=a.externalid),t.isValidTextValueForKey(a,"vpcid")&&(i.vpcid=t.selectedVpc.id),t.isValidTextValueForKey(a,"vlanid")&&(i.vlan=a.vlanid),t.isValidTextValueForKey(a,"networkdomain")&&(i.networkdomain=a.networkdomain),"domainid"in a&&a.domainid>0&&(i.domainid=t.selectedDomain.id,t.isValidTextValueForKey(a,"account")&&(i.account=a.account)),Object(s["a"])("createNetwork",i).then((function(e){t.$notification.success({message:"Network",description:t.$t("message.success.create.isolated.network")}),t.$emit("refresh-data"),t.closeAction()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.actionLoading=!1}))}}))},showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},resetForm:function(){this.form.setFieldsValue({}),this.tags=[]},closeAction:function(){this.$emit("close-action")}}}),c=l,d=(a("b925"),a("2877")),p=Object(d["a"])(c,n,r,!1,null,"1c3c766e",null),f=p.exports,u=function(){var e=this,t=this,a=t.$createElement,i=t._self._c||a;return i("a-spin",{attrs:{spinning:t.loading}},[i("div",{staticClass:"form-layout"},[i("div",{staticClass:"form"},[i("a-form",{attrs:{form:t.form,layout:"vertical"},on:{submit:t.handleSubmit}},[i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.name"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.name.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:t.$t("message.error.name")}]}],expression:"['name', {\n              rules: [{ required: true, message: $t('message.error.name') }]\n            }]"}],attrs:{placeholder:this.$t("label.name")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.displaytext"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.displaytext.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["displaytext",{rules:[{required:!0,message:t.$t("message.error.display.text")}]}],expression:"['displaytext', {\n              rules: [{ required: true, message: $t('message.error.display.text') }]\n            }]"}],attrs:{placeholder:this.$t("label.displaytext")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.zoneid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.zoneid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["zoneid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['zoneid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.zoneLoading,placeholder:this.$t("label.zoneid")},on:{change:function(t){e.handleZoneChange(e.zones[t])}}},t._l(this.zones,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1),this.isAdminOrDomainAdmin()?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.domain"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.domainid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["domainid",{}],expression:"['domainid', {}]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.domainLoading,placeholder:this.$t("label.domainid")},on:{change:function(t){e.handleDomainChange(e.domains[t])}}},t._l(this.domains,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1):t._e(),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.networkofferingid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.networkofferingid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["networkofferingid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['networkofferingid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.networkOfferingLoading,placeholder:this.$t("label.networkofferingid")},on:{change:function(t){e.handleNetworkOfferingChange(e.networkOfferings[t])}}},t._l(this.networkOfferings,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1),!this.isObjectEmpty(this.selectedNetworkOffering)&&this.selectedNetworkOffering.specifyvlan?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.vlan"))+" "),"vlan"in t.apiParams?i("a-tooltip",{attrs:{title:t.apiParams.vlan.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1):t._e()],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["vlanid",{rules:[{required:!0,message:t.$t("message.please.enter.value")}]}],expression:"['vlanid', {\n              rules: [{ required: true, message: $t('message.please.enter.value') }]\n            }]"}],attrs:{placeholder:this.$t("label.vlanid")}})],1):t._e(),!this.isObjectEmpty(this.selectedNetworkOffering)&&this.selectedNetworkOffering.specifyvlan?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.bypassvlanoverlapcheck"))+" "),"bypassvlanoverlapcheck"in t.apiParams?i("a-tooltip",{attrs:{title:t.apiParams.bypassvlanoverlapcheck.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1):t._e()],1),i("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["bypassvlanoverlapcheck"],expression:"['bypassvlanoverlapcheck']"}]})],1):t._e(),!this.isObjectEmpty(this.selectedNetworkOffering)&&this.selectedNetworkOffering.specifyvlan?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.isolatedpvlantype"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.isolatedpvlantype.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isolatedpvlantype",{initialValue:this.isolatePvlanType}],expression:"['isolatedpvlantype', {\n              initialValue: this.isolatePvlanType\n            }]"}],attrs:{buttonStyle:"solid"},on:{change:function(t){e.isolatePvlanType=t.target.value}}},[i("a-radio-button",{attrs:{value:"none"}},[t._v(" "+t._s(t.$t("label.none"))+" ")]),i("a-radio-button",{attrs:{value:"community"}},[t._v(" "+t._s(t.$t("label.community"))+" ")]),i("a-radio-button",{attrs:{value:"isolated"}},[t._v(" "+t._s(t.$t("label.secondary.isolated.vlan.type.isolated"))+" ")]),i("a-radio-button",{attrs:{value:"promiscuous"}},[t._v(" "+t._s(t.$t("label.secondary.isolated.vlan.type.promiscuous"))+" ")])],1)],1):t._e(),"community"==this.isolatePvlanType||"isolated"==this.isolatePvlanType?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.isolatedpvlanid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.isolatedpvlan.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["isolatedpvlan",{}],expression:"['isolatedpvlan', {}]"}],attrs:{placeholder:this.$t("label.isolatedpvlanid")}})],1):t._e(),this.accountVisible?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.account"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.account.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["account"],expression:"['account']"}],attrs:{placeholder:this.$t("label.account")}})],1):t._e(),i("div",{staticClass:"action-button",attrs:{span:24}},[i("a-button",{attrs:{loading:t.actionLoading},on:{click:t.closeAction}},[t._v(" "+t._s(this.$t("label.cancel"))+" ")]),i("a-button",{attrs:{loading:t.actionLoading,type:"primary"},on:{click:t.handleSubmit}},[t._v(" "+t._s(this.$t("label.ok"))+" ")])],1)],1)],1)])])},h=[],m={name:"CreateL2NetworkForm",props:{loading:{type:Boolean,default:!1},vpc:{type:Object,default:null},resource:{type:Object,default:function(){return{}}}},data:function(){return{actionLoading:!1,domains:[],domainLoading:!1,selectedDomain:{},zones:[],zoneLoading:!1,selectedZone:{},networkOfferings:[],networkOfferingLoading:!1,selectedNetworkOffering:{},accountVisible:this.isAdminOrDomainAdmin(),isolatePvlanType:"none"}},watch:{resource:function(e,t){this.fetchData()}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiConfig=this.$store.getters.apis.createNetwork||{},this.apiParams={},this.apiConfig.params.forEach((function(t){e.apiParams[t.name]=t}))},created:function(){this.domains=[{id:"-1",name:" "}]},mounted:function(){this.fetchData()},methods:{fetchData:function(){this.fetchDomainData(),this.fetchZoneData()},isAdmin:function(){return["Admin"].includes(this.$store.getters.userInfo.roletype)},isAdminOrDomainAdmin:function(){return["Admin","DomainAdmin"].includes(this.$store.getters.userInfo.roletype)},isObjectEmpty:function(e){return!(null!==e&&void 0!==e&&Object.keys(e).length>0&&e.constructor===Object)},arrayHasItems:function(e){return null!==e&&void 0!==e&&Array.isArray(e)&&e.length>0},isValidValueForKey:function(e,t){return t in e&&null!=e[t]},isValidTextValueForKey:function(e,t){return this.isValidValueForKey(e,t)&&e[t].length>0},fetchZoneData:function(){var e=this;this.zones=[];var t={};this.resource.zoneid&&"deployVirtualMachine"===this.$route.name&&(t.id=this.resource.zoneid),t.listAll=!0,this.zoneLoading=!0,Object(s["a"])("listZones",t).then((function(t){for(var a in t.listzonesresponse.zone){var i=t.listzonesresponse.zone[a];"Advanced"===i.networktype&&e.zones.push(i)}e.zoneLoading=!1,e.arrayHasItems(e.zones)&&(e.form.setFieldsValue({zoneid:0}),e.handleZoneChange(e.zones[0]))}))},handleZoneChange:function(e){this.selectedZone=e,this.updateVPCCheckAndFetchNetworkOfferingData()},fetchDomainData:function(){var e=this,t={listAll:!0,details:"min"};this.domainLoading=!0,Object(s["a"])("listDomains",t).then((function(t){var a=t.listdomainsresponse.domain;e.domains=e.domains.concat(a)})).finally((function(){e.domainLoading=!1,e.form.setFieldsValue({domainid:0}),e.handleDomainChange(e.domains[0])}))},handleDomainChange:function(e){this.selectedDomain=e,this.accountVisible="-1"!==e.id,this.isAdminOrDomainAdmin()&&this.updateVPCCheckAndFetchNetworkOfferingData()},updateVPCCheckAndFetchNetworkOfferingData:function(){var e=this;if(null!==this.vpc)this.fetchNetworkOfferingData(!0);else{var t={};this.networkOfferingLoading=!0,Object(s["a"])("listVPCs",t).then((function(t){var a=t.listvpcsresponse.vpc,i=e.arrayHasItems(a);!1===i?e.fetchNetworkOfferingData(!1):e.fetchNetworkOfferingData()}))}},fetchNetworkOfferingData:function(e){var t=this;this.networkOfferingLoading=!0;var a={zoneid:this.selectedZone.id,guestiptype:"L2",state:"Enabled"};this.isAdminOrDomainAdmin()&&"-1"!==this.selectedDomain.id&&(a.domainid=this.selectedDomain.id),this.isAdmin()||(a.specifyvlan=!1),null!==e&&(a.forvpc=e),Object(s["a"])("listNetworkOfferings",a).then((function(e){t.networkOfferings=e.listnetworkofferingsresponse.networkoffering})).catch((function(e){t.$notifyError(e)})).finally((function(){t.networkOfferingLoading=!1,t.arrayHasItems(t.networkOfferings)&&(t.form.setFieldsValue({networkofferingid:0}),t.handleNetworkOfferingChange(t.networkOfferings[0]))}))},handleNetworkOfferingChange:function(e){this.selectedNetworkOffering=e},handleSubmit:function(e){var t=this;this.form.validateFields((function(e,a){if(!e){t.actionLoading=!0;var i={zoneId:t.selectedZone.id,name:a.name,displayText:a.displaytext,networkOfferingId:t.selectedNetworkOffering.id};t.isValidTextValueForKey(a,"vlanid")&&(i.vlan=a.vlanid),t.isValidValueForKey(a,"bypassvlanoverlapcheck")&&(i.bypassvlanoverlapcheck=a.bypassvlanoverlapcheck),"domainid"in a&&a.domainid>0&&(i.domainid=t.selectedDomain.id,t.isValidTextValueForKey(a,"account")&&(i.account=a.account)),t.isValidValueForKey(a,"isolatedpvlantype")&&"none"!==a.isolatedpvlantype&&(i.isolatedpvlantype=a.isolatedpvlantype,t.isValidValueForKey(a,"isolatedpvlan")&&(i.isolatedpvlan=a.isolatedpvlan)),Object(s["a"])("createNetwork",i).then((function(e){t.$notification.success({message:"Network",description:t.$t("message.success.create.l2.network")}),t.$emit("refresh-data"),t.closeAction()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.actionLoading=!1}))}}))},showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},resetForm:function(){this.form.setFieldsValue({}),this.tags=[]},closeAction:function(){this.$emit("close-action")}}},v=m,g=(a("7b09"),Object(d["a"])(v,u,h,!1,null,"4c380839",null)),y=g.exports,b=function(){var e=this,t=this,a=t.$createElement,i=t._self._c||a;return i("a-spin",{attrs:{spinning:t.loading}},[i("div",{staticClass:"form-layout"},[i("div",{staticClass:"form"},[i("a-form",{attrs:{form:t.form,layout:"vertical"},on:{submit:t.handleSubmit}},[i("a-form-item",{attrs:{label:t.$t("label.name")}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.name"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.name.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:t.$t("message.error.name")}]}],expression:"['name', {\n              rules: [{ required: true, message: $t('message.error.name') }]\n            }]"}],attrs:{placeholder:this.$t("label.name")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.displaytext"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.displaytext.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["displaytext",{rules:[{required:!0,message:t.$t("message.error.display.text")}]}],expression:"['displaytext', {\n              rules: [{ required: true, message: $t('message.error.display.text') }]\n            }]"}],attrs:{placeholder:this.$t("label.display.text")}})],1),this.isObjectEmpty(this.zone)?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.zoneid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.zoneid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["zoneid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['zoneid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.zoneLoading,placeholder:this.$t("label.zoneid")},on:{change:function(t){e.handleZoneChange(e.zones[t])}}},t._l(this.zones,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1):t._e(),this.isObjectEmpty(this.zone)?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.physicalnetworkid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.physicalnetworkid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["physicalnetworkid",{}],expression:"['physicalnetworkid', {}]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.zoneLoading,placeholder:this.$t("label.physicalnetworkid")},on:{change:function(t){e.handlePhysicalNetworkChange(e.formPhysicalNetworks[t])}}},t._l(this.formPhysicalNetworks,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1):t._e(),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.vlan"))+" "),"vlan"in t.apiParams?i("a-tooltip",{attrs:{title:t.apiParams.vlan.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1):t._e()],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["vlanid",{rules:[{required:!0,message:t.$t("message.please.enter.value")}]}],expression:"['vlanid', {\n              rules: [{ required: true, message: $t('message.please.enter.value') }]\n            }]"}],attrs:{placeholder:this.$t("label.vlanid")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.bypassvlanoverlapcheck"))+" "),"bypassvlanoverlapcheck"in t.apiParams?i("a-tooltip",{attrs:{title:t.apiParams.bypassvlanoverlapcheck.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1):t._e()],1),i("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["bypassvlanoverlapcheck"],expression:"['bypassvlanoverlapcheck']"}]})],1),!this.isObjectEmpty(this.selectedNetworkOffering)&&this.selectedNetworkOffering.specifyvlan?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.isolatedpvlantype"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.isolatedpvlantype.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isolatedpvlantype",{initialValue:this.isolatePvlanType}],expression:"['isolatedpvlantype', {\n              initialValue: this.isolatePvlanType\n            }]"}],attrs:{buttonStyle:"solid"},on:{change:function(t){e.handleIsolatedPvlanTypeChange(t.target.value)}}},[i("a-radio-button",{attrs:{value:"none"}},[t._v(" "+t._s(t.$t("label.none"))+" ")]),i("a-radio-button",{attrs:{value:"community"}},[t._v(" "+t._s(t.$t("label.community"))+" ")]),i("a-radio-button",{attrs:{value:"isolated"}},[t._v(" "+t._s(t.$t("label.secondary.isolated.vlan.type.isolated"))+" ")]),i("a-radio-button",{attrs:{value:"promiscuous"}},[t._v(" "+t._s(t.$t("label.secondary.isolated.vlan.type.promiscuous"))+" ")])],1)],1):t._e(),"community"==this.isolatePvlanType||"isolated"==this.isolatePvlanType?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.isolatedpvlanid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.isolatedpvlan.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["isolatedpvlan",{}],expression:"['isolatedpvlan', {}]"}],attrs:{placeholder:this.$t("label.isolatedpvlanid")}})],1):t._e(),i("a-form-item",{attrs:{label:t.$t("label.scope")}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["scope",{initialValue:this.scopeType}],expression:"['scope', {\n              initialValue: this.scopeType\n            }]"}],attrs:{buttonStyle:"solid"},on:{change:function(t){e.handleScopeTypeChange(t.target.value)}}},[i("a-radio-button",{attrs:{value:"all"}},[t._v(" "+t._s(t.$t("label.all"))+" ")]),this.parseBooleanValueForKey(this.selectedZone,"securitygroupsenabled")?t._e():i("a-radio-button",{attrs:{value:"domain"}},[t._v(" "+t._s(t.$t("label.domain"))+" ")]),this.parseBooleanValueForKey(this.selectedZone,"securitygroupsenabled")?t._e():i("a-radio-button",{attrs:{value:"account"}},[t._v(" "+t._s(t.$t("label.account"))+" ")]),this.parseBooleanValueForKey(this.selectedZone,"securitygroupsenabled")?t._e():i("a-radio-button",{attrs:{value:"project"}},[t._v(" "+t._s(t.$t("label.project"))+" ")])],1)],1),"all"!==this.scopeType?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.domain"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.domainid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["domainid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['domainid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.domainLoading,placeholder:this.$t("label.domainid")},on:{change:function(t){e.handleDomainChange(e.domains[t])}}},t._l(this.domains,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1):t._e(),"domain"===this.scopeType?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.subdomainaccess"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.subdomainaccess.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["subdomainaccess"],expression:"['subdomainaccess']"}]})],1):t._e(),"account"===this.scopeType?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.account"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.account.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["account",{}],expression:"['account', {}]"}],attrs:{placeholder:this.$t("label.account")}})],1):t._e(),"project"===this.scopeType?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.projectid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.projectid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["projectid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['projectid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.projectLoading,placeholder:this.$t("label.projectid")},on:{change:function(t){e.handleProjectChange(e.projects[t])}}},t._l(this.projects,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1):t._e(),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.networkofferingid"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.networkofferingid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["networkofferingid",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['networkofferingid', {\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]"}],attrs:{showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:t.networkOfferingLoading,placeholder:this.$t("label.networkofferingid")},on:{change:function(t){e.handleNetworkOfferingChange(e.networkOfferings[t])}}},t._l(this.networkOfferings,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.ip4gateway"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.gateway.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ip4gateway",{}],expression:"['ip4gateway', {}]"}],attrs:{placeholder:this.$t("label.ip4gateway")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.ip4netmask"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.netmask.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["netmask",{}],expression:"['netmask', {}]"}],attrs:{placeholder:this.$t("label.netmask")}})],1),i("a-form-item",{attrs:{label:t.$t("label.startipv4")}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.startipv4"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.startip.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["startipv4",{}],expression:"['startipv4', {}]"}],attrs:{placeholder:this.$t("label.startipv4")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.endipv4"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.endip.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["endipv4",{}],expression:"['endipv4', {}]"}],attrs:{placeholder:this.$t("label.endipv4")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.ip6gateway"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.ip6gateway.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ip6gateway",{}],expression:"['ip6gateway', {}]"}],attrs:{placeholder:this.$t("label.ip6gateway")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.ip6cidr"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.ip6cidr.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ip6cidr",{}],expression:"['ip6cidr', {}]"}],attrs:{placeholder:this.$t("label.ip6cidr")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.startipv6"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.startipv6.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["startipv6",{}],expression:"['startipv6', {}]"}],attrs:{placeholder:this.$t("label.startipv6")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.endipv6"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.endipv6.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["endipv6",{}],expression:"['endipv6', {}]"}],attrs:{placeholder:this.$t("label.endipv6")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.networkdomain"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.networkdomain.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["networkdomain",{}],expression:"['networkdomain', {}]"}],attrs:{placeholder:this.$t("label.networkdomain")}})],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.hideipaddressusage"))+" "),"hideipaddressusage"in t.apiParams?i("a-tooltip",{attrs:{title:t.apiParams.hideipaddressusage.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1):t._e()],1),i("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["hideipaddressusage"],expression:"['hideipaddressusage']"}]})],1),i("div",{staticClass:"action-button",attrs:{span:24}},[i("a-button",{attrs:{loading:t.actionLoading},on:{click:t.closeAction}},[t._v(" "+t._s(this.$t("label.cancel"))+" ")]),i("a-button",{attrs:{loading:t.actionLoading,type:"primary"},on:{click:t.handleSubmit}},[t._v(" "+t._s(this.$t("label.ok"))+" ")])],1)],1)],1)])])},w=[],k={name:"CreateGuestNetworkForm",props:{loading:{type:Boolean,default:!1},zone:{type:Object,default:null},physicalNetworks:{type:Array,default:null},resource:{type:Object,default:function(){return{}}}},data:function(){return{actionLoading:!1,zones:[],zoneLoading:!1,selectedZone:{},formPhysicalNetworks:[],formPhysicalNetworkLoading:!1,formSelectedPhysicalNetwork:{},isolatePvlanType:"none",scopeType:"all",domains:[],domainLoading:!1,selectedDomain:{},networkOfferings:[],networkOfferingLoading:!1,selectedNetworkOffering:{},projects:[],projectLoading:!1,selectedProject:{}}},watch:{resource:function(e,t){this.fetchData()}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiConfig=this.$store.getters.apis.createNetwork||{},this.apiParams={},this.apiConfig.params.forEach((function(t){e.apiParams[t.name]=t}))},created:function(){},mounted:function(){this.fetchData()},methods:{fetchData:function(){this.isObjectEmpty(this.zone)?this.fetchZoneData():this.fetchNetworkOfferingData()},isAdmin:function(){return["Admin"].includes(this.$store.getters.userInfo.roletype)},isAdminOrDomainAdmin:function(){return["Admin","DomainAdmin"].includes(this.$store.getters.userInfo.roletype)},isObjectEmpty:function(e){return!(null!==e&&void 0!==e&&Object.keys(e).length>0&&e.constructor===Object)},arrayHasItems:function(e){return null!==e&&void 0!==e&&Array.isArray(e)&&e.length>0},isValidValueForKey:function(e,t){return t in e&&null!=e[t]},parseBooleanValueForKey:function(e,t){return this.isValidValueForKey(e,t)&&!0===e[t]},isValidTextValueForKey:function(e,t){return this.isValidValueForKey(e,t)&&e[t].length>0},fetchZoneData:function(){var e=this;if(this.zones=[],null!==this.zone)this.zones.push(this.zone),this.arrayHasItems(this.zones)&&(this.form.setFieldsValue({zoneid:0}),this.handleZoneChange(this.zones[0]));else{var t={};this.resource.zoneid&&"deployVirtualMachine"===this.$route.name&&(t.id=this.resource.zoneid),t.listAll=!0,this.zoneLoading=!0,Object(s["a"])("listZones",t).then((function(t){for(var a in t.listzonesresponse.zone){var i=t.listzonesresponse.zone[a];"Advanced"===i.networktype&&e.zones.push(i)}})).finally((function(){e.zoneLoading=!1,e.arrayHasItems(e.zones)&&(e.form.setFieldsValue({zoneid:0}),e.handleZoneChange(e.zones[0]))}))}},handleZoneChange:function(e){this.selectedZone=e,this.fetchPhysicalNetworkData()},fetchPhysicalNetworkData:function(){var e=this;if(null!=this.physicalNetworks)this.formPhysicalNetworks=this.physicalNetworks,this.arrayHasItems(this.formPhysicalNetworks)&&(this.form.setFieldsValue({physicalnetworkid:0}),this.handlePhysicalNetworkChange(this.formPhysicalNetworks[0]));else{if(null===this.selectedZone||void 0===this.selectedZone)return;var t={};t.zoneid=this.selectedZone.id,this.formPhysicalNetworksLoading=!0,Object(s["a"])("listPhysicalNetworks",t).then((function(t){e.formPhysicalNetworks=[];var a=t.listphysicalnetworksresponse.physicalnetwork;if(e.arrayHasItems(a))for(var i in a)e.addPhysicalNetworkForGuestTrafficType(a[i],1*i===a.length-1);else e.formPhysicalNetworkLoading=!1})).finally((function(){}))}},addPhysicalNetworkForGuestTrafficType:function(e,t){var a=this,i={};i.physicalnetworkid=e.id,Object(s["a"])("listTrafficTypes",i).then((function(t){var i=t.listtraffictypesresponse.traffictype;if(a.arrayHasItems(i)){for(var o in i)if("Guest"===i[o].traffictype){a.formPhysicalNetworks.push(e);break}}else a.formPhysicalNetworkLoading=!1})).finally((function(){t&&(a.form.setFieldsValue({physicalnetworkid:0}),a.handlePhysicalNetworkChange(a.formPhysicalNetworks[0]))}))},handlePhysicalNetworkChange:function(e){this.formSelectedPhysicalNetwork=e,this.fetchNetworkOfferingData()},handleIsolatedPvlanTypeChange:function(e){this.isolatePvlanType=e},handleScopeTypeChange:function(e){switch(this.scopeType=e,e){case"domain":this.fetchDomainData();break;case"project":this.fetchDomainData(),this.fetchProjectData(),this.fetchNetworkOfferingData();break;default:this.fetchNetworkOfferingData()}},fetchNetworkOfferingData:function(){var e=this;if(!this.isObjectEmpty(this.selectedZone)){this.networkOfferingLoading=!0;var t={zoneid:this.selectedZone.id,state:"Enabled"};!this.isObjectEmpty(this.formSelectedPhysicalNetwork)&&this.formSelectedPhysicalNetwork.tags&&this.formSelectedPhysicalNetwork.tags.length>0&&(t.tags=this.formSelectedPhysicalNetwork.tags),"all"!==this.scopeType&&"domain"!==this.scopeType||(t.guestiptype="Shared","domain"===this.scopeType&&(t.domainid=this.selectedDomain.id)),this.handleNetworkOfferingChange(null),this.networkOfferings=[],Object(s["a"])("listNetworkOfferings",t).then((function(t){e.networkOfferings=t.listnetworkofferingsresponse.networkoffering})).catch((function(t){e.$notifyError(t)})).finally((function(){e.networkOfferingLoading=!1,e.arrayHasItems(e.networkOfferings)?(e.form.setFieldsValue({networkofferingid:0}),e.handleNetworkOfferingChange(e.networkOfferings[0])):e.form.setFieldsValue({networkofferingid:null})}))}},handleNetworkOfferingChange:function(e){this.selectedNetworkOffering=e},fetchDomainData:function(){var e=this,t={};this.isObjectEmpty(this.selectedZone)||null==this.selectedZone.domainid?t.listall=!0:(t.id=this.selectedZone.id,t.isrecursive=!0),this.domainLoading=!0,Object(s["a"])("listDomains",t).then((function(t){var a=t.listdomainsresponse.domain;e.domains=e.domains.concat(a)})).finally((function(){e.domainLoading=!1,e.form.setFieldsValue({domainid:0}),e.handleDomainChange(e.domains[0])}))},handleDomainChange:function(e){this.selectedDomain=e,this.isObjectEmpty(e)||this.fetchNetworkOfferingData()},fetchProjectData:function(){var e=this;this.projects=[];var t={listall:!0,details:"min"};this.projectLoading=!0,Object(s["a"])("listProjects",t).then((function(t){var a=t.listprojectsresponse.project;e.projects=e.projects.concat(a)})).finally((function(){e.projectLoading=!1,e.arrayHasItems(e.projects)&&(e.form.setFieldsValue({projectid:0}),e.handleProjectChange(e.projects[0]))}))},handleProjectChange:function(e){this.selectedProject=e},handleSubmit:function(e){var t=this;this.form.validateFields((function(e,a){if(!e){t.isValidTextValueForKey(a,"ip4gateway")||t.isValidTextValueForKey(a,"netmask")||t.isValidTextValueForKey(a,"startipv4")||t.isValidTextValueForKey(a,"endipv4")||t.isValidTextValueForKey(a,"ip6gateway")||t.isValidTextValueForKey(a,"ip6cidr")||t.isValidTextValueForKey(a,"startipv6")||t.isValidTextValueForKey(a,"endipv6")||t.$notification.error({message:t.$t("message.request.failed"),description:t.$t("message.error.add.guest.network")}),t.actionLoading=!0;var i={zoneId:t.selectedZone.id,name:a.name,displayText:a.displaytext,networkOfferingId:t.selectedNetworkOffering.id};"Shared"===t.selectedNetworkOffering.guestiptype&&(i.physicalnetworkid=t.formSelectedPhysicalNetwork.id),t.isValidTextValueForKey(a,"vlanid")&&(i.vlan=a.vlanid),t.isValidValueForKey(a,"bypassvlanoverlapcheck")&&(i.bypassvlanoverlapcheck=a.bypassvlanoverlapcheck),t.isValidValueForKey(a,"isolatedpvlantype")&&"none"!==a.isolatedpvlantype&&(i.isolatedpvlantype=a.isolatedpvlantype,t.isValidValueForKey(a,"isolatedpvlan")&&(i.isolatedpvlan=a.isolatedpvlan)),"all"!==t.scopeType?(i.domainid=t.selectedDomain.id,i.acltype=t.scopeType,"account"===t.scopeType?i.account=a.account:"project"===t.scopeType?i.projectid=t.selectedProject.id:i.subdomainaccess=t.parseBooleanValueForKey(a,"subdomainaccess")):i.acltype="domain",t.isValidTextValueForKey(a,"ip4gateway")&&(i.gateway=a.ip4gateway),t.isValidTextValueForKey(a,"netmask")&&(i.netmask=a.netmask),t.isValidTextValueForKey(a,"startipv4")&&(i.startip=a.startipv4),t.isValidTextValueForKey(a,"endipv4")&&(i.endip=a.endipv4),t.isValidTextValueForKey(a,"ip4gateway")&&(i.ip6gateway=a.ip6gateway),t.isValidTextValueForKey(a,"ip6cidr")&&(i.ip6cidr=a.ip6cidr),t.isValidTextValueForKey(a,"startipv6")&&(i.startipv6=a.startipv6),t.isValidTextValueForKey(a,"endipv6")&&(i.endipv6=a.endipv6),t.isValidTextValueForKey(a,"networkdomain")&&(i.networkdomain=a.networkdomain);var o=t.parseBooleanValueForKey(a,"hideipaddressusage");o&&(i.hideipaddressusage=!0),Object(s["a"])("createNetwork",i).then((function(e){t.$notification.success({message:t.$t("label.network"),description:t.$t("message.success.add.guest.network")}),t.resetForm(),t.$emit("refresh-data"),t.closeAction()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.actionLoading=!1}))}}))},showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},resetForm:function(){this.form.setFieldsValue({}),this.tags=[]},closeAction:function(){this.$emit("close-action")}}},$=k,_=(a("4ab8"),Object(d["a"])($,b,w,!1,null,"7823e17b",null)),O=_.exports,N={name:"CreateNetwork",components:{CreateIsolatedNetworkForm:f,CreateL2NetworkForm:y,CreateSharedNetworkForm:O},props:{resource:{type:Object,required:!0}},data:function(){return{isAdvancedZoneWithoutSGAvailable:!0,defaultNetworkTypeTabKey:"1",loading:!1,actionZones:[],actionZoneLoading:!1}},watch:{resource:function(e,t){this.fetchData()}},created:function(){var e=this,t=[];t.push(this.fetchActionZoneData()),Promise.all(t).then((function(){for(var t in e.actionZones){var a=e.actionZones[t];if("Advanced"===a.networktype&&!0!==a.securitygroupsenabled)return void(e.isAdvancedZoneWithoutSGAvailable=!0)}e.isAdvancedZoneWithoutSGAvailable=!1}))},methods:{isAdmin:function(){return["Admin"].includes(this.$store.getters.userInfo.roletype)},fetchActionZoneData:function(){var e=this;this.loading=!0;var t={};return this.resource&&this.resource.zoneid&&(t.id=this.resource.zoneid),t.listAll=!0,this.actionZonesLoading=!0,Object(s["a"])("listZones",t).then((function(t){e.actionZones=t.listzonesresponse.zone})).finally((function(){e.actionZoneLoading=!1,e.loading=!1}))},handleRefresh:function(){this.fetchData()},refreshParent:function(){this.$emit("refresh-data")},closeAction:function(){this.$emit("close-action")}}},x=N,V=(a("1e1e"),Object(d["a"])(x,i,o,!1,null,"578a354a",null));t["default"]=V.exports},"7b09":function(e,t,a){"use strict";var i=a("5089"),o=a.n(i);o.a},b925:function(e,t,a){"use strict";var i=a("1512"),o=a.n(i);o.a},baa9:function(e,t,a){}}]);
//# sourceMappingURL=chunk-21a9f538.a0061608.js.map