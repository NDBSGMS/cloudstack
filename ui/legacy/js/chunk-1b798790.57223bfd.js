(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b798790"],{"44a2":function(e,t,a){},bcb9:function(e,t,a){"use strict";var i=a("44a2"),s=a.n(i);s.a},fa2a:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"form-layout"},[i("a-spin",{attrs:{spinning:t.loading}},[i("a-form",{attrs:{form:t.form,loading:t.loading,layout:"vertical"},on:{submit:t.handleSubmit}},[i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.username"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.username.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,message:t.$t("message.error.required.input")}]}],expression:"['username', {\n            rules: [{ required: true, message: $t('message.error.required.input') }]\n          }]"}],attrs:{placeholder:t.apiParams.username.description}})],1),i("a-row",{attrs:{gutter:12}},[i("a-col",{attrs:{md:24,lg:12}},[i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.password"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.password.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:t.$t("message.error.required.input")}]}],expression:"['password', {\n                rules: [{ required: true, message: $t('message.error.required.input') }]\n              }]"}],attrs:{placeholder:t.apiParams.password.description}})],1)],1),i("a-col",{attrs:{md:24,lg:12}},[i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.confirmpassword"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.password.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["confirmpassword",{rules:[{required:!0,message:t.$t("message.error.required.input")},{validator:t.validateConfirmPassword}]}],expression:"['confirmpassword', {\n                rules: [\n                  { required: true, message: $t('message.error.required.input') },\n                  { validator: validateConfirmPassword }\n                ]\n              }]"}],attrs:{placeholder:t.apiParams.password.description}})],1)],1)],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.email"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.email.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{required:!0,message:t.$t("message.error.required.input")}]}],expression:"['email', {\n            rules: [{ required: true, message: $t('message.error.required.input') }]\n          }]"}],attrs:{placeholder:t.apiParams.email.description}})],1),i("a-row",{attrs:{gutter:12}},[i("a-col",{attrs:{md:24,lg:12}},[i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.firstname"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.firstname.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["firstname",{rules:[{required:!0,message:t.$t("message.error.required.input")}]}],expression:"['firstname', {\n                rules: [{ required: true, message: $t('message.error.required.input') }]\n              }]"}],attrs:{placeholder:t.apiParams.firstname.description}})],1)],1),i("a-col",{attrs:{md:24,lg:12}},[i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.lastname"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.lastname.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["lastname",{rules:[{required:!0,message:t.$t("message.error.required.input")}]}],expression:"['lastname', {\n                rules: [{ required: true, message: $t('message.error.required.input') }]\n              }]"}],attrs:{placeholder:t.apiParams.lastname.description}})],1)],1)],1),this.isAdminOrDomainAdmin()&&!t.domainid?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.domain"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.domainid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["domainid"],expression:"['domainid']"}],attrs:{loading:t.domainLoading,placeholder:t.apiParams.domainid.description}},t._l(t.domainsList,(function(e){return i("a-select-option",{key:e.id},[t._v(" "+t._s(e.name)+" ")])})),1)],1):t._e(),t.account?t._e():i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.account"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.account.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["account"],expression:"['account']"}],attrs:{loading:t.loadingAccount,placeholder:t.apiParams.account.description}},t._l(t.accountList,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.name)+" ")])})),1)],1),i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.timezone"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.timezone.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["timezone"],expression:"['timezone']"}],attrs:{showSearch:"",loading:t.timeZoneLoading}},t._l(t.timeZoneMap,(function(e){return i("a-select-option",{key:e.id},[t._v(" "+t._s(e.name||e.description)+" ")])})),1)],1),"authorizeSamlSso"in t.$store.getters.apis?i("div",[i("a-form-item",{attrs:{label:t.$t("label.samlenable")}},[i("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["samlenable"],expression:"['samlenable']"}],on:{change:function(t){e.samlEnable=t}}})],1),t.samlEnable?i("a-form-item",[i("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$t("label.samlentity"))+" "),i("a-tooltip",{attrs:{title:t.apiParams.entityid.description}},[i("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["samlentity",{initialValue:t.selectedIdp}],expression:"['samlentity', {\n              initialValue: selectedIdp,\n            }]"}],attrs:{loading:t.idpLoading}},t._l(t.idps,(function(e,a){return i("a-select-option",{key:a},[t._v(" "+t._s(e.orgName)+" ")])})),1)],1):t._e()],1):t._e(),i("div",{staticClass:"action-button",attrs:{span:24}},[i("a-button",{on:{click:t.closeAction}},[t._v(t._s(t.$t("label.cancel")))]),i("a-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("label.ok")))])],1)],1)],1)],1)},s=[],r=(a("99af"),a("4160"),a("caad"),a("b0c0"),a("d3b7"),a("159b"),a("365c")),o=a("e95a3"),n=a("b047"),l=a.n(n),c={name:"AddUser",data:function(){return this.fetchTimeZone=l()(this.fetchTimeZone,800),{loading:!1,timeZoneLoading:!1,timeZoneMap:[],domainLoading:!1,domainsList:[],selectedDomain:"",samlEnable:!1,idpLoading:!1,idps:[],selectedIdp:"",loadingAccount:!1,accountList:[],account:null,domainid:null}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiConfig=this.$store.getters.apis.createUser||{},this.apiParams={},this.apiConfig.params.forEach((function(t){e.apiParams[t.name]=t})),this.apiConfig=this.$store.getters.apis.authorizeSamlSso||{},this.apiConfig.params.forEach((function(t){e.apiParams[t.name]=t}))},mounted:function(){this.fetchData()},methods:{fetchData:function(){this.account=this.$route.query&&this.$route.query.account?this.$route.query.account:null,this.domainid=this.$route.query&&this.$route.query.domainid?this.$route.query.domainid:null,this.domianid||this.fetchDomains(),this.account||this.fetchAccount(),this.fetchTimeZone(),"listIdps"in this.$store.getters.apis&&this.fetchIdps()},fetchDomains:function(){var e=this;this.domainLoading=!0,Object(r["a"])("listDomains",{listAll:!0,details:"min"}).then((function(t){e.domainsList=t.listdomainsresponse.domain||[],e.selectedDomain=e.domainsList[0].id||""})).catch((function(t){e.$notification.error({message:"".concat(e.$t("label.error")," ").concat(t.response.status),description:t.response.data.errorresponse.errortext})})).finally((function(){e.domainLoading=!1}))},fetchAccount:function(){var e=this;this.accountList=[],this.loadingAccount=!0,Object(r["a"])("listAccounts",{listAll:!0}).then((function(t){e.accountList=t.listaccountsresponse.account||[]})).catch((function(t){e.$notification.error({message:"".concat(e.$t("label.error")," ").concat(t.response.status),description:t.response.data.errorresponse.errortext})})).finally((function(){e.loadingAccount=!1}))},fetchTimeZone:function(e){var t=this;this.timeZoneMap=[],this.timeZoneLoading=!0,Object(o["a"])(e).then((function(e){t.timeZoneMap=e,t.timeZoneLoading=!1}))},fetchIdps:function(){var e=this;this.idpLoading=!0,Object(r["a"])("listIdps").then((function(t){e.idps=t.listidpsresponse.idp||[],e.selectedIdp=e.idps[0].id||""})).finally((function(){e.idpLoading=!1}))},isAdminOrDomainAdmin:function(){return["Admin","DomainAdmin"].includes(this.$store.getters.userInfo.roletype)},isValidValueForKey:function(e,t){return t in e&&null!=e[t]},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,a){if(!e){t.loading=!0;var i={username:a.username,password:a.password,email:a.email,firstname:a.firstname,lastname:a.lastname,accounttype:0};t.account?i.account=t.account:a.account&&(i.account=t.accountList[a.account].name),t.domainid?i.domainid=t.domainid:a.domainid&&(i.domainid=a.domainid),t.isValidValueForKey(a,"timezone")&&a.timezone.length>0&&(i.timezone=a.timezone),Object(r["a"])("createUser",{},"POST",i).then((function(e){t.$emit("refresh-data"),t.$notification.success({message:t.$t("label.create.user"),description:"".concat(t.$t("message.success.create.user")," ").concat(i.username)});var s=e.createuserresponse.user.user;if(a.samlenable&&s)for(var o=0;o<s.length;o++)Object(r["a"])("authorizeSamlSso",{enable:a.samlenable,entityid:a.samlentity,userid:s[o].id}).then((function(e){t.$notification.success({message:t.$t("label.samlenable"),description:t.$t("message.success.enable.saml.auth")})})).catch((function(e){t.$notification.error({message:t.$t("message.request.failed"),description:e.response&&e.response.headers&&e.response.headers["x-description"]||e.message,duration:0})}));t.closeAction()})).catch((function(e){t.$notification.error({message:t.$t("message.request.failed"),description:e.response&&e.response.headers&&e.response.headers["x-description"]||e.message,duration:0})})).finally((function(){t.loading=!1}))}}))},validateConfirmPassword:function(e,t,a){if(t&&0!==t.length)if("confirmpassword"===e.field){var i=this.form,s=this.$t("error.password.not.match"),r=i.getFieldValue("password");r&&r!==t?a(s):a()}else a();else a()},closeAction:function(){this.$emit("close-action")}}},d=c,m=(a("bcb9"),a("2877")),u=Object(m["a"])(d,i,s,!1,null,"45356ee1",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-1b798790.57223bfd.js.map