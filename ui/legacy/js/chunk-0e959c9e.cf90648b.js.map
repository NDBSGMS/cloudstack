{"version":3,"sources":["webpack:///./src/views/compute/ChangeAffinity.vue?760d","webpack:///./src/views/compute/ChangeAffinity.vue?a8a6","webpack:///src/views/compute/ChangeAffinity.vue","webpack:///./src/views/compute/ChangeAffinity.vue?db8f","webpack:///./src/views/compute/ChangeAffinity.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","domProps","_s","$t","staticStyle","attrs","_e","on","handleSearch","model","value","callback","$$v","filter","expression","loading","columns","items","record","id","name","showSizeChanger","total","selectedRowKeys","onChange","onSelectChange","handleTableChange","closeAction","_v","handleSubmit","staticRenderFns","props","resource","type","Object","required","inject","data","options","page","pageSize","keyword","mounted","fetchData","methods","domainid","accountid","response","pagination","current","$emit","affinitygroupids","join","message","component"],"mappings":"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","file":"js/chunk-0e959c9e.cf90648b.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChangeAffinity.vue?vue&type=style&index=0&id=6b868a17&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChangeAffinity.vue?vue&type=style&index=0&id=6b868a17&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-form',{staticClass:\"form\"},[_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('message.select.affinity.groups'))}}),(_vm.loading)?_c('div',{staticClass:\"loading\"},[_c('a-icon',{staticStyle:{\"color\":\"#1890ff\"},attrs:{\"type\":\"loading\"}})],1):_vm._e(),_c('div',{staticClass:\"form__item\"},[_c('a-input-search',{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{\"placeholder\":_vm.$t('label.search')},on:{\"search\":_vm.handleSearch},model:{value:(_vm.filter),callback:function ($$v) {_vm.filter=$$v},expression:\"filter\"}})],1),_c('div',{staticClass:\"form__item\"},[_c('a-table',{staticStyle:{\"overflow-y\":\"auto\"},attrs:{\"size\":\"small\",\"loading\":_vm.loading,\"columns\":_vm.columns,\"dataSource\":_vm.items,\"rowKey\":function (record) { return record.id || record.name; },\"pagination\":{showSizeChanger: true, total: _vm.total},\"rowSelection\":{selectedRowKeys: _vm.selectedRowKeys, onChange: _vm.onSelectChange}},on:{\"change\":_vm.handleTableChange,\"handle-search-filter\":_vm.handleTableChange}})],1),_c('div',{staticClass:\"action-button\",attrs:{\"span\":24}},[_c('a-button',{on:{\"click\":_vm.closeAction}},[_vm._v(_vm._s(this.$t('label.cancel')))]),_c('a-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},on:{\"click\":_vm.handleSubmit}},[_vm._v(_vm._s(this.$t('label.ok')))])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <a-form class=\"form\">\n\n    <p v-html=\"$t('message.select.affinity.groups')\" />\n\n    <div v-if=\"loading\" class=\"loading\">\n      <a-icon type=\"loading\" style=\"color: #1890ff;\" />\n    </div>\n\n    <div class=\"form__item\">\n      <a-input-search\n        style=\"margin-bottom: 10px;\"\n        :placeholder=\"$t('label.search')\"\n        v-model=\"filter\"\n        @search=\"handleSearch\" />\n    </div>\n\n    <div class=\"form__item\">\n      <a-table\n        size=\"small\"\n        :loading=\"loading\"\n        :columns=\"columns\"\n        :dataSource=\"items\"\n        :rowKey=\"record => record.id || record.name\"\n        :pagination=\"{showSizeChanger: true, total: total}\"\n        :rowSelection=\"{selectedRowKeys: selectedRowKeys, onChange: onSelectChange}\"\n        @change=\"handleTableChange\"\n        @handle-search-filter=\"handleTableChange\"\n        style=\"overflow-y: auto\"/>\n    </div>\n\n    <div :span=\"24\" class=\"action-button\">\n      <a-button @click=\"closeAction\">{{ this.$t('label.cancel') }}</a-button>\n      <a-button :loading=\"loading\" type=\"primary\" @click=\"handleSubmit\">{{ this.$t('label.ok') }}</a-button>\n    </div>\n\n  </a-form>\n</template>\n\n<script>\nimport { api } from '@/api'\nimport { genericCompare } from '@/utils/sort.js'\n\nexport default {\n  name: 'ChangeAffinity',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    }\n  },\n  inject: ['parentFetchData'],\n  data () {\n    return {\n      items: [],\n      total: 0,\n      columns: [\n        {\n          dataIndex: 'name',\n          title: this.$t('label.name'),\n          sorter: function (a, b) { return genericCompare(a[this.dataIndex] || '', b[this.dataIndex] || '') }\n        },\n        {\n          dataIndex: 'type',\n          title: this.$t('label.type'),\n          sorter: function (a, b) { return genericCompare(a[this.dataIndex] || '', b[this.dataIndex] || '') }\n        },\n        {\n          dataIndex: 'description',\n          title: this.$t('label.description'),\n          sorter: function (a, b) { return genericCompare(a[this.dataIndex] || '', b[this.dataIndex] || '') }\n        }\n      ],\n      selectedRowKeys: [],\n      options: {\n        page: 1,\n        pageSize: 10,\n        keyword: ''\n      },\n      filter: '',\n      loading: false\n    }\n  },\n  mounted () {\n    for (const group of this.resource.affinitygroup) {\n      this.selectedRowKeys.push(group.id)\n    }\n    this.fetchData()\n  },\n  methods: {\n    fetchData () {\n      this.loading = true\n      this.items = []\n      this.total = 0\n      api('listAffinityGroups', {\n        keyword: this.options.keyword,\n        domainid: this.resource.domainid,\n        accountid: this.resource.accountid,\n        page: this.options.page,\n        pageSize: this.options.pageSize,\n        response: 'json'\n      }).then(response => {\n        this.total = response.listaffinitygroupsresponse.count\n        if (this.total !== 0) {\n          this.items = response.listaffinitygroupsresponse.affinitygroup\n        }\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    onSelectChange (selectedRowKeys) {\n      this.selectedRowKeys = selectedRowKeys\n    },\n    handleSearch (keyword) {\n      this.filter = keyword\n      this.options.keyword = keyword\n      this.fetchData()\n    },\n    handleTableChange (pagination) {\n      this.options.page = pagination.current\n      this.options.pageSize = pagination.pageSize\n      this.fetchData()\n    },\n    closeAction () {\n      this.$emit('close-action')\n    },\n    handleSubmit () {\n      this.loading = true\n      api('updateVMAffinityGroup', {\n        id: this.resource.id,\n        affinitygroupids: this.selectedRowKeys.join(',')\n      }).then(response => {\n        this.$notification.success({\n          message: this.$t('message.success.change.affinity.group')\n        })\n        this.$parent.$parent.close()\n        this.parentFetchData()\n      }).catch(error => {\n        this.$notifyError(error)\n      }).finally(() => {\n        this.loading = false\n      })\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.form {\n  width: 90vw;\n  @media (min-width: 800px) {\n    width: 45vw;\n  }\n}\n\n.action-button {\n  text-align: right;\n  margin-top: 10px;\n  button {\n    margin-right: 5px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChangeAffinity.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChangeAffinity.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChangeAffinity.vue?vue&type=template&id=6b868a17&scoped=true&\"\nimport script from \"./ChangeAffinity.vue?vue&type=script&lang=js&\"\nexport * from \"./ChangeAffinity.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChangeAffinity.vue?vue&type=style&index=0&id=6b868a17&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6b868a17\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}