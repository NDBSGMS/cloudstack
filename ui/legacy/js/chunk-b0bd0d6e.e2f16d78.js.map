{"version":3,"sources":["webpack:///./src/views/image/TemplateZones.vue?211b","webpack:///./src/views/image/TemplateZones.vue?d71b","webpack:///src/views/image/TemplateZones.vue","webpack:///./src/views/image/TemplateZones.vue?1392","webpack:///./src/views/image/TemplateZones.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","attrs","loading","fetchLoading","columns","dataSource","record","zoneid","scopedSlots","_u","key","fn","text","_v","_s","$t","$store","getters","apis","isready","copyLoading","on","$event","showCopyTemplate","onShowDeleteModal","staticClass","page","pageSize","itemCount","total","handleChangePage","handleChangePageSize","props","value","showCopyActionForm","handleCopyTemplateSubmit","onCloseModal","form","directives","name","rawName","rules","required","message","expression","input","option","componentOptions","children","toLowerCase","indexOf","zoneLoading","_l","zone","id","_e","showDeleteTemplate","deleteLoading","deleteTemplate","model","callback","$$v","forcedDelete","staticRenderFns","resource","type","Object","Boolean","default","data","currentRecord","zones","beforeCreate","$form","createForm","apiConfigParams","apiParams","forEach","created","isActionPermitted","push","title","dataIndex","fixed","width","includes","userInfo","roletype","filter","mounted","fetchData","watch","newData","methods","params","templatefilter","listall","pagesize","currentPage","forced","jobid","jobId","description","status","successMethod","singleZone","isResourcePage","errorMethod","loadingMessage","catchMessage","fetchZoneData","setFieldsValue","e","preventDefault","validateFields","err","sourcezoneid","destzoneids","values","join","component"],"mappings":"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","file":"js/chunk-b0bd0d6e.e2f16d78.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TemplateZones.vue?vue&type=style&index=0&id=0d6503a4&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TemplateZones.vue?vue&type=style&index=0&id=0d6503a4&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-table',{staticStyle:{\"overflow-y\":\"auto\"},attrs:{\"size\":\"small\",\"loading\":_vm.loading || _vm.fetchLoading,\"columns\":_vm.columns,\"dataSource\":_vm.dataSource,\"pagination\":false,\"rowKey\":function (record) { return record.zoneid; }},scopedSlots:_vm._u([{key:\"isready\",fn:function(text, record){return _c('div',{},[(record.isready)?_c('span',[_vm._v(_vm._s(_vm.$t('label.yes')))]):_c('span',[_vm._v(_vm._s(_vm.$t('label.no')))])])}},{key:\"action\",fn:function(text, record){return [_c('span',{staticStyle:{\"margin-right\":\"5px\"}},[_c('a-button',{attrs:{\"disabled\":!('copyTemplate' in _vm.$store.getters.apis && record.isready),\"icon\":\"copy\",\"shape\":\"circle\",\"loading\":_vm.copyLoading},on:{\"click\":function($event){return _vm.showCopyTemplate(record)}}})],1),_c('span',{staticStyle:{\"margin-right\":\"5px\"}},[_c('a-button',{attrs:{\"disabled\":!('deleteTemplate' in _vm.$store.getters.apis),\"type\":\"danger\",\"icon\":\"delete\",\"shape\":\"circle\"},on:{\"click\":function($event){return _vm.onShowDeleteModal(record)}}})],1)]}}])}),_c('a-pagination',{staticClass:\"row-element\",attrs:{\"size\":\"small\",\"current\":_vm.page,\"pageSize\":_vm.pageSize,\"total\":_vm.itemCount,\"showTotal\":function (total) { return ((_vm.$t('label.total')) + \" \" + total + \" \" + (_vm.$t('label.items'))); },\"pageSizeOptions\":['10', '20', '40', '80', '100'],\"showSizeChanger\":\"\"},on:{\"change\":_vm.handleChangePage,\"showSizeChange\":_vm.handleChangePageSize},scopedSlots:_vm._u([{key:\"buildOptionText\",fn:function(props){return [_c('span',[_vm._v(_vm._s(props.value)+\" / \"+_vm._s(_vm.$t('label.page')))])]}}])}),('copyTemplate' in _vm.$store.getters.apis)?_c('a-modal',{staticStyle:{\"top\":\"20px\"},attrs:{\"title\":_vm.$t('label.action.copy.template'),\"visible\":_vm.showCopyActionForm,\"closable\":true,\"maskClosable\":false,\"okText\":_vm.$t('label.ok'),\"cancelText\":_vm.$t('label.cancel'),\"confirmLoading\":_vm.copyLoading,\"centered\":\"\"},on:{\"ok\":_vm.handleCopyTemplateSubmit,\"cancel\":_vm.onCloseModal}},[_c('a-spin',{attrs:{\"spinning\":_vm.copyLoading}},[_c('a-form',{attrs:{\"form\":_vm.form,\"layout\":\"vertical\"},on:{\"submit\":_vm.handleCopyTemplateSubmit}},[_c('a-form-item',{attrs:{\"label\":_vm.$t('label.zoneid')}},[_c('a-select',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['zoneid', {\n              rules: [\n                {\n                  required: true,\n                  message: (\"\" + (this.$t('message.error.select')))\n                }\n              ]\n            }]),expression:\"['zoneid', {\\n              rules: [\\n                {\\n                  required: true,\\n                  message: `${this.$t('message.error.select')}`\\n                }\\n              ]\\n            }]\"}],attrs:{\"id\":\"zone-selection\",\"mode\":\"multiple\",\"placeholder\":_vm.$t('label.select.zones'),\"showSearch\":\"\",\"optionFilterProp\":\"children\",\"filterOption\":function (input, option) {\n              return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n            },\"loading\":_vm.zoneLoading}},_vm._l((_vm.zones),function(zone){return _c('a-select-option',{key:zone.id},[_vm._v(\" \"+_vm._s(zone.name)+\" \")])}),1)],1)],1)],1)],1):_vm._e(),_c('a-modal',{attrs:{\"title\":_vm.$t('label.action.delete.template'),\"visible\":_vm.showDeleteTemplate,\"closable\":true,\"maskClosable\":false,\"okText\":_vm.$t('label.ok'),\"cancelText\":_vm.$t('label.cancel'),\"confirmLoading\":_vm.deleteLoading,\"centered\":\"\"},on:{\"ok\":_vm.deleteTemplate,\"cancel\":_vm.onCloseModal}},[_c('a-spin',{attrs:{\"spinning\":_vm.deleteLoading}},[_c('a-alert',{attrs:{\"message\":_vm.$t('message.action.delete.template'),\"type\":\"warning\"}}),_c('a-form-item',{staticStyle:{\"margin-bottom\":\"0\"},attrs:{\"label\":_vm.$t('label.isforced')}},[_c('a-switch',{model:{value:(_vm.forcedDelete),callback:function ($$v) {_vm.forcedDelete=$$v},expression:\"forcedDelete\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <div>\n    <a-table\n      size=\"small\"\n      style=\"overflow-y: auto\"\n      :loading=\"loading || fetchLoading\"\n      :columns=\"columns\"\n      :dataSource=\"dataSource\"\n      :pagination=\"false\"\n      :rowKey=\"record => record.zoneid\">\n      <div slot=\"isready\" slot-scope=\"text, record\">\n        <span v-if=\"record.isready\">{{ $t('label.yes') }}</span>\n        <span v-else>{{ $t('label.no') }}</span>\n      </div>\n      <template slot=\"action\" slot-scope=\"text, record\">\n        <span style=\"margin-right: 5px\">\n          <a-button\n            :disabled=\"!('copyTemplate' in $store.getters.apis && record.isready)\"\n            icon=\"copy\"\n            shape=\"circle\"\n            :loading=\"copyLoading\"\n            @click=\"showCopyTemplate(record)\" />\n        </span>\n        <span style=\"margin-right: 5px\">\n          <a-button\n            :disabled=\"!('deleteTemplate' in $store.getters.apis)\"\n            type=\"danger\"\n            icon=\"delete\"\n            shape=\"circle\"\n            @click=\"onShowDeleteModal(record)\"/>\n        </span>\n      </template>\n    </a-table>\n    <a-pagination\n      class=\"row-element\"\n      size=\"small\"\n      :current=\"page\"\n      :pageSize=\"pageSize\"\n      :total=\"itemCount\"\n      :showTotal=\"total => `${$t('label.total')} ${total} ${$t('label.items')}`\"\n      :pageSizeOptions=\"['10', '20', '40', '80', '100']\"\n      @change=\"handleChangePage\"\n      @showSizeChange=\"handleChangePageSize\"\n      showSizeChanger>\n      <template slot=\"buildOptionText\" slot-scope=\"props\">\n        <span>{{ props.value }} / {{ $t('label.page') }}</span>\n      </template>\n    </a-pagination>\n\n    <a-modal\n      v-if=\"'copyTemplate' in $store.getters.apis\"\n      style=\"top: 20px;\"\n      :title=\"$t('label.action.copy.template')\"\n      :visible=\"showCopyActionForm\"\n      :closable=\"true\"\n      :maskClosable=\"false\"\n      :okText=\"$t('label.ok')\"\n      :cancelText=\"$t('label.cancel')\"\n      @ok=\"handleCopyTemplateSubmit\"\n      @cancel=\"onCloseModal\"\n      :confirmLoading=\"copyLoading\"\n      centered>\n      <a-spin :spinning=\"copyLoading\">\n        <a-form\n          :form=\"form\"\n          @submit=\"handleCopyTemplateSubmit\"\n          layout=\"vertical\">\n          <a-form-item :label=\"$t('label.zoneid')\">\n            <a-select\n              id=\"zone-selection\"\n              mode=\"multiple\"\n              :placeholder=\"$t('label.select.zones')\"\n              v-decorator=\"['zoneid', {\n                rules: [\n                  {\n                    required: true,\n                    message: `${this.$t('message.error.select')}`\n                  }\n                ]\n              }]\"\n              showSearch\n              optionFilterProp=\"children\"\n              :filterOption=\"(input, option) => {\n                return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n              }\"\n              :loading=\"zoneLoading\">\n              <a-select-option v-for=\"zone in zones\" :key=\"zone.id\">\n                {{ zone.name }}\n              </a-select-option>\n            </a-select>\n          </a-form-item>\n        </a-form>\n      </a-spin>\n    </a-modal>\n\n    <a-modal\n      :title=\"$t('label.action.delete.template')\"\n      :visible=\"showDeleteTemplate\"\n      :closable=\"true\"\n      :maskClosable=\"false\"\n      :okText=\"$t('label.ok')\"\n      :cancelText=\"$t('label.cancel')\"\n      @ok=\"deleteTemplate\"\n      @cancel=\"onCloseModal\"\n      :confirmLoading=\"deleteLoading\"\n      centered>\n      <a-spin :spinning=\"deleteLoading\">\n        <a-alert :message=\"$t('message.action.delete.template')\" type=\"warning\" />\n        <a-form-item :label=\"$t('label.isforced')\" style=\"margin-bottom: 0;\">\n          <a-switch v-model=\"forcedDelete\"></a-switch>\n        </a-form-item>\n      </a-spin>\n    </a-modal>\n  </div>\n</template>\n\n<script>\nimport { api } from '@/api'\n\nexport default {\n  name: 'TemplateZones',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data () {\n    return {\n      columns: [],\n      dataSource: [],\n      page: 1,\n      pageSize: 10,\n      itemCount: 0,\n      fetchLoading: false,\n      showCopyActionForm: false,\n      currentRecord: {},\n      zones: [],\n      zoneLoading: false,\n      copyLoading: false,\n      deleteLoading: false,\n      showDeleteTemplate: false,\n      forcedDelete: false\n    }\n  },\n  beforeCreate () {\n    this.form = this.$form.createForm(this)\n    this.apiConfigParams = (this.$store.getters.apis.copyTemplate && this.$store.getters.apis.copyTemplate.params) || []\n    this.apiParams = {}\n    this.apiConfigParams.forEach(param => {\n      this.apiParams[param.name] = param\n    })\n  },\n  created () {\n    this.columns = [\n      {\n        title: this.$t('label.zonename'),\n        dataIndex: 'zonename'\n      },\n      {\n        title: this.$t('label.status'),\n        dataIndex: 'status'\n      },\n      {\n        title: this.$t('label.isready'),\n        dataIndex: 'isready',\n        scopedSlots: { customRender: 'isready' }\n      }\n    ]\n    if (this.isActionPermitted()) {\n      this.columns.push({\n        title: '',\n        dataIndex: 'action',\n        fixed: 'right',\n        width: 100,\n        scopedSlots: { customRender: 'action' }\n      })\n    }\n\n    const userInfo = this.$store.getters.userInfo\n    if (!['Admin'].includes(userInfo.roletype) &&\n      (userInfo.account !== this.resource.account || userInfo.domain !== this.resource.domain)) {\n      this.columns = this.columns.filter(col => { return col.dataIndex !== 'status' })\n    }\n  },\n  mounted () {\n    this.fetchData()\n  },\n  watch: {\n    loading (newData, oldData) {\n      if (!newData) {\n        this.fetchData()\n      }\n    }\n  },\n  methods: {\n    fetchData () {\n      const params = {}\n      params.id = this.resource.id\n      params.templatefilter = 'executable'\n      params.listall = true\n      params.page = this.page\n      params.pagesize = this.pageSize\n\n      this.dataSource = []\n      this.itemCount = 0\n      this.fetchLoading = true\n      api('listTemplates', params).then(json => {\n        this.dataSource = json.listtemplatesresponse.template || []\n        this.itemCount = json.listtemplatesresponse.count || 0\n      }).catch(error => {\n        this.$notifyError(error)\n      }).finally(() => {\n        this.fetchLoading = false\n      })\n    },\n    handleChangePage (page, pageSize) {\n      this.page = page\n      this.pageSize = pageSize\n      this.fetchData()\n    },\n    handleChangePageSize (currentPage, pageSize) {\n      this.page = currentPage\n      this.pageSize = pageSize\n      this.fetchData()\n    },\n    isActionPermitted () {\n      return (['Admin'].includes(this.$store.getters.userInfo.roletype) || // If admin or owner or belongs to current project\n        (this.resource.domainid === this.$store.getters.userInfo.domainid && this.resource.account === this.$store.getters.userInfo.account) ||\n        (this.resource.domainid === this.$store.getters.userInfo.domainid && this.resource.projectid && this.$store.getters.project && this.$store.getters.project.id && this.resource.projectid === this.$store.getters.project.id)) &&\n        (this.resource.isready || !this.resource.status || this.resource.status.indexOf('Downloaded') === -1) && // Template is ready or downloaded\n        this.resource.templatetype !== 'SYSTEM'\n    },\n    deleteTemplate () {\n      const params = {\n        id: this.currentRecord.id,\n        forced: this.forcedDelete,\n        zoneid: this.currentRecord.zoneid\n      }\n      this.deleteLoading = true\n      api('deleteTemplate', params).then(json => {\n        const jobId = json.deletetemplateresponse.jobid\n        this.$store.dispatch('AddAsyncJob', {\n          title: this.$t('label.action.delete.template'),\n          jobid: jobId,\n          description: this.resource.name,\n          status: 'progress'\n        })\n        const singleZone = (this.dataSource.length === 1)\n        this.$pollJob({\n          jobId,\n          successMethod: result => {\n            if (singleZone) {\n              const isResourcePage = (this.$route.params && this.$route.params.id)\n              if (isResourcePage) {\n                this.$router.go(-1)\n              }\n            } else {\n              this.fetchData()\n            }\n          },\n          errorMethod: () => this.fetchData(),\n          loadingMessage: `${this.$t('label.deleting.template')} ${this.resource.name} ${this.$t('label.in.progress')}`,\n          catchMessage: this.$t('error.fetching.async.job.result')\n        })\n        this.onCloseModal()\n        this.fetchData()\n      }).catch(error => {\n        this.$notifyError(error)\n      }).finally(() => {\n        this.deleteLoading = false\n      })\n    },\n    fetchZoneData () {\n      this.zones = []\n      this.zoneLoading = true\n      api('listZones', { listall: true }).then(json => {\n        const zones = json.listzonesresponse.zone || []\n        this.zones = [...zones.filter((zone) => this.currentRecord.zoneid !== zone.id)]\n      }).finally(() => {\n        this.zoneLoading = false\n      })\n    },\n    showCopyTemplate (record) {\n      this.currentRecord = record\n      this.form.setFieldsValue({\n        zoneid: []\n      })\n      this.fetchZoneData()\n      this.showCopyActionForm = true\n    },\n    onShowDeleteModal (record) {\n      this.forcedDelete = false\n      this.currentRecord = record\n      this.showDeleteTemplate = true\n    },\n    onCloseModal () {\n      this.currentRecord = {}\n      this.showCopyActionForm = false\n      this.showDeleteTemplate = false\n    },\n    handleCopyTemplateSubmit (e) {\n      e.preventDefault()\n      this.form.validateFields((err, values) => {\n        if (err) {\n          return\n        }\n        const params = {\n          id: this.currentRecord.id,\n          sourcezoneid: this.currentRecord.zoneid,\n          destzoneids: values.zoneid.join()\n        }\n        this.copyLoading = true\n        api('copyTemplate', params).then(json => {\n          const jobId = json.copytemplateresponse.jobid\n          this.$store.dispatch('AddAsyncJob', {\n            title: this.$t('label.action.copy.template'),\n            jobid: jobId,\n            description: this.resource.name,\n            status: 'progress'\n          })\n          this.$pollJob({\n            jobId,\n            successMethod: result => {\n              this.fetchData()\n            },\n            errorMethod: () => this.fetchData(),\n            loadingMessage: `${this.$t('label.action.copy.template')} ${this.resource.name} ${this.$t('label.in.progress')}`,\n            catchMessage: this.$t('error.fetching.async.job.result')\n          })\n        }).catch(error => {\n          this.$notification.error({\n            message: this.$t('message.request.failed'),\n            description: (error.response && error.response.headers && error.response.headers['x-description']) || error.message\n          })\n        }).finally(() => {\n          this.copyLoading = false\n          this.$emit('refresh-data')\n          this.onCloseModal()\n          this.fetchData()\n        })\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.row-element {\n  margin-top: 15px;\n  margin-bottom: 15px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TemplateZones.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TemplateZones.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TemplateZones.vue?vue&type=template&id=0d6503a4&scoped=true&\"\nimport script from \"./TemplateZones.vue?vue&type=script&lang=js&\"\nexport * from \"./TemplateZones.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TemplateZones.vue?vue&type=style&index=0&id=0d6503a4&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0d6503a4\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}