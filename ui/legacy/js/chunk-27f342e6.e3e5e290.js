(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27f342e6"],{"6be1":function(e,t,s){"use strict";var o=s("7b41"),i=s.n(o);i.a},"7b41":function(e,t,s){},cbd8:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"migrate-volume-container"},[s("div",{staticClass:"modal-form"},[e.storagePools.length>0?s("div",[s("p",{staticClass:"modal-form__label"},[e._v(e._s(e.$t("label.storagepool")))]),s("a-select",{staticStyle:{width:"100%"},model:{value:e.selectedStoragePool,callback:function(t){e.selectedStoragePool=t},expression:"selectedStoragePool"}},e._l(e.storagePools,(function(t,o){return s("a-select-option",{key:o,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" "),e.resource.virtualmachineid?s("span",[e._v(e._s(t.suitableformigration?"("+e.$t("label.suitable")+")":"("+e.$t("label.not.suitable")+")"))]):e._e()])})),1),this.resource.virtualmachineid?[s("p",{staticClass:"modal-form__label",staticStyle:{cursor:"pointer"},on:{click:function(t){e.replaceDiskOffering=!e.replaceDiskOffering}}},[e._v(" "+e._s(e.$t("label.usenewdiskoffering"))+" ")]),s("a-checkbox",{model:{value:e.replaceDiskOffering,callback:function(t){e.replaceDiskOffering=t},expression:"replaceDiskOffering"}}),e.replaceDiskOffering?[s("p",{staticClass:"modal-form__label"},[e._v(e._s(e.$t("label.newdiskoffering")))]),s("a-select",{staticStyle:{width:"100%"},model:{value:e.selectedDiskOffering,callback:function(t){e.selectedDiskOffering=t},expression:"selectedDiskOffering"}},e._l(e.diskOfferings,(function(t,o){return s("a-select-option",{key:o,attrs:{value:t.id}},[e._v(" "+e._s(t.displaytext)+" ")])})),1)]:e._e()]:e._e()],2):s("a-alert",{staticStyle:{"margin-top":"15px"},attrs:{type:"warning"}},[s("span",{attrs:{slot:"message"},domProps:{innerHTML:e._s(e.$t("message.no.primary.stores"))},slot:"message"})])],1),s("a-divider"),s("div",{staticClass:"actions"},[s("a-button",{on:{click:e.closeModal}},[e._v(" "+e._s(e.$t("label.cancel"))+" ")]),s("a-button",{attrs:{type:"primary"},on:{click:e.submitMigrateVolume}},[e._v(" "+e._s(e.$t("label.ok"))+" ")])],1)],1)},i=[],a=(s("4de4"),s("365c")),r={name:"MigrateVolume",props:{resource:{type:Object,required:!0}},inject:["parentFetchData"],data:function(){return{storagePools:[],selectedStoragePool:null,diskOfferings:[],replaceDiskOffering:!1,selectedDiskOffering:null}},mounted:function(){this.fetchStoragePools(),this.resource.virtualmachineid&&this.fetchDiskOfferings()},methods:{fetchStoragePools:function(){var e=this;this.resource.virtualmachineid?Object(a["a"])("findStoragePoolsForMigration",{id:this.resource.id}).then((function(t){e.storagePools=t.findstoragepoolsformigrationresponse.storagepool||[],Array.isArray(e.storagePools)&&e.storagePools.length&&(e.selectedStoragePool=e.storagePools[0].id||"")})).catch((function(t){e.$notifyError(t),e.closeModal()})):Object(a["a"])("listStoragePools",{zoneid:this.resource.zoneid}).then((function(t){e.storagePools=t.liststoragepoolsresponse.storagepool||[],e.storagePools=e.storagePools.filter((function(t){return t.id!==e.resource.storageid})),Array.isArray(e.storagePools)&&e.storagePools.length&&(e.selectedStoragePool=e.storagePools[0].id||"")})).catch((function(t){e.$notifyError(t),e.closeModal()}))},fetchDiskOfferings:function(){var e=this;Object(a["a"])("listDiskOfferings",{listall:!0}).then((function(t){e.diskOfferings=t.listdiskofferingsresponse.diskoffering,e.selectedDiskOffering=e.diskOfferings[0].id})).catch((function(t){e.$notifyError(t),e.closeModal()}))},closeModal:function(){this.$parent.$parent.close()},submitMigrateVolume:function(){var e=this;0!==this.storagePools.length?Object(a["a"])("migrateVolume",{livemigrate:"Running"===this.resource.vmstate,storageid:this.selectedStoragePool,volumeid:this.resource.id,newdiskofferingid:this.replaceDiskOffering?this.selectedDiskOffering:null}).then((function(t){e.$pollJob({jobId:t.migratevolumeresponse.jobid,successMessage:e.$t("message.success.migrate.volume"),successMethod:function(){e.parentFetchData()},errorMessage:e.$t("message.migrate.volume.failed"),errorMethod:function(){e.parentFetchData()},loadingMessage:e.$t("message.migrate.volume.processing"),catchMessage:e.$t("error.fetching.async.job.result"),catchMethod:function(){e.parentFetchData()}}),e.closeModal(),e.parentFetchData()})).catch((function(t){e.$notifyError(t)})):this.closeModal()}}},l=r,n=(s("6be1"),s("2877")),c=Object(n["a"])(l,o,i,!1,null,"f940bea6",null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-27f342e6.e3e5e290.js.map