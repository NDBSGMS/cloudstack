{"version":3,"sources":["webpack:///./src/components/view/SettingsTab.vue?ffa2","webpack:///./src/components/view/SettingsTab.vue?96f0","webpack:///src/components/view/SettingsTab.vue","webpack:///./src/components/view/SettingsTab.vue?72ff","webpack:///./src/components/view/SettingsTab.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","attrs","$t","on","handleSearch","model","value","callback","$$v","filter","expression","staticClass","loading","tabLoading","_l","item","index","key","slot","_v","_s","name","description","editableValueKey","$event","type","indexOf","_k","keyCode","updateData","editableValue","$store","getters","apis","setEditableSetting","_e","staticRenderFns","props","resource","Object","required","Boolean","data","items","scopeKey","beforeMount","$route","meta","mounted","fetchData","watch","newItem","id","methods","params","keyword","console","error","message","component"],"mappings":"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","file":"js/chunk-3fe819a8.544c0df1.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingsTab.vue?vue&type=style&index=0&id=844dc50a&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingsTab.vue?vue&type=style&index=0&id=844dc50a&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-input-search',{staticStyle:{\"width\":\"25vw\",\"float\":\"right\",\"margin-bottom\":\"10px\",\"z-index\":\"8\"},attrs:{\"placeholder\":_vm.$t('label.search')},on:{\"search\":_vm.handleSearch},model:{value:(_vm.filter),callback:function ($$v) {_vm.filter=$$v},expression:\"filter\"}}),_c('a-list',{staticClass:\"list\",attrs:{\"size\":\"large\",\"loading\":_vm.loading || _vm.tabLoading}},_vm._l((_vm.items),function(item,index){return _c('a-list-item',{key:index,staticClass:\"item\"},[_c('a-list-item-meta',[_c('span',{staticStyle:{\"word-break\":\"break-all\"},attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(item.name))]),_c('span',{staticStyle:{\"word-break\":\"break-all\"},attrs:{\"slot\":\"description\"},slot:\"description\"},[_vm._v(_vm._s(item.description))])]),_c('div',{staticClass:\"item__content\"},[(_vm.editableValueKey === index)?_c('a-input',{staticClass:\"editable-value value\",attrs:{\"autoFocus\":_vm.editableValueKey === index,\"defaultValue\":item.value},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"esc\",27,$event.key,[\"Esc\",\"Escape\"])){ return null; }_vm.editableValueKey = null},\"pressEnter\":function($event){return _vm.updateData(item)}},model:{value:(_vm.editableValue),callback:function ($$v) {_vm.editableValue=$$v},expression:\"editableValue\"}}):_c('span',{staticClass:\"value\"},[_vm._v(\" \"+_vm._s(item.value)+\" \")])],1),_c('div',{staticClass:\"action\",attrs:{\"slot\":\"actions\"},slot:\"actions\"},[(_vm.editableValueKey !== index)?_c('a-button',{attrs:{\"shape\":\"circle\",\"disabled\":!('updateConfiguration' in _vm.$store.getters.apis),\"icon\":\"edit\"},on:{\"click\":function($event){return _vm.setEditableSetting(item, index)}}}):_vm._e(),(_vm.editableValueKey === index)?_c('a-button',{attrs:{\"shape\":\"circle\",\"size\":\"default\"},on:{\"click\":function($event){_vm.editableValueKey = null}}},[_c('a-icon',{attrs:{\"type\":\"close-circle\",\"theme\":\"twoTone\",\"twoToneColor\":\"#f5222d\"}})],1):_vm._e(),(_vm.editableValueKey === index)?_c('a-button',{attrs:{\"shape\":\"circle\"},on:{\"click\":function($event){return _vm.updateData(item)}}},[_c('a-icon',{attrs:{\"type\":\"check-circle\",\"theme\":\"twoTone\",\"twoToneColor\":\"#52c41a\"}})],1):_vm._e()],1)],1)}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <a-input-search\n      style=\"width: 25vw;float: right;margin-bottom: 10px; z-index: 8;\"\n      :placeholder=\"$t('label.search')\"\n      v-model=\"filter\"\n      @search=\"handleSearch\" />\n\n    <a-list size=\"large\" class=\"list\" :loading=\"loading || tabLoading\">\n      <a-list-item :key=\"index\" v-for=\"(item, index) in items\" class=\"item\">\n        <a-list-item-meta>\n          <span slot=\"title\" style=\"word-break: break-all\">{{ item.name }}</span>\n          <span slot=\"description\" style=\"word-break: break-all\">{{ item.description }}</span>\n        </a-list-item-meta>\n\n        <div class=\"item__content\">\n          <a-input\n            :autoFocus=\"editableValueKey === index\"\n            v-if=\"editableValueKey === index\"\n            class=\"editable-value value\"\n            :defaultValue=\"item.value\"\n            v-model=\"editableValue\"\n            @keydown.esc=\"editableValueKey = null\"\n            @pressEnter=\"updateData(item)\">\n          </a-input>\n          <span v-else class=\"value\">\n            {{ item.value }}\n          </span>\n        </div>\n\n        <div slot=\"actions\" class=\"action\">\n          <a-button\n            shape=\"circle\"\n            :disabled=\"!('updateConfiguration' in $store.getters.apis)\"\n            v-if=\"editableValueKey !== index\"\n            icon=\"edit\"\n            @click=\"setEditableSetting(item, index)\" />\n          <a-button\n            shape=\"circle\"\n            size=\"default\"\n            @click=\"editableValueKey = null\"\n            v-if=\"editableValueKey === index\" >\n            <a-icon type=\"close-circle\" theme=\"twoTone\" twoToneColor=\"#f5222d\" />\n          </a-button>\n          <a-button\n            shape=\"circle\"\n            @click=\"updateData(item)\"\n            v-if=\"editableValueKey === index\" >\n            <a-icon type=\"check-circle\" theme=\"twoTone\" twoToneColor=\"#52c41a\" />\n          </a-button>\n        </div>\n      </a-list-item>\n    </a-list>\n  </div>\n</template>\n\n<script>\nimport { api } from '@/api'\n\nexport default {\n  name: 'SettingsTab',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    },\n    loading: {\n      type: Boolean,\n      required: true\n    }\n  },\n  data () {\n    return {\n      items: [],\n      scopeKey: '',\n      editableValueKey: null,\n      editableValue: '',\n      tabLoading: false,\n      filter: ''\n    }\n  },\n  beforeMount () {\n    switch (this.$route.meta.name) {\n      case 'account':\n        this.scopeKey = 'accountid'\n        break\n      case 'domain':\n        this.scopeKey = 'domainid'\n        break\n      case 'zone':\n        this.scopeKey = 'zoneid'\n        break\n      case 'cluster':\n        this.scopeKey = 'clusterid'\n        break\n      case 'storagepool':\n        this.scopeKey = 'storageid'\n        break\n      case 'imagestore':\n        this.scopeKey = 'imagestoreuuid'\n        break\n      default:\n        this.scopeKey = ''\n    }\n  },\n  mounted () {\n    this.fetchData()\n  },\n  watch: {\n    resource: function (newItem, oldItem) {\n      if (!newItem.id) return\n      this.resource = newItem\n      this.fetchData()\n    }\n  },\n  methods: {\n    fetchData (callback) {\n      this.tabLoading = true\n      const params = {\n        [this.scopeKey]: this.resource.id,\n        listAll: true\n      }\n      if (this.filter) {\n        params.keyword = this.filter\n      }\n      api('listConfigurations', params).then(response => {\n        this.items = response.listconfigurationsresponse.configuration\n      }).catch(error => {\n        console.error(error)\n        this.$message.error(this.$t('message.error.loading.setting'))\n      }).finally(() => {\n        this.tabLoading = false\n        if (!callback) return\n        callback()\n      })\n    },\n    updateData (item) {\n      this.tabLoading = true\n      api('updateConfiguration', {\n        [this.scopeKey]: this.resource.id,\n        name: item.name,\n        value: this.editableValue\n      }).then(() => {\n        const message = `${this.$t('label.setting')} ${item.name} ${this.$t('label.update.to')} ${this.editableValue}`\n        this.$message.success(message)\n      }).catch(error => {\n        console.error(error)\n        this.$message.error(this.$t('message.error.save.setting'))\n        this.$notification.error({\n          message: this.$t('label.error'),\n          description: this.$t('message.error.try.save.setting')\n        })\n      }).finally(() => {\n        this.tabLoading = false\n        this.fetchData(() => {\n          this.editableValueKey = null\n        })\n      })\n    },\n    setEditableSetting (item, index) {\n      this.editableValueKey = index\n      this.editableValue = item.value\n    },\n    handleSearch (value) {\n      this.filter = value\n      this.fetchData()\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n  .list {\n    clear:both;\n  }\n  .editable-value {\n\n    @media (min-width: 760px) {\n      text-align: right;\n      margin-left: 40px;\n      margin-right: -40px;\n    }\n\n  }\n  .item {\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n\n    @media (min-width: 760px) {\n      flex-direction: row;\n    }\n\n    &__content {\n      width: 100%;\n      display: flex;\n      word-break: break-all;\n\n      @media (min-width: 760px) {\n        width: auto;\n      }\n\n    }\n\n  }\n  .action {\n    margin-top: 20px;\n    margin-left: -12px;\n\n    @media (min-width: 480px) {\n      margin-left: -24px;\n    }\n\n    @media (min-width: 760px) {\n      margin-top: 0;\n      margin-left: 0;\n    }\n\n  }\n\n  .value {\n    margin-top: 20px;\n\n    @media (min-width: 760px) {\n      margin-top: 0;\n    }\n\n  }\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingsTab.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingsTab.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SettingsTab.vue?vue&type=template&id=844dc50a&scoped=true&\"\nimport script from \"./SettingsTab.vue?vue&type=script&lang=js&\"\nexport * from \"./SettingsTab.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SettingsTab.vue?vue&type=style&index=0&id=844dc50a&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"844dc50a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}