{"version":3,"sources":["webpack:///./src/views/plugins/quota/QuotaBalance.vue?9318","webpack:///src/views/plugins/quota/QuotaBalance.vue","webpack:///./src/views/plugins/quota/QuotaBalance.vue?7eac","webpack:///./src/views/plugins/quota/QuotaBalance.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","loading","columns","dataSource","record","name","y","scopedSlots","_u","key","fn","text","_v","_s","currency","_e","staticRenderFns","props","resource","type","Object","required","tab","String","default","data","pattern","account","computed","watch","newTab","fetchData","mounted","methods","createDataSource","push","date","quota","quotaBalance","endquota","credit","startquota","credits","map","item","fetchResource","Promise","params","domainid","resolve","reject","error","startdate","enddate","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,UAAU,CAACE,MAAM,CAAC,KAAO,QAAQ,QAAUN,EAAIO,QAAQ,QAAUP,EAAIQ,QAAQ,WAAaR,EAAIS,WAAW,OAAS,SAAUC,GAAU,OAAOA,EAAOC,MAAQ,YAAa,EAAM,OAAS,CAAEC,EAAG,SAAUC,YAAYb,EAAIc,GAAG,CAAC,CAACC,IAAI,QAAQC,GAAG,SAASC,GAAM,MAAO,CAAS,OAAPA,EAAab,EAAG,OAAO,CAACJ,EAAIkB,GAAGlB,EAAImB,GAAInB,EAAIoB,SAAW,IAAMH,MAAUjB,EAAIqB,QAAQ,CAACN,IAAI,SAASC,GAAG,SAASC,GAAM,MAAO,CAAS,OAAPA,EAAab,EAAG,OAAO,CAACJ,EAAIkB,GAAGlB,EAAImB,GAAInB,EAAIoB,SAAW,IAAMH,MAAUjB,EAAIqB,aAAa,IAC9jBC,EAAkB,G,6ECyCtB,GACEX,KAAM,eACNY,MAAO,CACLC,SAAU,CACRC,KAAMC,OACNC,UAAU,GAEZC,IAAK,CACHH,KAAMI,OACNC,QAAS,WAAf,YAGEC,KAZF,WAaI,MAAO,CACLxB,SAAS,EACTyB,QAAS,aACTZ,SAAU,GACVX,WAAY,GACZwB,QAAS,OAGbC,SAAU,CACR1B,QADJ,WAEM,MAAO,CACb,CACQ,MAAR,sBACQ,UAAR,OACQ,MAAR,iBACQ,YAAR,CAAU,aAAV,SAEA,CACQ,MAAR,6BACQ,UAAR,QACQ,MAAR,iBACQ,YAAR,CAAU,aAAV,UAEA,CACQ,MAAR,wBACQ,UAAR,SACQ,MAAR,iBACQ,YAAR,CAAU,aAAV,cAKE2B,MAAO,CACLP,IADJ,SACA,KACM3B,KAAK2B,IAAMQ,EACM,4BAAbnC,KAAK2B,KACP3B,KAAKoC,cAIXC,QArDF,WAsDIrC,KAAKoC,aAEPE,QAAS,CACP,UADJ,WACA,uKACA,gBACA,aACA,6EAHA,kBAMA,kBANA,cAMA,EANA,gBAOA,kBAPA,cAOA,EAPA,OAQA,sBARA,UASA,sBATA,QASA,aATA,OAUA,aAVA,qDAYA,kBACA,aAbA,6DAgBIC,iBAjBJ,SAiBA,cACA,KACA,gBAoBM,OAlBA/B,EAAWgC,KAAK,CACdC,KAAM,IAAd,gCACQC,MAAOC,EAAaC,SACpBC,OAAQ,OAEVrC,EAAWgC,KAAK,CACdC,KAAM,IAAd,kCACQC,MAAOC,EAAaG,WACpBD,OAAQ,OAEVE,EAAQC,KAAI,SAAlB,GACQxC,EAAWgC,KAAK,CACdC,KAAM,IAAhB,gCACUC,MAAO,KACPG,OAAQI,EAAKF,aAIVvC,GAET0C,cAzCJ,WAyCA,WACM,OAAO,IAAIC,SAAQ,SAAzB,KACQ,IAAR,KACQC,EAAOC,SAAW,EAA1B,kBACQD,EAAOpB,QAAU,EAAzB,QAEQ,OAAR,OAAQ,CAAR,oCACU,IAAV,qCACUsB,EAAQX,MAClB,mBACUY,EAAOC,UAIbb,aAvDJ,SAuDA,cACM,OAAO,IAAIQ,SAAQ,SAAzB,KACQ,IAAR,KACQC,EAAOC,SAAW,EAA1B,kBACQD,EAAOpB,QAAU,EAAzB,QACQoB,EAAOK,UAAY,IAA3B,wCACQL,EAAOM,QAAU,IAAzB,+BAEQ,OAAR,OAAQ,CAAR,oCACU,IAAV,qCACUJ,EAAQX,MAClB,mBACUY,EAAOC,YCrKmW,I,YCOhXG,EAAY,eACd,EACA7D,EACAuB,GACA,EACA,KACA,KACA,MAIa,aAAAsC,E","file":"js/chunk-2d0aa214.a9fc02aa.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('a-table',{attrs:{\"size\":\"small\",\"loading\":_vm.loading,\"columns\":_vm.columns,\"dataSource\":_vm.dataSource,\"rowKey\":function (record) { return record.name; },\"pagination\":false,\"scroll\":{ y: '55vh' }},scopedSlots:_vm._u([{key:\"quota\",fn:function(text){return [(text!==null)?_c('span',[_vm._v(_vm._s((_vm.currency + \" \" + text)))]):_vm._e()]}},{key:\"credit\",fn:function(text){return [(text!==null)?_c('span',[_vm._v(_vm._s((_vm.currency + \" \" + text)))]):_vm._e()]}}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <div>\n    <a-table\n      size=\"small\"\n      :loading=\"loading\"\n      :columns=\"columns\"\n      :dataSource=\"dataSource\"\n      :rowKey=\"record => record.name\"\n      :pagination=\"false\"\n      :scroll=\"{ y: '55vh' }\"\n    >\n      <template slot=\"quota\" slot-scope=\"text\">\n        <span v-if=\"text!==null\">{{ `${currency} ${text}` }}</span>\n      </template>\n      <template slot=\"credit\" slot-scope=\"text\">\n        <span v-if=\"text!==null\">{{ `${currency} ${text}` }}</span>\n      </template>\n    </a-table>\n  </div>\n</template>\n\n<script>\nimport { api } from '@/api'\nimport moment from 'moment'\n\nexport default {\n  name: 'QuotaBalance',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    },\n    tab: {\n      type: String,\n      default: () => ''\n    }\n  },\n  data () {\n    return {\n      loading: false,\n      pattern: 'YYYY-MM-DD',\n      currency: '',\n      dataSource: [],\n      account: null\n    }\n  },\n  computed: {\n    columns () {\n      return [\n        {\n          title: this.$t('label.date'),\n          dataIndex: 'date',\n          width: 'calc(100% / 3)',\n          scopedSlots: { customRender: 'date' }\n        },\n        {\n          title: this.$t('label.quota.value'),\n          dataIndex: 'quota',\n          width: 'calc(100% / 3)',\n          scopedSlots: { customRender: 'quota' }\n        },\n        {\n          title: this.$t('label.credit'),\n          dataIndex: 'credit',\n          width: 'calc(100% / 3)',\n          scopedSlots: { customRender: 'credit' }\n        }\n      ]\n    }\n  },\n  watch: {\n    tab (newTab, oldTab) {\n      this.tab = newTab\n      if (this.tab === 'quota.statement.balance') {\n        this.fetchData()\n      }\n    }\n  },\n  mounted () {\n    this.fetchData()\n  },\n  methods: {\n    async fetchData () {\n      this.dataSource = []\n      this.loading = true\n      this.account = this.$route.query && this.$route.query.account ? this.$route.query.account : null\n\n      try {\n        const resource = await this.fetchResource()\n        const quotaBalance = await this.quotaBalance(resource)\n        this.currency = quotaBalance.currency\n        this.dataSource = await this.createDataSource(quotaBalance)\n        this.loading = false\n      } catch (e) {\n        console.log(e)\n        this.loading = false\n      }\n    },\n    createDataSource (quotaBalance) {\n      const dataSource = []\n      const credits = quotaBalance.credits || []\n\n      dataSource.push({\n        date: moment(quotaBalance.enddate).format(this.pattern),\n        quota: quotaBalance.endquota,\n        credit: null\n      })\n      dataSource.push({\n        date: moment(quotaBalance.startdate).format(this.pattern),\n        quota: quotaBalance.startquota,\n        credit: null\n      })\n      credits.map(item => {\n        dataSource.push({\n          date: moment(item.updated_on).format(this.pattern),\n          quota: null,\n          credit: item.credits\n        })\n      })\n\n      return dataSource\n    },\n    fetchResource () {\n      return new Promise((resolve, reject) => {\n        const params = {}\n        params.domainid = this.resource.domainid\n        params.account = this.account\n\n        api('quotaBalance', params).then(json => {\n          const quotaBalance = json.quotabalanceresponse.balance || {}\n          resolve(quotaBalance)\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    },\n    quotaBalance (resource) {\n      return new Promise((resolve, reject) => {\n        const params = {}\n        params.domainid = this.resource.domainid\n        params.account = this.account\n        params.startdate = moment(this.resource.startdate).format(this.pattern)\n        params.enddate = moment(resource.startdate).format(this.pattern)\n\n        api('quotaBalance', params).then(json => {\n          const quotaBalance = json.quotabalanceresponse.balance || {}\n          resolve(quotaBalance)\n        }).catch(error => {\n          reject(error)\n        })\n      })\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuotaBalance.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QuotaBalance.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QuotaBalance.vue?vue&type=template&id=0bab91e1&\"\nimport script from \"./QuotaBalance.vue?vue&type=script&lang=js&\"\nexport * from \"./QuotaBalance.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}