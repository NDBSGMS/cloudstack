(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d4593c1a"],{"60aa":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=this,t=r.$createElement,a=r._self._c||t;return a("div",{staticClass:"form-layout"},[a("a-spin",{attrs:{spinning:r.loading}},[a("a-form",{attrs:{form:r.form,layout:"vertical"},on:{submit:r.handleSubmit}},[a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.name"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.name.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:r.$t("message.error.kubecluster.name")}]}],expression:"['name', {\n            rules: [{ required: true, message: $t('message.error.kubecluster.name') }]\n          }]"}],attrs:{placeholder:r.apiParams.name.description}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.description"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.description.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!0,message:r.$t("message.error.cluster.description")}]}],expression:"['description', {\n            rules: [{ required: true, message: $t('message.error.cluster.description') }]\n          }]"}],attrs:{placeholder:r.apiParams.description.description}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.zoneid"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.zoneid.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["zoneid",{rules:[{required:!0,message:r.$t("message.error.zone.for.cluster")}]}],expression:"['zoneid', {\n            rules: [{ required: true, message: $t('message.error.zone.for.cluster') }]\n          }]"}],attrs:{id:"zone-selection",showSearch:"",optionFilterProp:"children",filterOption:function(e,r){return r.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:r.zoneLoading,placeholder:r.apiParams.zoneid.description},on:{change:function(r){e.handleZoneChange(e.zones[r])}}},r._l(this.zones,(function(e,t){return a("a-select-option",{key:t},[r._v(" "+r._s(e.name||e.description)+" ")])})),1)],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.kubernetesversionid"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.kubernetesversionid.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["kubernetesversionid",{rules:[{required:!0,message:r.$t("message.error.version.for.cluster")}]}],expression:"['kubernetesversionid', {\n            rules: [{ required: true, message: $t('message.error.version.for.cluster') }]\n          }]"}],attrs:{id:"version-selection",showSearch:"",optionFilterProp:"children",filterOption:function(e,r){return r.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:r.kubernetesVersionLoading,placeholder:r.apiParams.kubernetesversionid.description},on:{change:function(r){e.handleKubernetesVersionChange(e.kubernetesVersions[r])}}},r._l(this.kubernetesVersions,(function(e,t){return a("a-select-option",{key:t},[r._v(" "+r._s(e.name||e.description)+" ")])})),1)],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.serviceofferingid"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.serviceofferingid.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["serviceofferingid",{rules:[{required:!0,message:r.$t("message.error.serviceoffering.for.cluster")}]}],expression:"['serviceofferingid', {\n            rules: [{ required: true, message: $t('message.error.serviceoffering.for.cluster') }]\n          }]"}],attrs:{id:"offering-selection",showSearch:"",optionFilterProp:"children",filterOption:function(e,r){return r.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:r.serviceOfferingLoading,placeholder:r.apiParams.serviceofferingid.description}},r._l(this.serviceOfferings,(function(e,t){return a("a-select-option",{key:t},[r._v(" "+r._s(e.name||e.description)+" ")])})),1)],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.noderootdisksize"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.noderootdisksize.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["noderootdisksize",{rules:[{validator:function(r,t,a){t&&(isNaN(t)||t<=0)&&a(e.$t("message.validate.number")),a()}}]}],expression:"['noderootdisksize', {\n            rules: [{\n              validator: (rule, value, callback) => {\n                if (value && (isNaN(value) || value <= 0)) {\n                  callback(this.$t('message.validate.number'))\n                }\n                callback()\n              }\n            }]\n          }]"}],attrs:{placeholder:r.apiParams.noderootdisksize.description}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.networkid"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.networkid.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["networkid",{}],expression:"['networkid', {}]"}],attrs:{id:"network-selection",showSearch:"",optionFilterProp:"children",filterOption:function(e,r){return r.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:r.networkLoading,placeholder:r.apiParams.networkid.description}},r._l(this.networks,(function(e,t){return a("a-select-option",{key:t},[r._v(" "+r._s(e.name||e.description)+" ")])})),1)],1),null!=this.selectedKubernetesVersion&&void 0!=this.selectedKubernetesVersion&&!0===this.selectedKubernetesVersion.supportsha?a("a-form-item",{attrs:{label:r.$t("label.haenable")}},[a("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["haenable",{initialValue:this.haEnabled}],expression:"['haenable', {initialValue: this.haEnabled}]"}],attrs:{checked:this.haEnabled},on:{change:function(r){e.haEnabled=r}}})],1):r._e(),this.haEnabled?a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.masternodes"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.masternodes.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["masternodes",{initialValue:"2",rules:[{required:!0,message:r.$t("message.error.input.value")},{validator:function(r,t,a){t&&(isNaN(t)||t<2)&&a(e.$t("message.validate.number")),a()}}]}],expression:"['masternodes', {\n            initialValue: '2',\n            rules: [{ required: true, message: $t('message.error.input.value') },\n                    {\n                      validator: (rule, value, callback) => {\n                        if (value && (isNaN(value) || value < 2)) {\n                          callback(this.$t('message.validate.number'))\n                        }\n                        callback()\n                      }\n                    }\n            ]\n          }]"}],attrs:{placeholder:r.apiParams.masternodes.description}})],1):r._e(),this.haEnabled?a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.externalloadbalanceripaddress"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.externalloadbalanceripaddress.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["externalloadbalanceripaddress",{}],expression:"['externalloadbalanceripaddress', {}]"}],attrs:{placeholder:r.apiParams.externalloadbalanceripaddress.description}})],1):r._e(),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.cks.cluster.size"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.size.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["size",{initialValue:"1",rules:[{required:!0,message:r.$t("message.error.size.for.cluster")},{validator:function(r,t,a){t&&(isNaN(t)||t<=0)&&a(e.$t("message.validate.number")),a()}}]}],expression:"['size', {\n            initialValue: '1',\n            rules: [{ required: true, message: $t('message.error.size.for.cluster') },\n                    {\n                      validator: (rule, value, callback) => {\n                        if (value && (isNaN(value) || value <= 0)) {\n                          callback(this.$t('message.validate.number'))\n                        }\n                        callback()\n                      }\n                    }\n            ]\n          }]"}],attrs:{placeholder:r.apiParams.size.description}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.keypair"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.keypair.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["keypair",{}],expression:"['keypair', {}]"}],attrs:{id:"keypair-selection",showSearch:"",optionFilterProp:"children",filterOption:function(e,r){return r.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:r.keyPairLoading,placeholder:r.apiParams.keypair.description}},r._l(this.keyPairs,(function(e,t){return a("a-select-option",{key:t},[r._v(" "+r._s(e.name||e.description)+" ")])})),1)],1),r.$store.getters.features.kubernetesclusterexperimentalfeaturesenabled?a("div",[a("a-form-item",{attrs:{label:r.$t("label.private.registry")}},[a("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["privateregistry"],expression:"['privateregistry']"}],on:{change:function(r){e.usePrivateRegistry=r}}})],1),r.usePrivateRegistry?a("div",[a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.username"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.dockerregistryusername.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["dockerregistryusername",{rules:[{required:!0,message:r.$t("label.required")}]}],expression:"['dockerregistryusername', {\n                rules: [{ required: true, message: $t('label.required') }]\n              }]"}],attrs:{placeholder:r.apiParams.dockerregistryusername.description}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.password"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.dockerregistrypassword.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["dockerregistrypassword",{rules:[{required:!0,message:r.$t("label.required")}]}],expression:"['dockerregistrypassword', {\n                rules: [{ required: true, message: $t('label.required') }]\n              }]"}],attrs:{placeholder:r.apiParams.dockerregistrypassword.description}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.url"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.dockerregistryurl.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["dockerregistryurl",{rules:[{required:!0,message:r.$t("label.required")}]}],expression:"['dockerregistryurl', {\n                rules: [{ required: true, message: $t('label.required') }]\n              }]"}],attrs:{placeholder:r.apiParams.dockerregistryurl.description}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[r._v(" "+r._s(r.$t("label.email"))+" "),a("a-tooltip",{attrs:{title:r.apiParams.dockerregistryemail.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["dockerregistryemail",{rules:[{required:!0,message:r.$t("label.required")}]}],expression:"['dockerregistryemail', {\n                rules: [{ required: true, message: $t('label.required') }]\n              }]"}],attrs:{placeholder:r.apiParams.dockerregistryemail.description}})],1)],1):r._e()],1):r._e(),a("div",{staticClass:"action-button",attrs:{span:24}},[a("a-button",{on:{click:r.closeAction}},[r._v(r._s(this.$t("label.cancel")))]),a("a-button",{attrs:{loading:r.loading,type:"primary"},on:{click:r.handleSubmit}},[r._v(r._s(this.$t("label.ok")))])],1)],1)],1)],1)},s=[],i=(t("a4d3"),t("e01a"),t("99af"),t("4160"),t("b0c0"),t("b64b"),t("d3b7"),t("159b"),t("365c")),o={name:"CreateKubernetesCluster",props:{},data:function(){return{zones:[],zoneLoading:!1,selectedZone:{},kubernetesVersions:[],kubernetesVersionLoading:!1,selectedKubernetesVersion:{},serviceOfferings:[],serviceOfferingLoading:!1,networks:[],networkLoading:!1,keyPairs:[],keyPairLoading:!1,haEnabled:!1,usePrivateRegistry:!1,loading:!1}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiConfig=this.$store.getters.apis.createKubernetesCluster||{},this.apiParams={},this.apiConfig.params.forEach((function(r){e.apiParams[r.name]=r}))},created:function(){this.networks=[{id:null,name:""}],this.keyPairs=[{id:null,name:""}]},mounted:function(){this.fetchData()},methods:{fetchData:function(){this.fetchZoneData(),this.fetchNetworkData(),this.fetchKeyPairData()},isValidValueForKey:function(e,r){return r in e&&null!=e[r]},arrayHasItems:function(e){return null!==e&&void 0!==e&&Array.isArray(e)&&e.length>0},isObjectEmpty:function(e){return!(null!==e&&void 0!==e&&Object.keys(e).length>0&&e.constructor===Object)},fetchZoneData:function(){var e=this,r={};this.zoneLoading=!0,Object(i["a"])("listZones",r).then((function(r){var t=r.listzonesresponse.zone;e.zones=e.zones.concat(t)})).finally((function(){e.zoneLoading=!1,e.arrayHasItems(e.zones)&&(e.form.setFieldsValue({zoneid:0}),e.handleZoneChange(e.zones[0]))}))},handleZoneChange:function(e){this.selectedZone=e,this.fetchKubernetesVersionData()},fetchKubernetesVersionData:function(){var e=this;this.kubernetesVersions=[];var r={};this.isObjectEmpty(this.selectedZone)||(r.zoneid=this.selectedZone.id),this.kubernetesVersionLoading=!0,Object(i["a"])("listKubernetesSupportedVersions",r).then((function(r){var t=r.listkubernetessupportedversionsresponse.kubernetessupportedversion;if(e.arrayHasItems(t))for(var a=0;a<t.length;a++)"Enabled"===t[a].state&&"Ready"===t[a].isostate&&e.kubernetesVersions.push(t[a])})).finally((function(){e.kubernetesVersionLoading=!1,e.arrayHasItems(e.kubernetesVersions)&&(e.form.setFieldsValue({kubernetesversionid:0}),e.handleKubernetesVersionChange(e.kubernetesVersions[0]))}))},handleKubernetesVersionChange:function(e){this.selectedKubernetesVersion=e,this.fetchServiceOfferingData()},fetchServiceOfferingData:function(){var e=this;this.serviceOfferings=[];var r={};this.serviceOfferingLoading=!0,Object(i["a"])("listServiceOfferings",r).then((function(r){var t=r.listserviceofferingsresponse.serviceoffering,a=2,s=2048;if(e.isObjectEmpty(e.selectedKubernetesVersion)||(a=e.selectedKubernetesVersion.mincpunumber,s=e.selectedKubernetesVersion.minmemory),null!=t)for(var i=0;i<t.length;i++)!1===t[i].iscustomized&&t[i].cpunumber>=a&&t[i].memory>=s&&e.serviceOfferings.push(t[i])})).finally((function(){e.serviceOfferingLoading=!1,e.arrayHasItems(e.serviceOfferings)&&e.form.setFieldsValue({serviceofferingid:0})}))},fetchNetworkData:function(){var e=this,r={};this.networkLoading=!0,Object(i["a"])("listNetworks",r).then((function(r){var t=r.listnetworksresponse.network;e.arrayHasItems(t)&&(e.networks=e.networks.concat(t))})).finally((function(){e.networkLoading=!1,e.arrayHasItems(e.networks)&&e.form.setFieldsValue({networkid:0})}))},fetchKeyPairData:function(){var e=this,r={};this.keyPairLoading=!0,Object(i["a"])("listSSHKeyPairs",r).then((function(r){var t=r.listsshkeypairsresponse.sshkeypair;if(e.arrayHasItems(t))for(var a=0;a<t.length;a++)e.keyPairs.push({id:t[a].name,description:t[a].name})})).finally((function(){e.keyPairLoading=!1,e.arrayHasItems(e.keyPairs)&&e.form.setFieldsValue({keypair:0})}))},handleSubmit:function(e){var r=this;e.preventDefault(),this.form.validateFields((function(e,t){if(!e){r.loading=!0;var a={name:t.name,description:t.description,zoneid:r.zones[t.zoneid].id,kubernetesversionid:r.kubernetesVersions[t.kubernetesversionid].id,serviceofferingid:r.serviceOfferings[t.serviceofferingid].id,size:t.size};r.isValidValueForKey(t,"noderootdisksize")&&t.noderootdisksize>0&&(a.noderootdisksize=t.noderootdisksize),r.isValidValueForKey(t,"masternodes")&&t.masternodes>0&&(a.masternodes=t.masternodes),r.isValidValueForKey(t,"externalloadbalanceripaddress")&&""!==t.externalloadbalanceripaddress&&(a.externalloadbalanceripaddress=t.externalloadbalanceripaddress),r.isValidValueForKey(t,"networkid")&&r.arrayHasItems(r.networks)&&null!=r.networks[t.networkid].id&&(a.networkid=r.networks[t.networkid].id),r.isValidValueForKey(t,"keypair")&&r.arrayHasItems(r.keyPairs)&&null!=r.keyPairs[t.keypair].id&&(a.keypair=r.keyPairs[t.keypair].id),r.usePrivateRegistry&&(a.dockerregistryusername=t.dockerregistryusername,a.dockerregistrypassword=t.dockerregistrypassword,a.dockerregistryurl=t.dockerregistryurl,a.dockerregistryemail=t.dockerregistryemail),Object(i["a"])("createKubernetesCluster",a).then((function(e){var a=e.createkubernetesclusterresponse.jobid;r.$store.dispatch("AddAsyncJob",{title:r.$t("label.kubernetes.cluster.create"),jobid:a,description:t.name,status:"progress"}),r.$pollJob({jobId:a,loadingMessage:"".concat(r.$t("label.kubernetes.cluster.create")," ").concat(t.name," ").concat(r.$t("label.in.progress")),catchMessage:r.$t("error.fetching.async.job.result"),successMessage:r.$t("message.success.create.kubernetes.cluter")+" "+t.name,successMethod:function(e){r.$emit("refresh-data")}}),r.closeAction(),r.$emit("refresh-data")})).catch((function(e){r.$notifyError(e)})).finally((function(){r.loading=!1}))}}))},closeAction:function(){this.$emit("close-action")}}},n=o,l=(t("aab8"),t("2877")),c=Object(l["a"])(n,a,s,!1,null,"4496199a",null);r["default"]=c.exports},aab8:function(e,r,t){"use strict";var a=t("cd9dd"),s=t.n(a);s.a},cd9dd:function(e,r,t){}}]);
//# sourceMappingURL=chunk-d4593c1a.f2fe7b16.js.map