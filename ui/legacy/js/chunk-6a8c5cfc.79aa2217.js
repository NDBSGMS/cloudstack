(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a8c5cfc"],{3814:function(e,t,r){},b4b1:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-spin",{attrs:{spinning:e.formLoading}},[r("a-form",{attrs:{form:e.form,layout:"vertical"},on:{submit:e.handleSubmit}},[e._l(e.dataResource,(function(t,i){return"project"!==t.resourcetypename?r("a-form-item",{key:i,attrs:{"v-bind":t.resourcetypename,label:e.$t("label.max"+t.resourcetypename.replace("_",""))}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:[t.resourcetype,{initialValue:t.max}],expression:"[item.resourcetype, {\n          initialValue: item.max\n        }]"}],staticStyle:{width:"100%"},attrs:{disabled:!("updateResourceLimit"in e.$store.getters.apis)}})],1):e._e()})),r("div",{staticClass:"card-footer"},["domain"!==e.$route.meta.name||0!==e.resource.level?r("a-button",{attrs:{disabled:!("updateResourceLimit"in e.$store.getters.apis),loading:e.formLoading,type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("label.submit")))]):e._e()],1)],2)],1)},a=[],n=(r("b0c0"),r("d3b7"),r("3ca3"),r("ddb0"),r("96cf"),r("c964")),o=r("365c"),s={name:"ResourceLimitTab",props:{resource:{type:Object,required:!0},loading:{type:Boolean,default:!1}},data:function(){return{formLoading:!1,dataResource:[]}},beforeCreate:function(){this.form=this.$form.createForm(this)},mounted:function(){this.fetchData()},watch:{resource:function(e,t){e&&e.id&&(this.resource=e,this.fetchData())}},methods:{getParams:function(){var e={};return"account"===this.$route.meta.name?(e.account=this.resource.name,e.domainid=this.resource.domainid):"domain"===this.$route.meta.name?e.domainid=this.resource.id:e.projectid=this.resource.id,e},fetchData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.getParams(),t.prev=1,e.formLoading=!0,t.next=5,e.listResourceLimits(r);case 5:e.dataResource=t.sent,e.formLoading=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),e.$notification.error({message:e.$t("message.request.failed"),description:t.t0}),e.formLoading=!1;case 13:case"end":return t.stop()}}),t,null,[[1,9]])})))()},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,r){if(!e){var i=[],a=t.getParams();for(var n in r){var o=r[n];void 0!==o&&(a.resourcetype=n,a.max=o,i.push(t.updateResourceLimit(a)))}t.formLoading=!0,Promise.all(i).then((function(){t.$message.success(t.$t("message.apply.success")),t.fetchData()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.formLoading=!1}))}}))},listResourceLimits:function(e){return new Promise((function(t,r){var i=[];Object(o["a"])("listResourceLimits",e).then((function(e){e.listresourcelimitsresponse.resourcelimit&&(i=e.listresourcelimitsresponse.resourcelimit,i.sort((function(e,t){return e.resourcetype-t.resourcetype}))),t(i)})).catch((function(e){r(e.response.headers["x-description"])}))}))},updateResourceLimit:function(e){return new Promise((function(t,r){Object(o["a"])("updateResourceLimit",e).then((function(e){t()})).catch((function(e){r(e)}))}))}}},c=s,u=(r("e537"),r("2877")),m=Object(u["a"])(c,i,a,!1,null,"004f1203",null);t["default"]=m.exports},e537:function(e,t,r){"use strict";var i=r("3814"),a=r.n(i);a.a}}]);
//# sourceMappingURL=chunk-6a8c5cfc.79aa2217.js.map