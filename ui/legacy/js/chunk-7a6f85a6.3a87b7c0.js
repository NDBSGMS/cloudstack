(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a6f85a6"],{"302a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"backup-layout"},[a("a-tabs",{attrs:{defaultActiveKey:"1",animated:!1}},[a("a-tab-pane",{key:"1",attrs:{tab:e.$t("label.schedule")}},[a("FormSchedule",{attrs:{loading:e.loading,resource:e.resource,dataSource:e.dataSource}})],1),a("a-tab-pane",{key:"2",attrs:{tab:e.$t("label.scheduled.backups")}},[a("BackupSchedule",{attrs:{loading:e.loading,resource:e.resource,dataSource:e.dataSource}})],1)],1)],1)},n=[],s=(a("d3b7"),a("365c")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-spin",{attrs:{spinning:e.loading}},[a("div",{staticClass:"form-layout"},[a("label",[e._v(" "+e._s(e.$t("label.header.backup.schedule"))+" ")]),a("div",{staticClass:"form"},[a("a-form",{attrs:{form:e.form,layout:"vertical"},on:{submit:e.handleSubmit}},[a("a-row",{attrs:{gutter:12}},[a("a-col",{attrs:{md:24,lg:24}},[a("a-form-item",{attrs:{label:e.$t("label.intervaltype")}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["intervaltype",{initialValue:e.intervalType}],expression:"['intervaltype', {\n                  initialValue: intervalType\n                }]"}],attrs:{buttonStyle:"solid"},on:{change:e.handleChangeIntervalType}},[a("a-radio-button",{attrs:{value:"hourly"}},[e._v(" "+e._s(e.$t("label.hourly"))+" ")]),a("a-radio-button",{attrs:{value:"daily"}},[e._v(" "+e._s(e.$t("label.daily"))+" ")]),a("a-radio-button",{attrs:{value:"weekly"}},[e._v(" "+e._s(e.$t("label.weekly"))+" ")]),a("a-radio-button",{attrs:{value:"monthly"}},[e._v(" "+e._s(e.$t("label.monthly"))+" ")])],1)],1)],1),"hourly"===e.intervalType?a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{attrs:{label:e.$t("label.time")}},[a("a-tooltip",{attrs:{placement:"right",title:e.$t("label.minute.past.hour")}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["time",{rules:[{required:!0,message:e.$t("message.error.required.input")}]}],expression:"['time', {\n                    rules: [{required: true, message: $t('message.error.required.input')}]\n                  }]"}],staticStyle:{width:"100%"},attrs:{min:1,max:59}})],1)],1)],1):e._e(),["daily","weekly","monthly"].includes(e.intervalType)?a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{staticClass:"custom-time-select",attrs:{label:e.$t("label.time")}},[a("a-time-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["timeSelect",{rules:[{type:"object",required:!0,message:e.$t("message.error.time")}]}],expression:"['timeSelect', {\n                  rules: [{\n                    type: 'object',\n                    required: true,\n                    message: $t('message.error.time')\n                  }]\n                }]"}],attrs:{use12Hours:"",format:"h:mm A"}})],1)],1):e._e(),"weekly"===e.intervalType?a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{attrs:{label:e.$t("label.day.of.week")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["day-of-week",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['day-of-week', {\n                  rules: [{\n                    required: true,\n                    message: `${this.$t('message.error.select')}`\n                  }]\n                }]"}]},e._l(e.dayOfWeek,(function(t,i){return a("a-select-option",{key:i},[e._v(" "+e._s(t.name||t.description)+" ")])})),1)],1)],1):e._e(),"monthly"===e.intervalType?a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{attrs:{label:e.$t("label.day.of.month")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["day-of-month",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['day-of-month', {\n                  rules: [{\n                    required: true,\n                    message: `${this.$t('message.error.select')}`\n                  }]\n                }]"}]},e._l(e.dayOfMonth,(function(t){return a("a-select-option",{key:t.name},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1):e._e(),a("a-col",{attrs:{md:24,lg:24}},[a("a-form-item",{attrs:{label:e.$t("label.timezone")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["timezone",{rules:[{required:!0,messamessage:""+this.$t("message.error.select")}]}],expression:"['timezone', {\n                  rules: [{\n                    required: true,\n                    messamessage: `${this.$t('message.error.select')}`\n                  }]\n                }]"}],attrs:{showSearch:"",loading:e.fetching}},e._l(e.timeZoneMap,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name||t.description)+" ")])})),1)],1)],1)],1),a("div",{staticClass:"action-button",attrs:{span:24}},[a("a-button",{attrs:{loading:e.actionLoading},on:{click:e.closeAction}},[e._v(" "+e._s(this.$t("label.cancel"))+" ")]),a("a-button",{attrs:{loading:e.actionLoading,type:"primary"},on:{click:e.handleSubmit}},[e._v(" "+e._s(this.$t("label.ok"))+" ")])],1)],1)],1)])])},o=[],l=(a("a15b"),a("e95a3")),c=a("b047"),u=a.n(c),d={name:"FormSchedule",props:{loading:{type:Boolean,default:!1},dataSource:{type:Object,required:!0},resource:{type:Object,required:!0}},data:function(){return this.fetchTimeZone=u()(this.fetchTimeZone,800),{dayOfWeek:[],dayOfMonth:[],timeZoneMap:[],fetching:!1,actionLoading:!1,intervalValue:0,intervalType:"hourly",listDayOfWeek:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]}},beforeCreate:function(){this.form=this.$form.createForm(this)},mounted:function(){this.fetchTimeZone()},inject:["refreshSchedule","closeSchedule"],methods:{fetchTimeZone:function(e){var t=this;this.timeZoneMap=[],this.fetching=!0,Object(l["a"])(e).then((function(e){t.timeZoneMap=e,t.fetching=!1}))},fetchDayOfWeek:function(){for(var e in this.dayOfWeek=[],this.listDayOfWeek){var t=this.listDayOfWeek[e];this.dayOfWeek.push({id:t,name:this.$t("label."+t)})}},fetchDayOfMonth:function(){this.dayOfMonth=[];for(var e=28,t=1;t<=e;t++)this.dayOfMonth.push({id:t,name:t})},handleChangeIntervalType:function(e){switch(this.intervalType=e.target.value,this.resetForm(),this.intervalType){case"hourly":this.intervalValue="HOURLY";break;case"daily":this.intervalValue="DAILY";break;case"weekly":this.intervalValue="WEEKLY",this.fetchDayOfWeek();break;case"monthly":this.intervalValue="MONTHLY",this.fetchDayOfMonth();break}},handleSubmit:function(e){var t=this;this.form.validateFields((function(e,a){if(!e){var i={};switch(i.virtualmachineid=t.resource.id,i.intervaltype=a.intervaltype,i.timezone=a.timezone,a.intervaltype){case"hourly":i.schedule=a.time;break;case"daily":i.schedule=a.timeSelect.format("mm:HH");break;case"weekly":i.schedule=[a.timeSelect.format("mm:HH"),a["day-of-week"]+1].join(":");break;case"monthly":i.schedule=[a.timeSelect.format("mm:HH"),a["day-of-month"]].join(":");break}t.actionLoading=!0,Object(s["a"])("createBackupSchedule",i).then((function(e){t.$notification.success({message:t.$t("label.scheduled.backups"),description:t.$t("message.success.config.backup.schedule")}),t.refreshSchedule(),t.resetForm()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.actionLoading=!1}))}}))},resetForm:function(){this.form.setFieldsValue({time:void 0,timezone:void 0,timeSelect:void 0,"day-of-week":void 0,"day-of-month":void 0}),this.tags=[]},closeAction:function(){this.closeSchedule()}}},h=d,m=(a("7ba9"),a("2877")),f=Object(m["a"])(h,r,o,!1,null,"37ddb69e",null),p=f.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-schedule"},[a("a-table",{attrs:{size:"small",columns:e.columns,dataSource:e.dataSchedules,rowKey:function(e){return e.virtualmachineid},pagination:!1,loading:e.loading},scopedSlots:e._u([{key:"icon",fn:function(t,i){return a("div",{},[a("label",{staticClass:"interval-icon"},["HOURLY"===i.intervaltype?a("span",[a("a-icon",{attrs:{type:"clock-circle"}})],1):"DAILY"===i.intervaltype?a("span",{staticClass:"custom-icon icon-daily"},[a("a-icon",{attrs:{type:"calendar"}})],1):"WEEKLY"===i.intervaltype?a("span",{staticClass:"custom-icon icon-weekly"},[a("a-icon",{attrs:{type:"calendar"}})],1):"MONTHLY"===i.intervaltype?a("span",{staticClass:"custom-icon icon-monthly"},[a("a-icon",{attrs:{type:"calendar"}})],1):e._e()])])}},{key:"time",fn:function(t,i){return a("div",{},[a("label",{staticClass:"interval-content"},["HOURLY"===i.intervaltype?a("span",[e._v(e._s(i.schedule+" "+e.$t("label.min.past.hour")))]):a("span",[e._v(e._s(i.schedule.split(":")[1]+":"+i.schedule.split(":")[0]))])])])}},{key:"interval",fn:function(t,i){return a("div",{},["WEEKLY"===i.intervaltype?a("span",[e._v(" "+e._s(e.$t("label.every")+" "+e.$t(e.listDayOfWeek[i.schedule.split(":")[2]-1]))+" ")]):"MONTHLY"===i.intervaltype?a("span",[e._v(" "+e._s(e.$t("label.day")+" "+i.schedule.split(":")[2]+" "+e.$t("label.of.month"))+" ")]):e._e()])}},{key:"timezone",fn:function(t,i){return a("div",{},[a("label",[e._v(e._s(e.getTimeZone(i.timezone)))])])}},{key:"action",fn:function(t,i){return a("div",{staticClass:"account-button-action"},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[e._v(" "+e._s(e.$t("label.delete"))+" ")]),a("a-button",{attrs:{type:"danger",shape:"circle",icon:"close",size:"small",loading:e.actionLoading},on:{click:function(t){return e.handleClickDelete(i)}}})],2)],1)}}])})],1)},v=[],b=(a("b64b"),{name:"BackupSchedule",props:{loading:{type:Boolean,default:!1},dataSource:{type:Object,required:!0},resource:{type:Object,required:!0}},data:function(){return{actionLoading:!1,dataSchedules:[],listDayOfWeek:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]}},computed:{columns:function(){return[{title:"",dataIndex:"icon",width:30,scopedSlots:{customRender:"icon"}},{title:this.$t("label.time"),dataIndex:"schedule",scopedSlots:{customRender:"time"}},{title:"",dataIndex:"interval",scopedSlots:{customRender:"interval"}},{title:this.$t("label.timezone"),dataIndex:"timezone",scopedSlots:{customRender:"timezone"}},{title:this.$t("label.action"),dataIndex:"action",width:50,scopedSlots:{customRender:"action"}}]}},mounted:function(){this.dataSchedules=[],this.dataSource&&Object.keys(this.dataSource).length>0&&this.dataSchedules.push(this.dataSource)},inject:["refreshSchedule"],watch:{dataSource:function(e,t){this.dataSchedules=[],e&&Object.keys(e).length>0&&this.dataSchedules.push(e)}},methods:{handleClickDelete:function(e){var t=this,a={};a.virtualmachineid=e.virtualmachineid,this.actionLoading=!0,Object(s["a"])("deleteBackupSchedule",a).then((function(e){e.deletebackupscheduleresponse.success&&t.$notification.success({message:t.$t("label.scheduled.backups"),description:t.$t("message.success.delete.backup.schedule")}),t.refreshSchedule()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.actionLoading=!1}))},getTimeZone:function(e){return Object(l["b"])(e)}}}),g=b,k=(a("b06d"),Object(m["a"])(g,y,v,!1,null,"349f13a1",null)),S=k.exports,$={name:"BackupScheduleWizard",components:{FormSchedule:p,BackupSchedule:S},props:{resource:{type:Object,required:!0}},data:function(){return{loading:!1,dataSource:{}}},provide:function(){return{refreshSchedule:this.fetchData,closeSchedule:this.closeAction}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this,t={};this.dataSource={},this.loading=!0,t.virtualmachineid=this.resource.id,Object(s["a"])("listBackupSchedule",t).then((function(t){e.dataSource=t.listbackupscheduleresponse.backupschedule||{}})).finally((function(){e.loading=!1}))},closeAction:function(){this.$emit("close-action")}}},_=$,O=(a("58f9"),Object(m["a"])(_,i,n,!1,null,"e9c86228",null));t["default"]=O.exports},"58f9":function(e,t,a){"use strict";var i=a("700a"),n=a.n(i);n.a},"700a":function(e,t,a){},"7ba9":function(e,t,a){"use strict";var i=a("7d61"),n=a.n(i);n.a},"7d61":function(e,t,a){},b06d:function(e,t,a){"use strict";var i=a("d330"),n=a.n(i);n.a},d330:function(e,t,a){}}]);
//# sourceMappingURL=chunk-7a6f85a6.3a87b7c0.js.map