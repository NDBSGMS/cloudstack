(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2743438a"],{"716b":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"list",attrs:{loading:e.loading}},[i("div",{staticClass:"list__header"},[e.tiersSelect?i("div",{staticClass:"list__header__col"},[i("a-select",{attrs:{placeholder:e.$t("label.select.tier")},on:{change:e.handleTierSelect},model:{value:e.vpcTiers,callback:function(t){e.vpcTiers=t},expression:"vpcTiers"}},e._l(e.networksList,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e(),i("div",{staticClass:"list__header__col list__header__col--full"},[i("a-input-search",{attrs:{placeholder:e.$t("label.search")},on:{search:e.fetchData},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1)]),i("a-table",{attrs:{size:"small",loading:e.loading,columns:e.columns,dataSource:e.vmsList,pagination:!1,rowKey:function(e){return e.id||e.account}},scopedSlots:e._u([{key:"name",fn:function(t){return[i("div",[e._v(" "+e._s(t.name)+" ")]),e.nicsList.length&&e.selectedVm&&e.selectedVm===t.id?i("a-select",{staticClass:"nic-select",attrs:{defaultValue:e.selectedNic.ipaddress}},e._l(e.nicsList,(function(t){return i("a-select-option",{key:t.id,on:{click:function(i){e.selectedNic=t}}},[e._v(" "+e._s(t.ipaddress)+" ")])})),1):e._e()]}},{key:"state",fn:function(e){return[i("status",{attrs:{text:e||"",displayText:""}})]}},{key:"radio",fn:function(t){return[i("a-radio",{staticClass:"list__radio",attrs:{value:t,checked:e.selectedVm&&e.selectedVm===t},on:{change:e.fetchNics}})]}}])}),i("a-pagination",{staticClass:"row-element pagination",attrs:{size:"small",current:e.page,pageSize:e.pageSize,total:e.vmsList.length,showTotal:function(t){return e.$t("label.total")+" "+t+" "+e.$t("label.items")},pageSizeOptions:["10","20","40","80","100"],showSizeChanger:""},on:{change:e.changePage,showSizeChange:e.changePageSize},scopedSlots:e._u([{key:"buildOptionText",fn:function(t){return[i("span",[e._v(e._s(t.value)+" / "+e._s(e.$t("label.page")))])]}}])}),i("div",{staticClass:"list__footer"},[i("a-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("label.cancel")))]),i("a-button",{attrs:{type:"primary",disabled:!e.selectedVm||!e.selectedNic},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("label.ok")))])],1)],1)},a=[],n=(i("99af"),i("d81d"),i("d3b7"),i("d0ff")),c=i("365c"),l=i("829c"),o={props:{resource:{type:Object,required:!0}},components:{Status:l["a"]},inject:["parentFetchData"],data:function(){return{loading:!1,vmsList:[],selectedVm:null,nicsList:[],searchQuery:null,selectedNic:null,columns:[{title:this.$t("label.name"),scopedSlots:{customRender:"name"}},{title:this.$t("label.state"),dataIndex:"state",scopedSlots:{customRender:"state"}},{title:this.$t("label.displayname"),dataIndex:"displayname"},{title:this.$t("label.account"),dataIndex:"account"},{title:this.$t("label.zonenamelabel"),dataIndex:"zonename"},{title:this.$t("label.select"),dataIndex:"id",scopedSlots:{customRender:"radio"}}],tiersSelect:!1,networksList:[],vpcTiers:[],selectedVpcTier:null,page:1,pageSize:10}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;if(this.resource.vpcid)return this.handleTiers(),void(this.selectedVpcTier&&this.fetchDataTiers(this.selectedVpcTier));this.loading=!0,Object(c["a"])("listVirtualMachines",{page:this.page,pageSize:this.pageSize,listAll:!0,networkid:this.resource.associatednetworkid,account:this.resource.account,domainid:this.resource.domainid,keyword:this.searchQuery}).then((function(t){e.vmsList=t.listvirtualmachinesresponse.virtualmachine||[]})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1}))},fetchDataTiers:function(e){var t=this;this.loading=!0,Object(c["a"])("listVirtualMachines",{page:this.page,pageSize:this.pageSize,listAll:!0,networkid:e,account:this.resource.account,domainid:this.resource.domainid,vpcid:this.resource.vpcid,keyword:this.searchQuery}).then((function(e){t.vmsList=e.listvirtualmachinesresponse.virtualmachine||[]})).catch((function(e){t.$notifyError(e)})).finally((function(){t.loading=!1}))},fetchNics:function(e){var t=this;this.selectedVm=e.target.value,this.nicsList=[],this.loading=!0,Object(c["a"])("listNics",{virtualmachineid:this.selectedVm,networkid:this.resource.associatednetworkid||this.selectedVpcTier}).then((function(e){t.nicsList=e.listnicsresponse.nic||[];var i=t.nicsList.map((function(e){return e.secondaryip}));i[0]&&(i=i[0],t.nicsList=[].concat(Object(n["a"])(t.nicsList),Object(n["a"])(i))),t.selectedNic=t.nicsList[0]})).catch((function(e){t.$notifyError(e)})).finally((function(){t.loading=!1}))},fetchNetworks:function(){var e=this;this.loading=!0,Object(c["a"])("listNetworks",{vpcid:this.resource.vpcid,domainid:this.resource.domainid,account:this.resource.account,supportedservices:"StaticNat"}).then((function(t){e.networksList=t.listnetworksresponse.network})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1}))},handleSubmit:function(){var e=this;this.loading=!0,Object(c["a"])("enableStaticNat",{ipaddressid:this.resource.id,virtualmachineid:this.selectedVm,vmguestip:this.selectedNic.ipaddress,networkid:this.selectedVpcTier}).then((function(){e.parentFetchData(),e.handleClose()})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1}))},handleClose:function(){this.$parent.$parent.close()},handleTiers:function(){this.tiersSelect=!0,this.fetchNetworks()},handleTierSelect:function(e){this.selectedVpcTier=e,this.fetchDataTiers(e)},changePage:function(e,t){this.page=e,this.pageSize=t,this.fetchData()},changePageSize:function(e,t){this.page=e,this.pageSize=t,this.fetchData()}}},r=o,d=(i("a268"),i("2877")),u=Object(d["a"])(r,s,a,!1,null,"81a8287a",null);t["default"]=u.exports},"946f":function(e,t,i){},a268:function(e,t,i){"use strict";var s=i("946f"),a=i.n(s);a.a}}]);
//# sourceMappingURL=chunk-2743438a.25978e3a.js.map