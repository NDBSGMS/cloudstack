{"version":3,"sources":["webpack:///./src/views/network/InternalLBAssignedVmTab.vue?d402","webpack:///src/views/network/InternalLBAssignedVmTab.vue","webpack:///./src/views/network/InternalLBAssignedVmTab.vue?563a","webpack:///./src/views/network/InternalLBAssignedVmTab.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","fetchLoading","staticStyle","columns","assignedVms","item","id","scopedSlots","_u","key","fn","text","record","path","_v","_s","displayname","name","_l","nic","networkid","resource","ipaddress","_e","on","$event","removeVmFromLB","staticClass","page","pageSize","totalInstances","total","$t","changePage","changePageSize","props","value","staticRenderFns","type","Object","required","data","mounted","fetchData","watch","newItem","methods","pagesize","virtualmachineids","vm","jobId","response","removefromloadbalancerruleresponse","jobid","successMessage","successMethod","errorMessage","errorMethod","loadingMessage","catchMessage","currentPage","component"],"mappings":"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","file":"js/chunk-2d2160af.6898edcd.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-spin',{attrs:{\"spinning\":_vm.fetchLoading}},[_c('a-table',{staticStyle:{\"overflow-y\":\"auto\",\"margin-bottom\":\"15px\"},attrs:{\"size\":\"small\",\"columns\":_vm.columns,\"dataSource\":_vm.assignedVms,\"rowKey\":function (item) { return item.id; },\"pagination\":false},scopedSlots:_vm._u([{key:\"displayname\",fn:function(text, record){return [_c('router-link',{attrs:{\"to\":{ path: '/vm/' + record.id }}},[_vm._v(_vm._s(record.displayname || record.name))])]}},{key:\"ipaddress\",fn:function(text, record){return _vm._l((record.nic),function(nic){return _c('span',{key:nic.id},[(nic.networkid === _vm.resource.networkid)?_c('span',[_vm._v(\" \"+_vm._s(nic.ipaddress)+\" \"),_c('br')]):_vm._e()])})}},{key:\"remove\",fn:function(text, record){return [_c('a-button',{attrs:{\"type\":\"danger\",\"icon\":\"delete\",\"shape\":\"circle\"},on:{\"click\":function($event){return _vm.removeVmFromLB(record)}}})]}}])},[_c('a-divider')],1),_c('a-pagination',{staticClass:\"row-element pagination\",attrs:{\"size\":\"small\",\"current\":_vm.page,\"pageSize\":_vm.pageSize,\"total\":_vm.totalInstances,\"showTotal\":function (total) { return ((_vm.$t('label.total')) + \" \" + total + \" \" + (_vm.$t('label.items'))); },\"pageSizeOptions\":['10', '20', '40', '80', '100'],\"showSizeChanger\":\"\"},on:{\"change\":_vm.changePage,\"showSizeChange\":_vm.changePageSize},scopedSlots:_vm._u([{key:\"buildOptionText\",fn:function(props){return [_c('span',[_vm._v(_vm._s(props.value)+\" / \"+_vm._s(_vm.$t('label.page')))])]}}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <a-spin :spinning=\"fetchLoading\">\n    <a-table\n      size=\"small\"\n      style=\"overflow-y: auto; margin-bottom: 15px\"\n      :columns=\"columns\"\n      :dataSource=\"assignedVms\"\n      :rowKey=\"item => item.id\"\n      :pagination=\"false\"\n    >\n      <template slot=\"displayname\" slot-scope=\"text, record\">\n        <router-link :to=\"{ path: '/vm/' + record.id }\">{{ record.displayname || record.name }}</router-link>\n      </template>\n      <template slot=\"ipaddress\" slot-scope=\"text, record\">\n        <span v-for=\"nic in record.nic\" :key=\"nic.id\">\n          <span v-if=\"nic.networkid === resource.networkid\">\n            {{ nic.ipaddress }} <br/>\n          </span>\n        </span>\n      </template>\n      <template slot=\"remove\" slot-scope=\"text, record\">\n        <a-button\n          type=\"danger\"\n          icon=\"delete\"\n          shape=\"circle\"\n          @click=\"removeVmFromLB(record)\" />\n      </template>\n      <a-divider />\n    </a-table>\n    <a-pagination\n      class=\"row-element pagination\"\n      size=\"small\"\n      :current=\"page\"\n      :pageSize=\"pageSize\"\n      :total=\"totalInstances\"\n      :showTotal=\"total => `${$t('label.total')} ${total} ${$t('label.items')}`\"\n      :pageSizeOptions=\"['10', '20', '40', '80', '100']\"\n      @change=\"changePage\"\n      @showSizeChange=\"changePageSize\"\n      showSizeChanger>\n      <template slot=\"buildOptionText\" slot-scope=\"props\">\n        <span>{{ props.value }} / {{ $t('label.page') }}</span>\n      </template>\n    </a-pagination>\n  </a-spin>\n</template>\n<script>\nimport { api } from '@/api'\n\nexport default {\n  name: 'InternalLBAssignedVmTab',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    }\n  },\n  data () {\n    return {\n      fetchLoading: false,\n      assignedVms: [],\n      page: 1,\n      pageSize: 10,\n      totalInstances: 0,\n      columns: [\n        {\n          title: this.$t('label.name'),\n          dataIndex: 'displayname',\n          scopedSlots: { customRender: 'displayname' }\n        },\n        {\n          title: this.$t('label.ipaddress'),\n          dataIndex: 'ipaddress',\n          scopedSlots: { customRender: 'ipaddress' }\n        },\n        {\n          title: '',\n          scopedSlots: { customRender: 'remove' }\n        }\n      ]\n    }\n  },\n  mounted () {\n    this.fetchData()\n  },\n  watch: {\n    resource: function (newItem, oldItem) {\n      if (!newItem || !newItem.id) {\n        return\n      }\n      this.fetchData()\n    }\n  },\n  methods: {\n    fetchData () {\n      this.fetchLoading = true\n      api('listLoadBalancerRuleInstances', {\n        id: this.resource.id,\n        page: this.page,\n        pagesize: this.pageSize\n      }).then(response => {\n        this.totalInstances = response.listloadbalancerruleinstancesresponse.count || 0\n        this.assignedVms = response.listloadbalancerruleinstancesresponse.loadbalancerruleinstance || []\n      }).finally(() => {\n        this.fetchLoading = false\n      })\n    },\n    removeVmFromLB (vm) {\n      this.fetchLoading = true\n      api('removeFromLoadBalancerRule', {\n        id: this.resource.id,\n        virtualmachineids: vm.id\n      }).then(response => {\n        this.$pollJob({\n          jobId: response.removefromloadbalancerruleresponse.jobid,\n          successMessage: `${this.$t('message.success.remove.ip')} ${vm.name} ${this.$t('label.from')} ${this.resource.name}`,\n          successMethod: () => {\n            this.fetchLoading = false\n            this.fetchData()\n          },\n          errorMessage: `${this.$t('message.failed.to.remove')} ${vm.name} ${this.$t('label.from.lb')}`,\n          errorMethod: () => {\n            this.fetchLoading = false\n            this.fetchData()\n          },\n          loadingMessage: `${this.$t('label.removing')} ${vm.name} ${this.$t('label.from.lb')} ${this.$t('label.in.progress')}`,\n          catchMessage: this.$t('error.fetching.async.job.result')\n        })\n      })\n    },\n    changePage (page, pageSize) {\n      this.page = page\n      this.pageSize = pageSize\n      this.fetchData()\n    },\n    changePageSize (currentPage, pageSize) {\n      this.page = currentPage\n      this.pageSize = pageSize\n      this.fetchData()\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InternalLBAssignedVmTab.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InternalLBAssignedVmTab.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./InternalLBAssignedVmTab.vue?vue&type=template&id=1338e69e&scoped=true&\"\nimport script from \"./InternalLBAssignedVmTab.vue?vue&type=script&lang=js&\"\nexport * from \"./InternalLBAssignedVmTab.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1338e69e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}