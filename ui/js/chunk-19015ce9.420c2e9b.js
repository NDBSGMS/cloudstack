(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19015ce9"],{6040:function(t,e,s){},"81db":function(t,e,s){"use strict";var i=s("6040"),a=s.n(i);a.a},f45f:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-layout"},[s("a-spin",{attrs:{spinning:t.loading}},[s("a-form",{attrs:{form:t.form,layout:"vertical"}},[s("a-form-item",{attrs:{label:t.$t("label.iso.name")}},[s("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{initialValue:this.selectedIso,rules:[{required:!0,message:""+this.$t("label.required")}]}],expression:"['id', {\n            initialValue: this.selectedIso,\n            rules: [{ required: true, message: `${this.$t('label.required')}`}]\n          }]"}],attrs:{loading:t.loading}},t._l(t.isos,(function(e){return s("a-select-option",{key:e.id},[t._v(" "+t._s(e.displaytext||e.name)+" ")])})),1)],1)],1),s("div",{staticClass:"action-button",attrs:{span:24}},[s("a-button",{on:{click:t.closeAction}},[t._v(t._s(this.$t("label.cancel")))]),s("a-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.handleSubmit}},[t._v(t._s(this.$t("label.ok")))])],1)],1)],1)},a=[],o=(s("99af"),s("4160"),s("d3b7"),s("3ca3"),s("ddb0"),s("d0ff")),n=s("365c"),c=s("2ef0"),r=s.n(c),l={name:"AttachIso",props:{resource:{type:Object,required:!0}},inject:["parentFetchData"],data:function(){return{loading:!1,selectedIso:"",isos:[]}},beforeCreate:function(){this.form=this.$form.createForm(this)},mounted:function(){this.fetchData()},methods:{fetchData:function(){var t=this,e=["featured","community","selfexecutable"];this.loading=!0;var s=[];e.forEach((function(e){s.push(t.fetchIsos(e))})),Promise.all(s).then((function(){t.isos=r.a.uniqBy(t.isos,"id"),t.isos.length>0&&(t.selectedIso=t.isos[0].id)})).catch((function(t){console.log(t)})).finally((function(){t.loading=!1}))},fetchIsos:function(t){var e=this,s={listall:!0,zoneid:this.resource.zoneid,isready:!0,isofilter:t};return new Promise((function(t,i){Object(n["a"])("listIsos",s).then((function(s){var i,a=s.listisosresponse.iso||[];(i=e.isos).push.apply(i,Object(o["a"])(a)),t(s)})).catch((function(t){i(t)}))}))},closeAction:function(){this.$emit("close-action")},handleSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t,s){if(!t){var i={id:s.id,virtualmachineid:e.resource.id};e.loading=!0;var a=e.$t("label.action.attach.iso");Object(n["a"])("attachIso",i).then((function(t){var s=t.attachisoresponse.jobid;s&&e.$pollJob({jobId:s,successMethod:function(t){e.$store.dispatch("AddAsyncJob",{title:a,jobid:s,status:e.$t("progress")}),e.parentFetchData()},successMessage:"".concat(e.$t("label.action.attach.iso")," ").concat(e.$t("label.success")),loadingMessage:"".concat(a," ").concat(e.$t("label.in.progress")),catchMessage:e.$t("error.fetching.async.job.result")}),e.closeAction()})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1}))}}))}}},u=l,d=(s("81db"),s("2877")),f=Object(d["a"])(u,i,a,!1,null,"50ad374e",null);e["default"]=f.exports}}]);
//# sourceMappingURL=chunk-19015ce9.420c2e9b.js.map