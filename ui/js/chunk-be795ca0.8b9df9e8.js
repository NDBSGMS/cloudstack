(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-be795ca0"],{"2a11":function(e,t,a){"use strict";var n=a("ce30"),o=a.n(n);o.a},b82e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-spin",{attrs:{spinning:e.fetchLoading}},[a("a-button",{staticStyle:{width:"100%"},attrs:{disabled:!("dedicateGuestVlanRange"in e.$store.getters.apis),type:"dashed",icon:"plus"},on:{click:e.handleOpenModal}},[e._v(e._s(e.$t("label.dedicate.vlan.vni.range")))]),a("a-table",{staticStyle:{"overflow-y":"auto","margin-top":"20px"},attrs:{size:"small",loading:e.fetchLoading,columns:e.columns,dataSource:e.items,pagination:!1,rowKey:function(e){return e.id}},scopedSlots:e._u([{key:"actions",fn:function(t){return[a("a-popconfirm",{attrs:{title:e.$t("label.delete")+"?",okText:e.$t("label.yes"),cancelText:e.$t("label.no"),placement:"top"},on:{confirm:function(a){return e.handleDelete(t)}}},[a("a-button",{attrs:{disabled:!("releaseDedicatedGuestVlanRange"in e.$store.getters.apis),icon:"delete",type:"danger",shape:"circle"}})],1)]}}])}),a("a-pagination",{staticClass:"pagination",attrs:{size:"small",current:e.page,pageSize:e.pageSize,total:e.totalCount,showTotal:function(t){return e.$t("label.total")+" "+t+" "+e.$t("label.items")},pageSizeOptions:["10","20","40","80","100"],showSizeChanger:""},on:{change:e.handleChangePage,showSizeChange:e.handleChangePageSize},scopedSlots:e._u([{key:"buildOptionText",fn:function(t){return[a("span",[e._v(e._s(t.value)+" / "+e._s(e.$t("label.page")))])]}}])}),a("a-modal",{attrs:{title:e.$t("label.dedicate.vlan.vni.range"),maskClosable:!1},on:{ok:e.handleSubmit},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[a("a-spin",{attrs:{spinning:e.formLoading}},[a("a-form",{attrs:{form:e.form,layout:"vertical"},on:{submit:e.handleSubmit}},[a("a-form-item",{attrs:{label:e.$t("label.vlanrange")}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["range",{rules:[{required:!0,message:""+e.$t("label.required")}]}],expression:"['range', {\n              rules: [{ required: true, message: `${$t('label.required')}` }]\n            }]"}]})],1),a("a-form-item",{attrs:{label:e.$t("label.scope")}},[a("a-select",{attrs:{defaultValue:"account"},on:{change:e.handleScopeChange},model:{value:e.selectedScope,callback:function(t){e.selectedScope=t},expression:"selectedScope"}},[a("a-select-option",{attrs:{value:"account"}},[e._v(e._s(e.$t("label.account")))]),a("a-select-option",{attrs:{value:"project"}},[e._v(e._s(e.$t("label.project")))])],1)],1),a("a-form-item",{attrs:{label:e.$t("label.domain")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["domain",{rules:[{required:!0,message:""+e.$t("label.required")}]}],expression:"['domain', {\n              rules: [{ required: true, message: `${$t('label.required')}` }]\n            }]"}],on:{change:e.handleDomainChange}},e._l(e.domains,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1),"account"===e.selectedScope?a("a-form-item",{attrs:{label:e.$t("label.account")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["account",{rules:[{required:!0,message:""+e.$t("label.required")}]}],expression:"['account', {\n              rules: [{ required: true, message: `${$t('label.required')}` }]\n            }]"}]},e._l(e.accounts,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e(),"project"===e.selectedScope?a("a-form-item",{attrs:{label:e.$t("label.project")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["project",{rules:[{required:!0,message:""+e.$t("label.required")}]}],expression:"['project', {\n              rules: [{ required: true, message: `${$t('label.required')}` }]\n            }]"}]},e._l(e.projects,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e()],1)],1)],1)],1)},o=[],i=(a("99af"),a("b0c0"),a("d3b7"),a("365c")),s={name:"DedicatedVLANTab",props:{resource:{type:Object,required:!0},loading:{type:Boolean,default:!1}},inject:["parentStartLoading","parentFinishLoading"],data:function(){return{fetchLoading:!1,formLoading:!1,items:[],domains:[],accounts:[],projects:[],modal:!1,selectedScope:"account",totalCount:0,page:1,pageSize:10,columns:[{title:this.$t("label.vlanrange"),dataIndex:"guestvlanrange"},{title:this.$t("label.domain"),dataIndex:"domain"},{title:this.$t("label.account"),dataIndex:"account"},{title:this.$t("label.action"),scopedSlots:{customRender:"actions"}}]}},beforeCreate:function(){this.form=this.$form.createForm(this)},mounted:function(){this.fetchData()},watch:{loading:function(e,t){!e&&this.resource.id&&this.fetchData()}},methods:{fetchData:function(){var e=this;this.form.resetFields(),this.formLoading=!0,Object(i["a"])("listDedicatedGuestVlanRanges",{physicalnetworkid:this.resource.id,page:this.page,pageSize:this.pageSize}).then((function(t){e.items=t.listdedicatedguestvlanrangesresponse.dedicatedguestvlanrange||[],e.totalCount=t.listdedicatedguestvlanrangesresponse.count||0})).catch((function(t){e.$notification.error({message:"".concat(e.$t("label.error")," ").concat(t.response.status),description:t.response.data.errorresponse.errortext,duration:0})})).finally((function(){e.formLoading=!1,e.parentFinishLoading()}))},fetchDomains:function(){var e=this;Object(i["a"])("listDomains",{details:"min",listAll:!0}).then((function(t){e.domains=t.listdomainsresponse.domain||[],e.domains.length>0?(e.form.setFieldsValue({domain:e.domains[0].id}),e.fetchAccounts(e.form.getFieldValue("domain"))):e.form.setFieldsValue({domain:null}),e.formLoading=!1})).catch((function(t){e.$notifyError(t),e.formLoading=!1}))},fetchAccounts:function(e){var t=this;this.formLoading=!0,Object(i["a"])("listAccounts",{domainid:e,details:"min",listAll:!0}).then((function(e){t.accounts=e.listaccountsresponse.account?e.listaccountsresponse.account:[],t.accounts.length>0?t.form.setFieldsValue({account:t.accounts[0].name}):t.form.setFieldsValue({account:null}),t.formLoading=!1})).catch((function(e){t.$notifyError(e),t.formLoading=!1}))},fetchProjects:function(e){var t=this;this.formLoading=!0,Object(i["a"])("listProjects",{domainid:e,details:"min"}).then((function(e){t.projects=e.listprojectsresponse.project?e.listprojectsresponse.project:[],t.projects.length>0?t.form.setFieldsValue({project:t.projects[0].id}):t.form.setFieldsValue({project:null}),t.formLoading=!1})).catch((function(e){t.$notifyError(e),t.formLoading=!1}))},handleDelete:function(e){var t=this;this.parentStartLoading(),Object(i["a"])("releaseDedicatedGuestVlanRange",{id:e.id}).then((function(a){t.$store.dispatch("AddAsyncJob",{title:"".concat(t.$t("label.delete.dedicated.vlan.range")," ").concat(e.guestvlanrange," ").concat(t.$t("label.for")," ").concat(e.account),jobid:a.releasededicatedguestvlanrangeresponse.jobid,status:"progress"}),t.$pollJob({jobId:a.releasededicatedguestvlanrangeresponse.jobid,successMethod:function(){t.fetchData(),t.parentFinishLoading()},errorMessage:t.$t("label.deleting.failed"),errorMethod:function(){t.fetchData(),t.parentFinishLoading()},loadingMessage:"".concat(t.$t("label.deleting")," ").concat(e.id),catchMessage:t.$t("error.fetching.async.job.result"),catchMethod:function(){t.fetchData(),t.parentFinishLoading()}})})).catch((function(e){console.log(e),t.$message.error(t.$t("message.fail.to.delete")),t.fetchData(),t.parentFinishLoading()}))},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e){if(!e){t.formLoading=!0,t.parentStartLoading();var a=t.form.getFieldsValue();Object(i["a"])("dedicateGuestVlanRange",{physicalnetworkid:t.resource.id,vlanrange:a.range,domainid:a.domain,account:a.account,projectid:a.project}).then((function(e){t.modal=!1,t.fetchData()})).catch((function(e){t.$notifyError(e),t.modal=!1,t.fetchData()}))}}))},fetchBasedOnScope:function(e){"account"===e&&this.fetchAccounts(this.form.getFieldValue("domain")),"project"===e&&this.fetchProjects(this.form.getFieldValue("domain"))},handleDomainChange:function(){var e=this;setTimeout((function(){e.fetchBasedOnScope(e.selectedScope)}),100)},handleScopeChange:function(e){this.fetchBasedOnScope(e)},handleOpenModal:function(){this.modal=!0,this.formLoading=!0,this.fetchDomains()},handleChangePage:function(e,t){this.page=e,this.pageSize=t,this.fetchData()},handleChangePageSize:function(e,t){this.page=e,this.pageSize=t,this.fetchData()}}},c=s,r=(a("2a11"),a("2877")),l=Object(r["a"])(c,n,o,!1,null,"7134a903",null);t["default"]=l.exports},ce30:function(e,t,a){}}]);
//# sourceMappingURL=chunk-be795ca0.8b9df9e8.js.map