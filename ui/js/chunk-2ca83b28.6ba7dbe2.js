(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ca83b28"],{"2d2c":function(e,t,s){},"33c9":function(e,t,s){"use strict";var r=s("2d2c"),n=s.n(r);n.a},ff8b:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form-layout"},[s("a-spin",{attrs:{spinning:e.loading}},[s("a-alert",{attrs:{type:"warning"}},[s("span",{attrs:{slot:"message"},domProps:{innerHTML:e._s(e.$t("message.kubernetes.cluster.upgrade"))},slot:"message"})]),s("br"),s("a-form",{attrs:{form:e.form,layout:"vertical"},on:{submit:e.handleSubmit}},[s("a-form-item",[s("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.$t("label.kubernetesversionid"))+" "),s("a-tooltip",{attrs:{title:e.apiParams.kubernetesversionid.description}},[s("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),s("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["kubernetesversionid",{rules:[{required:!0}]}],expression:"['kubernetesversionid', {\n            rules: [{ required: true }]\n          }]"}],attrs:{id:"version-selection",showSearch:"",optionFilterProp:"children",filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:e.kubernetesVersionLoading,placeholder:e.apiParams.kubernetesversionid.description}},e._l(this.kubernetesVersions,(function(t,r){return s("a-select-option",{key:r},[e._v(" "+e._s(t.name||t.description)+" ")])})),1)],1),s("div",{staticClass:"action-button",attrs:{span:24}},[s("a-button",{on:{click:e.closeAction}},[e._v(e._s(this.$t("label.cancel")))]),s("a-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(this.$t("label.ok")))])],1)],1)],1)],1)},n=[],i=(s("99af"),s("4160"),s("b0c0"),s("b64b"),s("d3b7"),s("159b"),s("365c")),a={name:"UpgradeKubernetesCluster",props:{resource:{type:Object,required:!0}},data:function(){return{kubernetesVersions:[],kubernetesVersionLoading:!1,minCpu:2,minMemory:2048,loading:!1}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiConfig=this.$store.getters.apis.upgradeKubernetesCluster||{},this.apiParams={},this.apiConfig.params.forEach((function(t){e.apiParams[t.name]=t}))},created:function(){},mounted:function(){this.fetchData()},methods:{fetchData:function(){this.fetchKubernetesVersionData()},isValidValueForKey:function(e,t){return t in e&&null!=e[t]},arrayHasItems:function(e){return null!==e&&void 0!==e&&Array.isArray(e)&&e.length>0},isObjectEmpty:function(e){return!(null!==e&&void 0!==e&&Object.keys(e).length>0&&e.constructor===Object)},fetchKubernetesVersionData:function(){var e=this;this.kubernetesVersions=[];var t={};this.isObjectEmpty(this.resource)||(t.minimumkubernetesversionid=this.resource.kubernetesversionid),this.kubernetesVersionLoading=!0,Object(i["a"])("listKubernetesSupportedVersions",t).then((function(t){var s=t.listkubernetessupportedversionsresponse.kubernetessupportedversion;if(e.arrayHasItems(s)){for(var r=null,n=0;n<s.length;n++)if(s[n].id===e.resource.kubernetesversionid){r=s[n];break}for(var i=0;i<s.length;i++)s[i].id!==e.resource.kubernetesversionid&&(null==r||null!=r&&s[i].semanticversion!==r.semanticversion)&&"Enabled"===s[i].state&&"Ready"===s[i].isostate&&e.kubernetesVersions.push({id:s[i].id,description:s[i].name})}})).finally((function(){e.kubernetesVersionLoading=!1,e.arrayHasItems(e.kubernetesVersions)&&e.form.setFieldsValue({kubernetesversionid:0})}))},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,s){if(!e){t.loading=!0;var r={id:t.resource.id};t.isValidValueForKey(s,"kubernetesversionid")&&t.arrayHasItems(t.kubernetesVersions)&&(r.kubernetesversionid=t.kubernetesVersions[s.kubernetesversionid].id),Object(i["a"])("upgradeKubernetesCluster",r).then((function(e){t.$emit("refresh-data");var s=e.upgradekubernetesclusterresponse.jobid;t.$store.dispatch("AddAsyncJob",{title:t.$t("label.kubernetes.cluster.upgrade"),jobid:s,description:t.resource.name,status:"progress"}),t.$pollJob({jobId:s,loadingMessage:"".concat(t.$t("label.kubernetes.cluster.upgrade")," ").concat(t.resource.name," ").concat(t.$t("label.in.progress")),catchMessage:t.$t("error.fetching.async.job.result"),successMessage:"".concat(t.$t("message.success.upgrade.kubernetes")," ").concat(t.resource.name),successMethod:function(e){t.$emit("refresh-data")}}),t.$emit("refresh-data"),t.closeAction()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.loading=!1}))}}))},closeAction:function(){this.$emit("close-action")}}},o=a,u=(s("33c9"),s("2877")),c=Object(u["a"])(o,r,n,!1,null,"62c365dd",null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2ca83b28.6ba7dbe2.js.map