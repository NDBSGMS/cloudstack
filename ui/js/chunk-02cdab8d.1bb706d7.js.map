{"version":3,"sources":["webpack:///./src/views/compute/MigrateWizard.vue?c365","webpack:///./src/views/compute/MigrateWizard.vue?274b","webpack:///src/views/compute/MigrateWizard.vue","webpack:///./src/views/compute/MigrateWizard.vue?bde1","webpack:///./src/views/compute/MigrateWizard.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","attrs","$t","on","fetchData","model","value","callback","$$v","searchQuery","expression","loading","columns","hosts","record","id","scopedSlots","_u","key","fn","_v","_s","_f","memoryused","selectedHost","suitableformigration","$event","page","pageSize","totalCount","total","handleChangePage","handleChangePageSize","props","submitForm","staticRenderFns","name","resource","type","Object","required","data","mounted","methods","virtualmachineid","keyword","pagesize","b","a","hostid","title","jobid","response","migratevirtualmachineresponse","description","status","jobId","successMessage","successMethod","errorMessage","errorMethod","loadingMessage","catchMessage","catchMethod","message","duration","currentPage","filters","byteToGigabyte","Math","pow","toFixed","component"],"mappings":"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","file":"js/chunk-02cdab8d.1bb706d7.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MigrateWizard.vue?vue&type=style&index=0&id=ec69eef0&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MigrateWizard.vue?vue&type=style&index=0&id=ec69eef0&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"form\"},[_c('a-input-search',{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{\"placeholder\":_vm.$t('label.search')},on:{\"search\":_vm.fetchData},model:{value:(_vm.searchQuery),callback:function ($$v) {_vm.searchQuery=$$v},expression:\"searchQuery\"}}),_c('a-table',{staticStyle:{\"overflow-y\":\"auto\"},attrs:{\"size\":\"small\",\"loading\":_vm.loading,\"columns\":_vm.columns,\"dataSource\":_vm.hosts,\"pagination\":false,\"rowKey\":function (record) { return record.id; }},scopedSlots:_vm._u([{key:\"suitability\",fn:function(record){return _c('div',{},[(record.suitableformigration)?_c('a-icon',{staticClass:\"host-item__suitability-icon\",attrs:{\"type\":\"check-circle\",\"theme\":\"twoTone\",\"twoToneColor\":\"#52c41a\"}}):_c('a-icon',{staticClass:\"host-item__suitability-icon\",attrs:{\"type\":\"close-circle\",\"theme\":\"twoTone\",\"twoToneColor\":\"#f5222d\"}})],1)}},{key:\"memused\",fn:function(record){return _c('div',{},[_vm._v(\" \"+_vm._s(_vm._f(\"byteToGigabyte\")(record.memoryused))+\" GB \")])}},{key:\"select\",fn:function(record){return [_c('a-radio',{staticClass:\"host-item__radio\",attrs:{\"checked\":record.id === _vm.selectedHost.id,\"disabled\":!record.suitableformigration},on:{\"click\":function($event){_vm.selectedHost = record}}})]}}])}),_c('a-pagination',{staticClass:\"pagination\",attrs:{\"size\":\"small\",\"current\":_vm.page,\"pageSize\":_vm.pageSize,\"total\":_vm.totalCount,\"showTotal\":function (total) { return ((_vm.$t('label.total')) + \" \" + total + \" \" + (_vm.$t('label.items'))); },\"pageSizeOptions\":['10', '20', '40', '80', '100'],\"showSizeChanger\":\"\"},on:{\"change\":_vm.handleChangePage,\"showSizeChange\":_vm.handleChangePageSize},scopedSlots:_vm._u([{key:\"buildOptionText\",fn:function(props){return [_c('span',[_vm._v(_vm._s(props.value)+\" / \"+_vm._s(_vm.$t('label.page')))])]}}])}),_c('div',{staticStyle:{\"margin-top\":\"20px\",\"display\":\"flex\",\"justify-content\":\"flex-end\"}},[_c('a-button',{attrs:{\"type\":\"primary\",\"disabled\":!_vm.selectedHost.id},on:{\"click\":_vm.submitForm}},[_vm._v(\" \"+_vm._s(_vm.$t('label.ok'))+\" \")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <div class=\"form\">\n    <a-input-search\n      :placeholder=\"$t('label.search')\"\n      v-model=\"searchQuery\"\n      style=\"margin-bottom: 10px;\"\n      @search=\"fetchData\" />\n    <a-table\n      size=\"small\"\n      style=\"overflow-y: auto\"\n      :loading=\"loading\"\n      :columns=\"columns\"\n      :dataSource=\"hosts\"\n      :pagination=\"false\"\n      :rowKey=\"record => record.id\">\n      <div slot=\"suitability\" slot-scope=\"record\">\n        <a-icon\n          class=\"host-item__suitability-icon\"\n          type=\"check-circle\"\n          theme=\"twoTone\"\n          twoToneColor=\"#52c41a\"\n          v-if=\"record.suitableformigration\" />\n        <a-icon\n          class=\"host-item__suitability-icon\"\n          type=\"close-circle\"\n          theme=\"twoTone\"\n          twoToneColor=\"#f5222d\"\n          v-else />\n      </div>\n      <div slot=\"memused\" slot-scope=\"record\">\n        {{ record.memoryused | byteToGigabyte }} GB\n      </div>\n      <template slot=\"select\" slot-scope=\"record\">\n        <a-radio\n          class=\"host-item__radio\"\n          @click=\"selectedHost = record\"\n          :checked=\"record.id === selectedHost.id\"\n          :disabled=\"!record.suitableformigration\"></a-radio>\n      </template>\n    </a-table>\n    <a-pagination\n      class=\"pagination\"\n      size=\"small\"\n      :current=\"page\"\n      :pageSize=\"pageSize\"\n      :total=\"totalCount\"\n      :showTotal=\"total => `${$t('label.total')} ${total} ${$t('label.items')}`\"\n      :pageSizeOptions=\"['10', '20', '40', '80', '100']\"\n      @change=\"handleChangePage\"\n      @showSizeChange=\"handleChangePageSize\"\n      showSizeChanger>\n      <template slot=\"buildOptionText\" slot-scope=\"props\">\n        <span>{{ props.value }} / {{ $t('label.page') }}</span>\n      </template>\n    </a-pagination>\n\n    <div style=\"margin-top: 20px; display: flex; justify-content:flex-end;\">\n      <a-button type=\"primary\" :disabled=\"!selectedHost.id\" @click=\"submitForm\">\n        {{ $t('label.ok') }}\n      </a-button>\n    </div>\n  </div>\n\n</template>\n\n<script>\nimport { api } from '@/api'\n\nexport default {\n  name: 'VMMigrateWizard',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    }\n  },\n  data () {\n    return {\n      loading: true,\n      hosts: [],\n      selectedHost: {},\n      searchQuery: '',\n      totalCount: 0,\n      page: 1,\n      pageSize: 10,\n      columns: [\n        {\n          title: this.$t('label.name'),\n          dataIndex: 'name'\n        },\n        {\n          title: this.$t('label.suitability'),\n          scopedSlots: { customRender: 'suitability' }\n        },\n        {\n          title: this.$t('label.cpuused'),\n          dataIndex: 'cpuused'\n        },\n        {\n          title: this.$t('label.memused'),\n          scopedSlots: { customRender: 'memused' }\n        },\n        {\n          title: this.$t('label.select'),\n          scopedSlots: { customRender: 'select' }\n        }\n      ]\n    }\n  },\n  mounted () {\n    this.fetchData()\n  },\n  methods: {\n    fetchData () {\n      this.loading = true\n      api('findHostsForMigration', {\n        virtualmachineid: this.resource.id,\n        keyword: this.searchQuery,\n        page: this.page,\n        pagesize: this.pageSize\n      }).then(response => {\n        this.hosts = response.findhostsformigrationresponse.host || []\n        this.hosts.sort((a, b) => {\n          return b.suitableformigration - a.suitableformigration\n        })\n        this.totalCount = response.findhostsformigrationresponse.count\n      }).catch(error => {\n        this.$message.error(`${this.$t('message.load.host.failed')}: ${error}`)\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    submitForm () {\n      this.loading = true\n      api(this.selectedHost.requiresStorageMotion ? 'migrateVirtualMachineWithVolume' : 'migrateVirtualMachine', {\n        hostid: this.selectedHost.id,\n        virtualmachineid: this.resource.id\n      }).then(response => {\n        this.$store.dispatch('AddAsyncJob', {\n          title: `${this.$t('label.migrating')} ${this.resource.name}`,\n          jobid: response.migratevirtualmachineresponse.jobid,\n          description: this.resource.name,\n          status: 'progress'\n        })\n        this.$pollJob({\n          jobId: response.migratevirtualmachineresponse.jobid,\n          successMessage: `${this.$t('message.success.migrating')} ${this.resource.name}`,\n          successMethod: () => {\n            this.$parent.$parent.close()\n          },\n          errorMessage: this.$t('message.migrating.failed'),\n          errorMethod: () => {\n            this.$parent.$parent.close()\n          },\n          loadingMessage: `${this.$t('message.migrating.processing')} ${this.resource.name}`,\n          catchMessage: this.$t('error.fetching.async.job.result'),\n          catchMethod: () => {\n            this.$parent.$parent.close()\n          }\n        })\n        this.$parent.$parent.close()\n      }).catch(error => {\n        this.$notification.error({\n          message: this.$t('message.request.failed'),\n          description: (error.response && error.response.headers && error.response.headers['x-description']) || error.message,\n          duration: 0\n        })\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    handleChangePage (page, pageSize) {\n      this.page = page\n      this.pageSize = pageSize\n      this.fetchData()\n    },\n    handleChangePageSize (currentPage, pageSize) {\n      this.page = currentPage\n      this.pageSize = pageSize\n      this.fetchData()\n    }\n  },\n  filters: {\n    byteToGigabyte: value => {\n      return (value / Math.pow(10, 9)).toFixed(2)\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n\n  .form {\n    width: 85vw;\n    @media (min-width: 800px) {\n      width: 750px;\n    }\n  }\n\n  .host-item {\n    padding-right: 20px;\n    padding-bottom: 0;\n    padding-left: 20px;\n\n    &--selected {\n      background-color: #e6f7ff;\n    }\n\n    &__row {\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n\n      @media (min-width: 760px) {\n        flex-direction: row;\n      }\n    }\n\n    &__value {\n      display: flex;\n      flex-direction: column;\n      align-items: flex-start;\n      flex: 1;\n      margin-bottom: 10px;\n\n      &--small {\n\n        @media (min-width: 760px) {\n          flex: none;\n          margin-right: 40px;\n          margin-left: 40px;\n        }\n      }\n    }\n\n    &__title {\n      font-weight: bold;\n    }\n\n    &__suitability-icon {\n      margin-top: 5px;\n    }\n\n    &__radio {\n      display: flex;\n      align-items: center;\n    }\n\n  }\n\n  .pagination {\n    margin-top: 20px;\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MigrateWizard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MigrateWizard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MigrateWizard.vue?vue&type=template&id=ec69eef0&scoped=true&\"\nimport script from \"./MigrateWizard.vue?vue&type=script&lang=js&\"\nexport * from \"./MigrateWizard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MigrateWizard.vue?vue&type=style&index=0&id=ec69eef0&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ec69eef0\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}