(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0746a882"],{a49b:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-layout"},[a("a-alert",{attrs:{type:"warning"},domProps:{innerHTML:e._s(e.$t("message.action.destroy.instance"))}}),a("br"),a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",{attrs:{form:e.form,layout:"vertical"},on:{submit:e.handleSubmit}},["Admin"===e.$store.getters.userInfo.roletype||e.$store.getters.features.allowuserexpungerecovervm?a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.$t("label.expunge"))+" "),a("a-tooltip",{attrs:{placement:"bottom",title:e.apiParams.expunge.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["expunge"],expression:"['expunge']"}],attrs:{"auto-focus":!0}})],1):e._e(),e.volumes.length>0?a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.$t("label.delete.volumes"))+" "),a("a-tooltip",{attrs:{placement:"bottom",title:e.apiParams.volumeids.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["volumeids"],expression:"['volumeids']"}],attrs:{placeholder:e.$t("label.delete.volumes"),mode:"multiple",loading:e.loading}},e._l(e.volumes,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1)],1):a("p",{domProps:{innerHTML:e._s(e.$t("label.volume.empty"))}}),a("div",{staticClass:"action-button",attrs:{span:24}},[a("a-button",{on:{click:e.closeAction}},[e._v(e._s(this.$t("label.cancel")))]),a("a-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(this.$t("label.ok")))])],1)],1)],1)],1)},s=[],i=(a("99af"),a("4160"),a("caad"),a("a15b"),a("b0c0"),a("d3b7"),a("2532"),a("159b"),a("365c")),n={name:"DestroyVM",props:{resource:{type:Object,required:!0}},inject:["parentFetchData"],data:function(){return{volumes:[],loading:!1}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiParams={};var t=this.$store.getters.apis.destroyVirtualMachine||{};t.params.forEach((function(t){e.apiParams[t.name]=t}))},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.volumes=[],this.loading=!0,Object(i["a"])("listVolumes",{virtualMachineId:this.resource.id,type:"DATADISK",details:"min"}).then((function(t){e.volumes=t.listvolumesresponse.volume||[]})).finally((function(){e.loading=!1}))},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,a){if(!e){t.loading=!0;var o={id:t.resource.id};a.volumeids&&(o.volumeids=a.volumeids.join(",")),a.expunge&&(o.expunge=a.expunge),Object(i["a"])("destroyVirtualMachine",o).then((function(e){var o=e.destroyvirtualmachineresponse.jobid;t.$store.dispatch("AddAsyncJob",{title:t.$t("label.action.destroy.instance"),jobid:o,description:t.resource.name,status:"progress"}),t.$pollJob({jobId:o,loadingMessage:"".concat(t.$t("message.deleting.vm")," ").concat(t.resource.name),catchMessage:t.$t("error.fetching.async.job.result"),successMessage:"".concat(t.$t("message.success.delete.vm")," ").concat(t.resource.name),successMethod:function(){t.$route.path.includes("/vm/")&&a.expunge?t.$router.go(-1):t.parentFetchData()},action:{api:"destroyVirtualMachine"}}),t.closeAction()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.loading=!1}))}}))},closeAction:function(){this.$emit("close-action")}}},r=n,c=(a("d0ec"),a("2877")),l=Object(c["a"])(r,o,s,!1,null,"43f88e2b",null);t["default"]=l.exports},d0ec:function(e,t,a){"use strict";var o=a("dc30"),s=a.n(o);s.a},dc30:function(e,t,a){}}]);
//# sourceMappingURL=chunk-0746a882.5bec43b1.js.map