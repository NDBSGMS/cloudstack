{"version":3,"sources":["webpack:///./src/views/compute/DestroyVM.vue?a5c8","webpack:///src/views/compute/DestroyVM.vue","webpack:///./src/views/compute/DestroyVM.vue?2dc8","webpack:///./src/views/compute/DestroyVM.vue","webpack:///./src/views/compute/DestroyVM.vue?1a26"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","domProps","_s","$t","loading","form","on","handleSubmit","$store","getters","userInfo","roletype","features","allowuserexpungerecovervm","slot","_v","apiParams","expunge","description","staticStyle","directives","name","rawName","value","expression","_e","volumes","length","volumeids","_l","volume","key","id","closeAction","staticRenderFns","props","resource","type","Object","required","inject","data","beforeCreate","$form","createForm","apiConfig","apis","destroyVirtualMachine","params","forEach","mounted","fetchData","methods","virtualMachineId","details","e","preventDefault","validateFields","err","values","join","title","jobid","jobId","status","loadingMessage","catchMessage","successMessage","successMethod","action","api","$emit","component"],"mappings":"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","file":"js/chunk-0746a882.5bec43b1.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"form-layout\"},[_c('a-alert',{attrs:{\"type\":\"warning\"},domProps:{\"innerHTML\":_vm._s(_vm.$t('message.action.destroy.instance'))}}),_c('br'),_c('a-spin',{attrs:{\"spinning\":_vm.loading}},[_c('a-form',{attrs:{\"form\":_vm.form,\"layout\":\"vertical\"},on:{\"submit\":_vm.handleSubmit}},[(_vm.$store.getters.userInfo.roletype === 'Admin' || _vm.$store.getters.features.allowuserexpungerecovervm)?_c('a-form-item',[_c('span',{attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\" \"+_vm._s(_vm.$t('label.expunge'))+\" \"),_c('a-tooltip',{attrs:{\"placement\":\"bottom\",\"title\":_vm.apiParams.expunge.description}},[_c('a-icon',{staticStyle:{\"color\":\"rgba(0,0,0,.45)\"},attrs:{\"type\":\"info-circle\"}})],1)],1),_c('a-switch',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['expunge']),expression:\"['expunge']\"}],attrs:{\"auto-focus\":true}})],1):_vm._e(),(_vm.volumes.length > 0)?_c('a-form-item',[_c('span',{attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\" \"+_vm._s(_vm.$t('label.delete.volumes'))+\" \"),_c('a-tooltip',{attrs:{\"placement\":\"bottom\",\"title\":_vm.apiParams.volumeids.description}},[_c('a-icon',{staticStyle:{\"color\":\"rgba(0,0,0,.45)\"},attrs:{\"type\":\"info-circle\"}})],1)],1),_c('a-select',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['volumeids']),expression:\"['volumeids']\"}],attrs:{\"placeholder\":_vm.$t('label.delete.volumes'),\"mode\":\"multiple\",\"loading\":_vm.loading}},_vm._l((_vm.volumes),function(volume){return _c('a-select-option',{key:volume.id},[_vm._v(\" \"+_vm._s(volume.name)+\" \")])}),1)],1):_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.$t('label.volume.empty'))}}),_c('div',{staticClass:\"action-button\",attrs:{\"span\":24}},[_c('a-button',{on:{\"click\":_vm.closeAction}},[_vm._v(_vm._s(this.$t('label.cancel')))]),_c('a-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},on:{\"click\":_vm.handleSubmit}},[_vm._v(_vm._s(this.$t('label.ok')))])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <div class=\"form-layout\">\n    <a-alert type=\"warning\" v-html=\"$t('message.action.destroy.instance')\" /><br/>\n    <a-spin :spinning=\"loading\">\n      <a-form\n        :form=\"form\"\n        @submit=\"handleSubmit\"\n        layout=\"vertical\">\n        <a-form-item v-if=\"$store.getters.userInfo.roletype === 'Admin' || $store.getters.features.allowuserexpungerecovervm\">\n          <span slot=\"label\">\n            {{ $t('label.expunge') }}\n            <a-tooltip placement=\"bottom\" :title=\"apiParams.expunge.description\">\n              <a-icon type=\"info-circle\" style=\"color: rgba(0,0,0,.45)\" />\n            </a-tooltip>\n          </span>\n          <a-switch v-decorator=\"['expunge']\" :auto-focus=\"true\" />\n        </a-form-item>\n\n        <a-form-item v-if=\"volumes.length > 0\">\n          <span slot=\"label\">\n            {{ $t('label.delete.volumes') }}\n            <a-tooltip placement=\"bottom\" :title=\"apiParams.volumeids.description\">\n              <a-icon type=\"info-circle\" style=\"color: rgba(0,0,0,.45)\" />\n            </a-tooltip>\n          </span>\n          <a-select\n            v-decorator=\"['volumeids']\"\n            :placeholder=\"$t('label.delete.volumes')\"\n            mode=\"multiple\"\n            :loading=\"loading\">\n            <a-select-option v-for=\"volume in volumes\" :key=\"volume.id\">\n              {{ volume.name }}\n            </a-select-option>\n          </a-select>\n        </a-form-item>\n        <p v-else v-html=\"$t('label.volume.empty')\" />\n\n        <div :span=\"24\" class=\"action-button\">\n          <a-button @click=\"closeAction\">{{ this.$t('label.cancel') }}</a-button>\n          <a-button :loading=\"loading\" type=\"primary\" @click=\"handleSubmit\">{{ this.$t('label.ok') }}</a-button>\n        </div>\n      </a-form>\n    </a-spin>\n  </div>\n</template>\n\n<script>\nimport { api } from '@/api'\n\nexport default {\n  name: 'DestroyVM',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    }\n  },\n  inject: ['parentFetchData'],\n  data () {\n    return {\n      volumes: [],\n      loading: false\n    }\n  },\n  beforeCreate () {\n    this.form = this.$form.createForm(this)\n    this.apiParams = {}\n    var apiConfig = this.$store.getters.apis.destroyVirtualMachine || {}\n    apiConfig.params.forEach(param => {\n      this.apiParams[param.name] = param\n    })\n  },\n  mounted () {\n    this.fetchData()\n  },\n  methods: {\n    fetchData () {\n      this.volumes = []\n      this.loading = true\n      api('listVolumes', {\n        virtualMachineId: this.resource.id,\n        type: 'DATADISK',\n        details: 'min'\n      }).then(json => {\n        this.volumes = json.listvolumesresponse.volume || []\n      }).finally(() => {\n        this.loading = false\n      })\n    },\n    handleSubmit (e) {\n      e.preventDefault()\n      this.form.validateFields((err, values) => {\n        if (err) {\n          return\n        }\n        this.loading = true\n\n        const params = {\n          id: this.resource.id\n        }\n        if (values.volumeids) {\n          params.volumeids = values.volumeids.join(',')\n        }\n        if (values.expunge) {\n          params.expunge = values.expunge\n        }\n\n        api('destroyVirtualMachine', params).then(json => {\n          const jobId = json.destroyvirtualmachineresponse.jobid\n          this.$store.dispatch('AddAsyncJob', {\n            title: this.$t('label.action.destroy.instance'),\n            jobid: jobId,\n            description: this.resource.name,\n            status: 'progress'\n          })\n          this.$pollJob({\n            jobId,\n            loadingMessage: `${this.$t('message.deleting.vm')} ${this.resource.name}`,\n            catchMessage: this.$t('error.fetching.async.job.result'),\n            successMessage: `${this.$t('message.success.delete.vm')} ${this.resource.name}`,\n            successMethod: () => {\n              if (this.$route.path.includes('/vm/') && values.expunge) {\n                this.$router.go(-1)\n              } else {\n                this.parentFetchData()\n              }\n            },\n            action: {\n              api: 'destroyVirtualMachine'\n            }\n          })\n          this.closeAction()\n        }).catch(error => {\n          this.$notifyError(error)\n        }).finally(() => {\n          this.loading = false\n        })\n      })\n    },\n    closeAction () {\n      this.$emit('close-action')\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n  .form-layout {\n    width: 60vw;\n\n    @media (min-width: 500px) {\n      width: 450px;\n    }\n  }\n\n  .action-button {\n    text-align: right;\n\n    button {\n      margin-right: 5px;\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DestroyVM.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DestroyVM.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DestroyVM.vue?vue&type=template&id=43f88e2b&scoped=true&\"\nimport script from \"./DestroyVM.vue?vue&type=script&lang=js&\"\nexport * from \"./DestroyVM.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DestroyVM.vue?vue&type=style&index=0&id=43f88e2b&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"43f88e2b\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DestroyVM.vue?vue&type=style&index=0&id=43f88e2b&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DestroyVM.vue?vue&type=style&index=0&id=43f88e2b&scoped=true&lang=less&\""],"sourceRoot":""}