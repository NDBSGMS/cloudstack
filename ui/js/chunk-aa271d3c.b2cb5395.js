(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aa271d3c"],{dca3:function(e,i,t){},e549:function(e,i,t){"use strict";t.r(i);var r=function(){var e=this,i=this,t=i.$createElement,r=i._self._c||t;return r("div",{staticClass:"form-layout"},[r("a-spin",{attrs:{spinning:i.loading}},[r("a-alert",{attrs:{type:"warning"}},[r("span",{attrs:{slot:"message"},domProps:{innerHTML:i._s(i.$t("message.kubernetes.cluster.scale"))},slot:"message"})]),r("br"),r("a-form",{attrs:{form:i.form,layout:"vertical"},on:{submit:i.handleSubmit}},[r("a-form-item",[r("span",{attrs:{slot:"label"},slot:"label"},[i._v(" "+i._s(i.$t("label.cks.cluster.size"))+" "),r("a-tooltip",{attrs:{title:i.apiParams.size.description}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["size",{initialValue:i.originalSize,rules:[{validator:function(i,t,r){t&&(isNaN(t)||t<=0)&&r(e.$t("message.error.number")),r()}}]}],expression:"['size', {\n            initialValue: originalSize,\n            rules: [{\n              validator: (rule, value, callback) => {\n                if (value && (isNaN(value) || value <= 0)) {\n                  callback(this.$t('message.error.number'))\n                }\n                callback()\n              }\n            }]\n          }]"}],attrs:{placeholder:i.apiParams.size.description}})],1),r("a-form-item",[r("span",{attrs:{slot:"label"},slot:"label"},[i._v(" "+i._s(i.$t("label.serviceofferingid"))+" "),r("a-tooltip",{attrs:{title:i.apiParams.serviceofferingid.description}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["serviceofferingid",{}],expression:"['serviceofferingid', {}]"}],attrs:{id:"offering-selection",showSearch:"",optionFilterProp:"children",filterOption:function(e,i){return i.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},loading:i.serviceOfferingLoading,placeholder:i.apiParams.serviceofferingid.description}},i._l(this.serviceOfferings,(function(e,t){return r("a-select-option",{key:t},[i._v(" "+i._s(e.name||e.description)+" ")])})),1)],1),r("div",{staticClass:"action-button",attrs:{span:24}},[r("a-button",{on:{click:i.closeAction}},[i._v(i._s(this.$t("label.cancel")))]),r("a-button",{attrs:{loading:i.loading,type:"primary"},on:{click:i.handleSubmit}},[i._v(i._s(this.$t("label.ok")))])],1)],1)],1)],1)},s=[],n=(t("99af"),t("4160"),t("b0c0"),t("b64b"),t("d3b7"),t("159b"),t("365c")),a={name:"ScaleKubernetesCluster",props:{resource:{type:Object,required:!0}},data:function(){return{serviceOfferings:[],serviceOfferingLoading:!1,minCpu:2,minMemory:2048,loading:!1}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiConfig=this.$store.getters.apis.scaleKubernetesCluster||{},this.apiParams={},this.apiConfig.params.forEach((function(i){e.apiParams[i.name]=i}))},created:function(){this.originalSize=this.isObjectEmpty(this.resource)?1:this.resource.size},mounted:function(){this.fetchData()},methods:{fetchData:function(){this.fetchKubernetesVersionData()},isValidValueForKey:function(e,i){return i in e&&null!=e[i]},arrayHasItems:function(e){return null!==e&&void 0!==e&&Array.isArray(e)&&e.length>0},isObjectEmpty:function(e){return!(null!==e&&void 0!==e&&Object.keys(e).length>0&&e.constructor===Object)},fetchKubernetesVersionData:function(){var e=this,i={};this.isObjectEmpty(this.resource)||(i.id=this.resource.kubernetesversionid),Object(n["a"])("listKubernetesSupportedVersions",i).then((function(i){var t=i.listkubernetessupportedversionsresponse.kubernetessupportedversion;e.arrayHasItems(t)&&!e.isObjectEmpty(t[0])&&(e.minCpu=t[0].mincpunumber,e.minMemory=t[0].minmemory)})).finally((function(){e.fetchServiceOfferingData()}))},fetchServiceOfferingData:function(){var e=this;this.serviceOfferings=[];var i={};this.serviceOfferingLoading=!0,Object(n["a"])("listServiceOfferings",i).then((function(i){var t=i.listserviceofferingsresponse.serviceoffering;if(null!=t)for(var r=0;r<t.length;r++)!1===t[r].iscustomized&&t[r].cpunumber>=e.minCpu&&t[r].memory>=e.minMemory&&e.serviceOfferings.push(t[r])})).finally((function(){if(e.serviceOfferingLoading=!1,e.arrayHasItems(e.serviceOfferings))for(var i=0;i<e.serviceOfferings.length;i++)if(e.serviceOfferings[i].id===e.resource.serviceofferingid){e.form.setFieldsValue({serviceofferingid:i});break}}))},handleSubmit:function(e){var i=this;e.preventDefault(),this.form.validateFields((function(e,t){if(!e){i.loading=!0;var r={id:i.resource.id};i.isValidValueForKey(t,"size")&&t.size>0&&(r.size=t.size),i.isValidValueForKey(t,"serviceofferingid")&&i.arrayHasItems(i.serviceOfferings)&&(r.serviceofferingid=i.serviceOfferings[t.serviceofferingid].id),Object(n["a"])("scaleKubernetesCluster",r).then((function(e){var t=e.scalekubernetesclusterresponse.jobid;i.$store.dispatch("AddAsyncJob",{title:i.$t("label.kubernetes.cluster.scale"),jobid:t,description:i.resource.name,status:"progress"}),i.$pollJob({jobId:t,loadingMessage:"".concat(i.$t("label.kubernetes.cluster.scale")," ").concat(i.resource.name," ").concat(i.$t("label.in.progress")),catchMessage:i.$t("error.fetching.async.job.result"),successMessage:"".concat(i.$t("message.success.scale.kubernetes")," ").concat(i.resource.name),successMethod:function(e){i.$emit("refresh-data")}}),i.closeAction(),i.$emit("refresh-data")})).catch((function(e){i.$notifyError(e)})).finally((function(){i.loading=!1}))}}))},closeAction:function(){this.$emit("close-action")}}},o=a,c=(t("f63f"),t("2877")),l=Object(c["a"])(o,r,s,!1,null,"3ad8729e",null);i["default"]=l.exports},f63f:function(e,i,t){"use strict";var r=t("dca3"),s=t.n(r);s.a}}]);
//# sourceMappingURL=chunk-aa271d3c.b2cb5395.js.map