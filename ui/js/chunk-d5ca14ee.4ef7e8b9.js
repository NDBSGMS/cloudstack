(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d5ca14ee"],{"0804":function(e,t,a){},4491:function(e,t,a){"use strict";var n=a("cdee"),i=a.n(n);i.a},5838:function(e,t,a){"use strict";var n=a("d026"),i=a.n(n);i.a},ada4:function(e,t,a){"use strict";var n=a("0804"),i=a.n(n);i.a},cdee:function(e,t,a){},d026:function(e,t,a){},d8cd:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"snapshot-layout"},[a("a-tabs",{attrs:{defaultActiveKey:"1",animated:!1}},[a("a-tab-pane",{key:"1",attrs:{tab:e.$t("label.schedule")}},[a("FormSchedule",{attrs:{loading:e.loading,resource:e.resource,dataSource:e.dataSource},on:{"close-action":e.closeAction,refresh:e.handleRefresh}})],1),a("a-tab-pane",{key:"2",attrs:{tab:e.$t("label.scheduled.snapshots")}},[a("ScheduledSnapshots",{attrs:{loading:e.loading,resource:e.resource,dataSource:e.dataSource},on:{refresh:e.handleRefresh,"close-action":e.closeAction}})],1)],1)],1)},i=[],s=a("365c"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-spin",{attrs:{spinning:e.loading}},[a("div",{staticClass:"form-layout"},[a("label",[e._v(" "+e._s(e.$t("label.header.volume.snapshot"))+" ")]),a("div",{staticClass:"form"},[a("a-form",{attrs:{form:e.form,layout:"vertical"},on:{submit:e.handleSubmit}},[a("a-row",{attrs:{gutter:12}},[a("a-col",{attrs:{md:24,lg:24}},[a("a-form-item",{attrs:{label:e.$t("label.intervaltype")}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["intervaltype",{initialValue:e.intervalType}],expression:"['intervaltype', {\n                  initialValue: intervalType\n                }]"}],attrs:{buttonStyle:"solid"},on:{change:e.handleChangeIntervalType}},[a("a-radio-button",{attrs:{value:"hourly",disabled:e.handleVisibleInterval(0)}},[e._v(" "+e._s(e.$t("label.hourly"))+" ")]),a("a-radio-button",{attrs:{value:"daily",disabled:e.handleVisibleInterval(1)}},[e._v(" "+e._s(e.$t("label.daily"))+" ")]),a("a-radio-button",{attrs:{value:"weekly",disabled:e.handleVisibleInterval(2)}},[e._v(" "+e._s(e.$t("label.weekly"))+" ")]),a("a-radio-button",{attrs:{value:"monthly",disabled:e.handleVisibleInterval(3)}},[e._v(" "+e._s(e.$t("label.monthly"))+" ")])],1)],1)],1),"hourly"===e.intervalType?a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{attrs:{label:e.$t("label.time")}},[a("a-tooltip",{attrs:{placement:"right",title:e.$t("label.minute.past.hour")}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["time",{rules:[{required:!0,message:""+this.$t("message.error.required.input")}]}],expression:"['time', {\n                    rules: [{required: true, message: `${this.$t('message.error.required.input')}`}]\n                  }]"}],staticStyle:{width:"100%"},attrs:{min:1,max:59}})],1)],1)],1):e._e(),["daily","weekly","monthly"].includes(e.intervalType)?a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{staticClass:"custom-time-select",attrs:{label:e.$t("label.time")}},[a("a-time-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["timeSelect",{rules:[{type:"object",required:!0,message:e.$t("message.error.time")}]}],expression:"['timeSelect', {\n                  rules: [{\n                    type: 'object',\n                    required: true,\n                    message: $t('message.error.time')\n                  }]\n                }]"}],attrs:{use12Hours:"",format:"h:mm A"}})],1)],1):e._e(),"weekly"===e.intervalType?a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{attrs:{label:e.$t("label.day.of.week")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["day-of-week",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['day-of-week', {\n                  rules: [{\n                    required: true,\n                    message: `${this.$t('message.error.select')}`\n                  }]\n                }]"}]},e._l(e.dayOfWeek,(function(t,n){return a("a-select-option",{key:n},[e._v(" "+e._s(t.name||t.description)+" ")])})),1)],1)],1):e._e(),"monthly"===e.intervalType?a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{attrs:{label:e.$t("label.day.of.month")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["day-of-month",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['day-of-month', {\n                  rules: [{\n                    required: true,\n                    message: `${this.$t('message.error.select')}`\n                  }]\n                }]"}]},e._l(e.dayOfMonth,(function(t){return a("a-select-option",{key:t.name},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1):e._e(),a("a-col",{attrs:{md:24,lg:12}},[a("a-form-item",{attrs:{label:e.$t("label.keep")}},[a("a-tooltip",{attrs:{placement:"right",title:e.$t("label.snapshots")}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["maxsnaps",{rules:[{required:!0,message:e.$t("message.error.required.input")}]}],expression:"['maxsnaps', {\n                    rules: [{ required: true, message: $t('message.error.required.input')}]\n                  }]"}],staticStyle:{width:"100%"},attrs:{min:1,max:8}})],1)],1)],1),a("a-col",{attrs:{md:24,lg:24}},[a("a-form-item",{attrs:{label:e.$t("label.timezone")}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["timezone",{rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['timezone', {\n                  rules: [{\n                    required: true,\n                    message: `${this.$t('message.error.select')}`\n                  }]\n                }]"}],attrs:{showSearch:"",loading:e.fetching}},e._l(e.timeZoneMap,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name||t.description)+" ")])})),1)],1)],1)],1),a("a-divider"),a("div",{staticClass:"tagsTitle"},[e._v(e._s(e.$t("label.tags")))]),a("div",[e._l(e.tags,(function(t,n){return[a("a-tag",{key:n,attrs:{closable:"deleteTags"in e.$store.getters.apis,afterClose:function(){return e.handleDeleteTag(t)}}},[e._v(" "+e._s(t.key)+" = "+e._s(t.value)+" ")])]})),e.inputVisible?a("div",[a("a-input-group",{attrs:{type:"text",size:"small",compact:""},on:{blur:e.handleInputConfirm,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}}},[a("a-input",{ref:"input",staticStyle:{width:"100px","text-align":"center"},attrs:{value:e.inputKey,placeholder:e.$t("label.key")},on:{change:e.handleKeyChange}}),a("a-input",{staticStyle:{width:"30px","border-left":"0","pointer-events":"none",backgroundColor:"#fff"},attrs:{placeholder:"=",disabled:""}}),a("a-input",{staticStyle:{width:"100px","text-align":"center","border-left":"0"},attrs:{value:e.inputValue,placeholder:e.$t("label.value")},on:{change:e.handleValueChange}}),a("a-button",{attrs:{shape:"circle",size:"small"},on:{click:e.handleInputConfirm}},[a("a-icon",{attrs:{type:"check"}})],1),a("a-button",{attrs:{shape:"circle",size:"small"},on:{click:function(t){e.inputVisible=!1}}},[a("a-icon",{attrs:{type:"close"}})],1)],1)],1):a("a-tag",{staticStyle:{background:"#fff",borderStyle:"dashed"},on:{click:e.showInput}},[a("a-icon",{attrs:{type:"plus"}}),e._v(" "+e._s(e.$t("label.new.tag"))+" ")],1)],2),a("div",{staticClass:"action-button",attrs:{span:24}},[a("a-button",{attrs:{loading:e.actionLoading},on:{click:e.closeAction}},[e._v(" "+e._s(this.$t("label.cancel"))+" ")]),e.handleShowButton()?a("a-button",{attrs:{loading:e.actionLoading,type:"primary"},on:{click:e.handleSubmit}},[e._v(" "+e._s(this.$t("label.ok"))+" ")]):e._e()],1)],1)],1)])])},l=[],o=(a("4de4"),a("a15b"),a("d3b7"),a("e95a3")),c=a("b047"),u=a.n(c),d={name:"FormSchedule",props:{loading:{type:Boolean,default:!1},dataSource:{type:Array,required:!0},resource:{type:Object,required:!0}},data:function(){return this.fetchTimeZone=u()(this.fetchTimeZone,800),{actionLoading:!1,volumeId:"",inputKey:"",inputVisible:"",inputValue:"",intervalType:"hourly",intervalValue:0,tags:[],dayOfWeek:[],dayOfMonth:[],timeZoneMap:[],fetching:!1,listDayOfWeek:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]}},beforeCreate:function(){this.form=this.$form.createForm(this)},mounted:function(){this.volumeId=this.resource.id,this.fetchTimeZone()},methods:{fetchTimeZone:function(e){var t=this;this.timeZoneMap=[],this.fetching=!0,Object(o["a"])(e).then((function(e){t.timeZoneMap=e,t.fetching=!1}))},fetchDayOfWeek:function(){for(var e in this.dayOfWeek=[],this.listDayOfWeek){var t=this.listDayOfWeek[e];this.dayOfWeek.push({id:t,name:this.$t("label."+t)})}},fetchDayOfMonth:function(){this.dayOfMonth=[];for(var e=28,t=1;t<=e;t++)this.dayOfMonth.push({id:t,name:t})},handleChangeIntervalType:function(e){switch(this.intervalType=e.target.value,this.intervalType){case"hourly":this.intervalValue=0;break;case"daily":this.intervalValue=1;break;case"weekly":this.intervalValue=2,this.fetchDayOfWeek();break;case"monthly":this.intervalValue=3,this.fetchDayOfMonth();break}},handleVisibleInterval:function(e){if(0===this.dataSource.length)return!1;var t=this.dataSource.filter((function(t){return t.intervaltype===e}));return!!(t&&t.length>0)},handleShowButton:function(){var e=this;if(0===this.dataSource.length)return!0;var t=this.dataSource.filter((function(t){return t.intervaltype===e.intervalValue}));return!(t&&t.length>0)},handleKeyChange:function(e){this.inputKey=e.target.value},handleValueChange:function(e){this.inputValue=e.target.value},handleInputConfirm:function(){this.tags.push({key:this.inputKey,value:this.inputValue}),this.inputVisible=!1,this.inputKey="",this.inputValue=""},handleDeleteTag:function(e){},handleSubmit:function(e){var t=this;this.form.validateFields((function(e,a){if(!e){var n={};switch(n.volumeid=t.volumeId,n.intervaltype=a.intervaltype,n.timezone=a.timezone,n.maxsnaps=a.maxsnaps,a.intervaltype){case"hourly":n.schedule=a.time;break;case"daily":n.schedule=a.timeSelect.format("mm:HH");break;case"weekly":n.schedule=[a.timeSelect.format("mm:HH"),a["day-of-week"]+1].join(":");break;case"monthly":n.schedule=[a.timeSelect.format("mm:HH"),a["day-of-month"]].join(":");break}for(var i=0;i<t.tags.length;i++){var r={},l=t.tags[i];r["tags["+i+"].key"]=l.key,r["tags["+i+"].value"]=l.value,n=Object.assign({},n,r)}t.actionLoading=!0,Object(s["a"])("createSnapshotPolicy",n).then((function(e){t.$emit("refresh"),t.$notification.success({message:t.$t("label.action.recurring.snapshot"),description:t.$t("message.success.recurring.snapshot")}),t.resetForm()})).catch((function(e){t.$notifyError(e)})).finally((function(){t.actionLoading=!1}))}}))},showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},resetForm:function(){this.form.setFieldsValue({time:void 0,timezone:void 0,timeSelect:void 0,maxsnaps:void 0,"day-of-week":void 0,"day-of-month":void 0}),this.tags=[]},closeAction:function(){this.$emit("close-action")}}},h=d,m=(a("ada4"),a("2877")),p=Object(m["a"])(h,r,l,!1,null,"141d9b5a",null),f=p.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-schedule"},[a("a-table",{attrs:{size:"small",columns:e.columns,dataSource:e.dataSchedules,rowKey:function(e){return e.id},pagination:!1,loading:e.loading},scopedSlots:e._u([{key:"icon",fn:function(t,n){return a("div",{},[a("label",{staticClass:"interval-icon"},[0===n.intervaltype?a("span",[a("a-icon",{attrs:{type:"clock-circle"}})],1):1===n.intervaltype?a("span",{staticClass:"custom-icon icon-daily"},[a("a-icon",{attrs:{type:"calendar"}})],1):2===n.intervaltype?a("span",{staticClass:"custom-icon icon-weekly"},[a("a-icon",{attrs:{type:"calendar"}})],1):3===n.intervaltype?a("span",{staticClass:"custom-icon icon-monthly"},[a("a-icon",{attrs:{type:"calendar"}})],1):e._e()])])}},{key:"time",fn:function(t,n){return a("div",{},[a("label",{staticClass:"interval-content"},[0===n.intervaltype?a("span",[e._v(e._s(n.schedule+e.$t("label.min.past.hour")))]):a("span",[e._v(e._s(n.schedule.split(":")[1]+":"+n.schedule.split(":")[0]))])])])}},{key:"interval",fn:function(t,n){return a("div",{},[2===n.intervaltype?a("span",[e._v(" "+e._s(e.$t("label.every")+" "+e.$t(e.listDayOfWeek[n.schedule.split(":")[2]-1]))+" ")]):3===n.intervaltype?a("span",[e._v(" "+e._s(e.$t("label.day")+" "+n.schedule.split(":")[2]+" "+e.$t("label.of.month"))+" ")]):e._e()])}},{key:"timezone",fn:function(t,n){return a("div",{},[a("label",[e._v(e._s(e.getTimeZone(n.timezone)))])])}},{key:"tags",fn:function(t,n){return a("div",{},e._l(n.tags,(function(t,n){return a("a-tag",{key:n},[e._v(e._s(t.key+"="+t.value))])})),1)}},{key:"action",fn:function(t,n){return a("div",{staticClass:"account-button-action"},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[e._v(" "+e._s(e.$t("label.delete"))+" ")]),a("a-button",{attrs:{type:"danger",shape:"circle",icon:"close",size:"small",loading:e.actionLoading},on:{click:function(t){return e.handleClickDelete(n)}}})],2)],1)}}])})],1)},v=[],g={name:"ScheduledSnapshots",props:{loading:{type:Boolean,default:!1},dataSource:{type:Array,required:!0},resource:{type:Object,required:!0}},data:function(){return{actionLoading:!1,columns:[],dataSchedules:[],listDayOfWeek:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]}},created:function(){this.columns=[{title:"",dataIndex:"icon",width:30,scopedSlots:{customRender:"icon"}},{title:this.$t("label.time"),dataIndex:"schedule",scopedSlots:{customRender:"time"}},{title:"",dataIndex:"interval",scopedSlots:{customRender:"interval"}},{title:this.$t("label.timezone"),dataIndex:"timezone",scopedSlots:{customRender:"timezone"}},{title:this.$t("label.keep"),dataIndex:"maxsnaps",scopedSlots:{customRender:"keep"}},{title:this.$t("label.tags"),dataIndex:"tags",scopedSlots:{customRender:"tags"}},{title:this.$t("label.action"),dataIndex:"action",width:50,scopedSlots:{customRender:"action"}}]},mounted:function(){this.dataSchedules=this.dataSource},watch:{dataSource:function(e,t){this.dataSchedules=e}},methods:{handleClickDelete:function(e){var t=this,a={};a.id=e.id,this.actionLoading=!0,Object(s["a"])("deleteSnapshotPolicies",a).then((function(e){e.deletesnapshotpoliciesresponse.success&&(t.$notification.success({message:t.$t("label.delete.snapshot.policy"),description:t.$t("message.success.delete.snapshot.policy")}),t.$emit("refresh"))})).catch((function(e){t.$notifyError(e)})).finally((function(){t.actionLoading=!1}))},getTimeZone:function(e){return Object(o["b"])(e)}}},b=g,k=(a("5838"),Object(m["a"])(b,y,v,!1,null,"12ade07e",null)),$=k.exports,S={name:"RecurringSnapshotVolume",components:{FormSchedule:f,ScheduledSnapshots:$},props:{resource:{type:Object,required:!0}},data:function(){return{loading:!1,dataSource:[]}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this,t={};this.dataSource=[],this.loading=!0,t.volumeid=this.resource.id,Object(s["a"])("listSnapshotPolicies",t).then((function(t){e.loading=!1;var a=t.listsnapshotpoliciesresponse.snapshotpolicy;a&&a.length>0&&(e.dataSource=a)}))},handleRefresh:function(){this.fetchData()},closeAction:function(){this.$emit("close-action")}}},_=S,w=(a("4491"),Object(m["a"])(_,n,i,!1,null,"651806c0",null));t["default"]=w.exports}}]);
//# sourceMappingURL=chunk-d5ca14ee.4ef7e8b9.js.map