(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45f5ee63"],{"3a49":function(e,t,i){"use strict";var n=i("4ea2"),s=i.n(n);s.a},"4b90":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("a-input-search",{staticStyle:{width:"25vw",float:"right","margin-bottom":"10px","z-index":"8"},attrs:{placeholder:e.$t("label.search")},on:{search:e.handleSearch},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),i("a-table",{attrs:{columns:e.columns,dataSource:e.tableSource,pagination:!1,rowSelection:e.rowSelection,customRow:e.onClickRow,loading:e.loading,size:"middle",scroll:{y:225}}},[i("span",{attrs:{slot:"cpuTitle"},slot:"cpuTitle"},[i("a-icon",{attrs:{type:"appstore"}}),e._v(" "+e._s(e.$t("label.cpu")))],1),i("span",{attrs:{slot:"ramTitle"},slot:"ramTitle"},[i("a-icon",{attrs:{type:"bulb"}}),e._v(" "+e._s(e.$t("label.memory")))],1)]),i("div",{staticStyle:{display:"block","text-align":"right"}},[i("a-pagination",{attrs:{size:"small",current:e.options.page,pageSize:e.options.pageSize,total:e.rowCount,showTotal:function(t){return e.$t("label.total")+" "+t+" "+e.$t("label.items")},pageSizeOptions:["10","20","40","80","100","200"],showSizeChanger:""},on:{change:e.onChangePage,showSizeChange:e.onChangePageSize},scopedSlots:e._u([{key:"buildOptionText",fn:function(t){return[i("span",[e._v(e._s(t.value)+" / "+e._s(e.$t("label.page")))])]}}])})],1)],1)},s=[],r=(i("99af"),i("4de4"),i("d81d"),i("b0c0"),i("a9e3"),i("b6802"),{name:"ComputeOfferingSelection",props:{computeItems:{type:Array,default:function(){return[]}},rowCount:{type:Number,default:function(){return 0}},value:{type:String,default:""},loading:{type:Boolean,default:!1},preFillContent:{type:Object,default:function(){}},zoneId:{type:String,default:function(){return""}},minimumCpunumber:{type:Number,default:0},minimumCpuspeed:{type:Number,default:0},minimumMemory:{type:Number,default:0}},data:function(){return{filter:"",columns:[{dataIndex:"name",title:this.$t("label.serviceofferingid"),width:"40%"},{dataIndex:"cpu",slots:{title:"cpuTitle"},width:"30%"},{dataIndex:"ram",slots:{title:"ramTitle"},width:"30%"}],selectedRowKeys:[],oldZoneId:null,options:{page:1,pageSize:10,keyword:null}}},computed:{tableSource:function(){var e=this;return this.computeItems.map((function(t){var i=t.cpunumber,n=t.cpuspeed,s=t.memory,r=null!==t.cpunumber&&void 0!==t.cpunumber&&t.cpunumber>0?t.cpunumber+"":"",o=null!==t.cpuspeed&&void 0!==t.cpuspeed&&t.cpuspeed>0?parseFloat(t.cpuspeed/1e3).toFixed(2)+"":"",a=null!==t.memory&&void 0!==t.memory&&t.memory>0?t.memory+"":"";!0===t.iscustomized&&("serviceofferingdetails"in t&&"mincpunumber"in t.serviceofferingdetails&&"maxcpunumber"in t.serviceofferingdetails&&(i=t.serviceofferingdetails.maxcpunumber,r=t.serviceofferingdetails.mincpunumber+"-"+t.serviceofferingdetails.maxcpunumber),"serviceofferingdetails"in t&&"minmemory"in t.serviceofferingdetails&&"maxmemory"in t.serviceofferingdetails&&(s=t.serviceofferingdetails.maxmemory,a=t.serviceofferingdetails.minmemory+"-"+t.serviceofferingdetails.maxmemory));var u=!1;return e.minimumCpunumber>0&&(!1===t.iscustomized&&i!==e.minimumCpunumber||!0===t.iscustomized&&i<e.minimumCpunumber)&&(u=!0),!1===u&&e.minimumCpuspeed>0&&n&&n!==e.minimumCpuspeed&&(u=!0),!1===u&&s&&e.minimumMemory>0&&(!1===t.iscustomized&&s!==e.minimumMemory||!0===t.iscustomized&&s<e.minimumMemory)&&(u=!0),{key:t.id,name:t.name,cpu:r.length>0?"".concat(r," CPU x ").concat(o," Ghz"):"",ram:a.length>0?"".concat(a," MB"):"",disabled:u}}))},rowSelection:function(){return{type:"radio",selectedRowKeys:this.selectedRowKeys||[],onChange:this.onSelectRow,getCheckboxProps:function(e){return{props:{disabled:e.disabled}}}}}},watch:{value:function(e,t){this.selectedRowKeys=e&&e!==t?[e]:[]},loading:function(){if(!this.loading){if(!this.preFillContent)return;if(this.preFillContent.computeofferingid)this.selectedRowKeys=[this.preFillContent.computeofferingid],this.$emit("select-compute-item",this.preFillContent.computeofferingid);else{if(this.oldZoneId===this.zoneId)return;this.oldZoneId=this.zoneId,this.computeItems&&this.computeItems.length>0&&(this.selectedRowKeys=[this.computeItems[0].id],this.$emit("select-compute-item",this.computeItems[0].id))}}}},methods:{onSelectRow:function(e){this.selectedRowKeys=e,this.$emit("select-compute-item",e[0])},handleSearch:function(e){this.filter=e,this.options.page=1,this.options.pageSize=10,this.options.keyword=this.filter,this.$emit("handle-search-filter",this.options)},onChangePage:function(e,t){this.options.page=e,this.options.pageSize=t,this.$emit("handle-search-filter",this.options)},onChangePageSize:function(e,t){this.options.page=e,this.options.pageSize=t,this.$emit("handle-search-filter",this.options)},onClickRow:function(e){var t=this;return{on:{click:function(){t.selectedRowKeys=[e.key],t.$emit("select-compute-item",e.key)}}}}}}),o=r,a=(i("3a49"),i("2877")),u=Object(a["a"])(o,n,s,!1,null,"67b2d30e",null);t["a"]=u.exports},"4ea2":function(e,t,i){},6820:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-card",[i("a-col",[i("a-row",[i("a-col",{attrs:{md:e.colContraned,lg:e.colContraned}},[i("a-form-item",{attrs:{label:e.$t("label.cpunumber"),"validate-status":e.errors.cpu.status,help:e.errors.cpu.message}},[i("a-row",{attrs:{gutter:12}},[i("a-col",{directives:[{name:"show",rawName:"v-show",value:e.isConstrained,expression:"isConstrained"}],attrs:{md:10,lg:10}},[i("a-slider",{attrs:{min:e.minCpu,max:e.maxCpu},on:{change:function(t){return e.updateComputeCpuNumber(t)}},model:{value:e.cpuNumberInputValue,callback:function(t){e.cpuNumberInputValue=t},expression:"cpuNumberInputValue"}})],1),i("a-col",{attrs:{md:4,lg:4}},[i("a-input-number",{on:{change:function(t){return e.updateComputeCpuNumber(t)}},model:{value:e.cpuNumberInputValue,callback:function(t){e.cpuNumberInputValue=t},expression:"cpuNumberInputValue"}})],1)],1)],1)],1),i("a-col",{directives:[{name:"show",rawName:"v-show",value:!e.isConstrained,expression:"!isConstrained"}],attrs:{md:8,lg:8}},[i("a-form-item",{attrs:{label:e.$t("label.cpuspeed"),"validate-status":e.errors.cpuspeed.status,help:e.errors.cpuspeed.message}},[i("a-input-number",{on:{change:function(t){return e.updateComputeCpuSpeed(t)}},model:{value:e.cpuSpeedInputValue,callback:function(t){e.cpuSpeedInputValue=t},expression:"cpuSpeedInputValue"}})],1)],1),i("a-col",{attrs:{md:e.colContraned,lg:e.colContraned}},[i("a-form-item",{attrs:{label:e.$t("label.memory.mb"),"validate-status":e.errors.memory.status,help:e.errors.memory.message}},[i("a-row",{attrs:{gutter:12}},[i("a-col",{directives:[{name:"show",rawName:"v-show",value:e.isConstrained,expression:"isConstrained"}],attrs:{md:10,lg:10}},[i("a-slider",{attrs:{min:e.minMemory,max:e.maxMemory},on:{change:function(t){return e.updateComputeMemory(t)}},model:{value:e.memoryInputValue,callback:function(t){e.memoryInputValue=t},expression:"memoryInputValue"}})],1),i("a-col",{attrs:{md:4,lg:4}},[i("a-input-number",{on:{change:function(t){return e.updateComputeMemory(t)}},model:{value:e.memoryInputValue,callback:function(t){e.memoryInputValue=t},expression:"memoryInputValue"}})],1)],1)],1)],1)],1)],1)],1)},s=[],r=(i("99af"),i("a9e3"),{name:"ComputeSelection",props:{computeOfferingId:{type:String,default:function(){return""}},isConstrained:{type:Boolean,default:!0},minCpu:{type:Number,default:0},maxCpu:{type:Number,default:2},minMemory:{type:Number,default:0},maxMemory:{type:Number,default:256},cpunumberInputDecorator:{type:String,default:""},cpuspeedInputDecorator:{type:String,default:""},memoryInputDecorator:{type:String,default:""},preFillContent:{type:Object,default:function(){}}},data:function(){return{cpuNumberInputValue:0,cpuSpeedInputValue:0,memoryInputValue:0,errors:{cpu:{status:"",message:""},cpuspeed:{status:"",message:""},memory:{status:"",message:""}}}},computed:{colContraned:function(){return this.isConstrained?12:8}},watch:{computeOfferingId:function(e,t){e!==t&&this.fillValue()}},mounted:function(){this.fillValue()},methods:{fillValue:function(){if(this.cpuNumberInputValue=this.minCpu,this.memoryInputValue=this.minMemory,!this.preFillContent)return this.updateComputeCpuNumber(this.cpuNumberInputValue),this.updateComputeCpuSpeed(this.cpuSpeedInputValue),void this.updateComputeMemory(this.memoryInputValue);this.preFillContent.cpunumber&&(this.cpuNumberInputValue=this.preFillContent.cpunumber),this.preFillContent.cpuspeed&&(this.cpuSpeedInputValue=this.preFillContent.cpuspeed),this.preFillContent.memory&&(this.memoryInputValue=this.preFillContent.memory),this.updateComputeCpuNumber(this.preFillContent.cpunumber||this.cpuNumberInputValue),this.updateComputeCpuSpeed(this.preFillContent.cpuspeed||this.cpuSpeedInputValue),this.updateComputeMemory(this.preFillContent.memory||this.memoryInputValue)},updateComputeCpuNumber:function(e){e||(this.cpuNumberInputValue=0),this.validateInput("cpu",e)&&this.$emit("update-compute-cpunumber",this.cpunumberInputDecorator,e)},updateComputeCpuSpeed:function(e){this.$emit("update-compute-cpuspeed",this.cpuspeedInputDecorator,e)},updateComputeMemory:function(e){e||(this.memoryInputValue=0),this.validateInput("memory",e)&&this.$emit("update-compute-memory",this.memoryInputDecorator,e)},validateInput:function(e,t){if(this.errors[e].status="",this.errors[e].message="",null===t||void 0===t||0===t.length)return this.errors[e].status="error",this.errors[e].message=this.$t("message.error.required.input"),!1;if(!this.isConstrained)return!0;var i,n;switch(e){case"cpu":i=this.minCpu,n=this.maxCpu;break;case"memory":i=this.minMemory,n=this.maxMemory;break}return!!this.checkValidRange(t,i,n)||(this.errors[e].status="error",this.errors[e].message="".concat(this.$t("message.please.enter.value")," ").concat(this.$t("label.from")," ").concat(i," ").concat(this.$t("label.to")," ").concat(n,")"),!1)},checkValidRange:function(e,t,i){return!(e<t||e>i)}}}),o=r,a=i("2877"),u=Object(a["a"])(o,n,s,!1,null,null,null);t["a"]=u.exports},"8b750":function(e,t,i){"use strict";var n=i("d1fa"),s=i.n(n);s.a},cdff:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-form",{staticClass:"form"},[i("p",{domProps:{innerHTML:e._s(e.getMessage())}}),e.loading?i("div",{staticClass:"loading"},[i("a-icon",{staticStyle:{color:"#1890ff"},attrs:{type:"loading"}})],1):e._e(),i("compute-offering-selection",{attrs:{"compute-items":e.offerings,loading:e.loading,rowCount:e.total,size:"small"},on:{"select-compute-item":function(t){return e.updateComputeOffering(t)},"handle-search-filter":function(t){return e.fetchData(t)}}}),e.selectedOffering&&e.selectedOffering.iscustomized?i("compute-selection",{attrs:{"cpunumber-input-decorator":e.cpuNumberKey,"cpuspeed-input-decorator":e.cpuSpeedKey,"memory-input-decorator":e.memoryKey,computeOfferingId:e.selectedOffering.id,isConstrained:"serviceofferingdetails"in e.selectedOffering,minCpu:e.getMinCpu(),maxCpu:"serviceofferingdetails"in e.selectedOffering?1*e.selectedOffering.serviceofferingdetails.maxcpunumber:Number.MAX_SAFE_INTEGER,minMemory:e.getMinMemory(),maxMemory:"serviceofferingdetails"in e.selectedOffering?1*e.selectedOffering.serviceofferingdetails.maxmemory:Number.MAX_SAFE_INTEGER},on:{"update-compute-cpunumber":e.updateFieldValue,"update-compute-cpuspeed":e.updateFieldValue,"update-compute-memory":e.updateFieldValue}}):e._e(),i("div",{staticClass:"action-button",attrs:{span:24}},[i("a-button",{on:{click:e.closeAction}},[e._v(e._s(this.$t("label.cancel")))]),i("a-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(this.$t("label.ok")))])],1)],1)},s=[],r=(i("d81d"),i("d3b7"),i("365c")),o=i("4b90"),a=i("6820"),u={name:"ScaleVM",components:{ComputeOfferingSelection:o["a"],ComputeSelection:a["a"]},props:{resource:{type:Object,required:!0}},inject:["parentFetchData"],data:function(){return{offeringsMap:{},offerings:[],selectedOffering:{},total:0,params:{id:this.resource.id},loading:!1,cpuNumberKey:"details[0].cpuNumber",cpuSpeedKey:"details[0].cpuSpeed",memoryKey:"details[0].memory"}},mounted:function(){this.fetchData({keyword:"",pageSize:10,page:1})},methods:{fetchData:function(e){var t=this;this.loading=!0,this.total=0,this.offerings=[],this.offeringsMap=[],Object(r["a"])("listServiceOfferings",{virtualmachineid:this.resource.id,keyword:e.keyword,page:e.page,pageSize:e.pageSize,details:"min",response:"json"}).then((function(e){t.total=e.listserviceofferingsresponse.count,0!==t.total&&(t.offerings=e.listserviceofferingsresponse.serviceoffering,t.offerings.map((function(e){t.offeringsMap[e.id]=e})))})).finally((function(){t.loading=!1}))},getMinCpu:function(){return"Running"===this.resource.state?this.resource.cpunumber:"serviceofferingdetails"in this.selectedOffering?1*this.selectedOffering.serviceofferingdetails.mincpunumber:1},getMinMemory:function(){return"Running"===this.resource.state?this.resource.memory:"serviceofferingdetails"in this.selectedOffering?1*this.selectedOffering.serviceofferingdetails.minmemory:32},getMessage:function(){return"VMware"===this.resource.hypervisor?this.$t("message.read.admin.guide.scaling.up"):this.$t("message.change.offering.confirm")},updateComputeOffering:function(e){delete this.params[this.cpuNumberKey],delete this.params[this.cpuSpeedKey],delete this.params[this.memoryKey],this.params.serviceofferingid=e,this.selectedOffering=this.offeringsMap[e]},updateFieldValue:function(e,t){this.params[e]=t},closeAction:function(){this.$emit("close-action")},handleSubmit:function(){var e=this;this.loading=!0,"cpuspeed"in this.selectedOffering&&this.selectedOffering.iscustomized&&delete this.params[this.cpuSpeedKey],Object(r["a"])("scaleVirtualMachine",this.params).then((function(t){var i=t.scalevirtualmachineresponse.jobid;i&&e.$pollJob({jobId:i,successMethod:function(t){e.$notification.success({message:e.$t("message.success.change.offering")})},loadingMessage:e.$t("message.scale.processing"),catchMessage:e.$t("error.fetching.async.job.result")}),e.$parent.$parent.close(),e.parentFetchData()})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading=!1}))}}},c=u,l=(i("8b750"),i("2877")),p=Object(l["a"])(c,n,s,!1,null,"4fc24bef",null);t["default"]=p.exports},d1fa:function(e,t,i){}}]);
//# sourceMappingURL=chunk-45f5ee63.133497e4.js.map