(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c13189e"],{"21a9":function(t,e,o){"use strict";var n=o("aae1"),r=o.n(n);r.a},4499:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("a-row",{attrs:{gutter:12}},[o("a-col",{attrs:{md:24,lg:24}},[o("a-table",{attrs:{size:"small",loading:t.loading.table,columns:t.columns,dataSource:t.dataSource,pagination:!1,rowKey:function(t){return t.userid?t.userid:t.accountid||t.account}},scopedSlots:t._u([{key:"user",fn:function(e,n){return n.userid?o("span",{},[t._v(" "+t._s(n.username)+" ")]):t._e()}},{key:"projectrole",fn:function(e,n){return n.projectroleid?o("span",{},[t._v(" "+t._s(t.getProjectRole(n))+" ")]):t._e()}},{key:"action",fn:function(e,n){return t.imProjectAdmin&&t.dataSource.length>1?o("span",{staticClass:"account-button-action"},[o("a-tooltip",{attrs:{slot:"title",placement:"top",title:n.userid?t.$t("label.make.user.project.owner"):t.$t("label.make.project.owner")},slot:"title"},[n.role!==t.owner?o("a-button",{attrs:{type:"default",shape:"circle",icon:"arrow-up",size:"small"},on:{click:function(e){return t.promoteAccount(n)}}}):t._e()],1),t.updateProjectApi.params.filter((function(t){return"swapowner"===t.name})).length>0?o("a-tooltip",{attrs:{slot:"title",placement:"top",title:n.userid?t.$t("label.demote.project.owner.user"):t.$t("label.demote.project.owner")},slot:"title"},[n.role===t.owner?o("a-button",{attrs:{type:"default",shape:"circle",icon:"arrow-down",size:"small"},on:{click:function(e){return t.demoteAccount(n)}}}):t._e()],1):t._e(),o("a-tooltip",{attrs:{slot:"title",placement:"top",title:n.userid?t.$t("label.remove.project.user"):t.$t("label.remove.project.account")},slot:"title"},[o("a-button",{attrs:{type:"danger",shape:"circle",icon:"delete",size:"small",disabled:!("deleteAccountFromProject"in t.$store.getters.apis)},on:{click:function(e){return t.onShowConfirmDelete(n)}}})],1)],1):t._e()}}],null,!0)}),o("a-pagination",{staticClass:"row-element",attrs:{size:"small",current:t.page,pageSize:t.pageSize,total:t.itemCount,showTotal:function(e){return t.$t("label.total")+" "+e+" "+t.$t("label.items")},pageSizeOptions:["10","20","40","80","100"],showSizeChanger:""},on:{change:t.changePage,showSizeChange:t.changePageSize},scopedSlots:t._u([{key:"buildOptionText",fn:function(e){return[o("span",[t._v(t._s(e.value)+" / "+t._s(t.$t("label.page")))])]}}])})],1)],1)],1)},r=[],c=(o("a4d3"),o("e01a"),o("d28b"),o("99af"),o("4de4"),o("caad"),o("a434"),o("b0c0"),o("d3b7"),o("2532"),o("3ca3"),o("ddb0"),o("365c")),i={name:"AccountsTab",props:{resource:{type:Object,required:!0}},data:function(){return{columns:[],dataSource:[],imProjectAdmin:!1,loading:{user:!1,projectAccount:!1,roles:!1,table:!1},page:1,pageSize:10,itemCount:0,users:[],projectRoles:[],owner:"Admin",role:"Regular"}},created:function(){this.columns=[{title:this.$t("label.account"),dataIndex:"account",scopedSlots:{customRender:"account"}},{title:this.$t("label.roletype"),dataIndex:"role",scopedSlots:{customRender:"role"}},{title:this.$t("label.action"),dataIndex:"action",scopedSlots:{customRender:"action"}}],this.isProjectRolesSupported()&&(this.columns.splice(1,0,{title:this.$t("label.user"),dataIndex:"userid",scopedSlots:{customRender:"user"}}),this.columns.splice(this.columns.length-1,0,{title:this.$t("label.project.role"),dataIndex:"projectroleid",scopedSlots:{customRender:"projectrole"}})),this.page=1,this.pageSize=10,this.itemCount=0},inject:["parentFetchData"],mounted:function(){this.fetchData()},watch:{resource:function(t,e){t&&t.id&&(this.resource=t,this.fetchData())}},methods:{fetchData:function(){var t={};t.projectId=this.resource.id,t.page=this.page,t.pageSize=this.pageSize,this.updateProjectApi=this.$store.getters.apis.updateProject,this.fetchUsers(),this.fetchProjectAccounts(t),this.isProjectRolesSupported()&&this.fetchProjectRoles()},changePage:function(t,e){this.page=t,this.pageSize=e,this.fetchData()},changePageSize:function(t,e){this.page=0,this.pageSize=e,this.fetchData()},isLoggedInUserProjectAdmin:function(t){return!!["Admin","DomainAdmin"].includes(this.$store.getters.userInfo.roletype)||!(!(t.userid&&t.userid===this.$store.getters.userInfo.id||t.account===this.$store.getters.userInfo.account)||t.role!==this.owner)},isProjectRolesSupported:function(){return"listProjectRoles"in this.$store.getters.apis},getProjectRole:function(t){var e=this.projectRoles.filter((function(e){return e.id===t.projectroleid}));return e[0].name||e[0].id||null},fetchUsers:function(){var t=this;this.loading.user=!0,Object(c["a"])("listUsers",{listall:!0}).then((function(e){t.users=e.listusersresponse.user||[]})).catch((function(e){t.$notifyError(e)})).finally((function(){t.loading.user=!1}))},fetchProjectRoles:function(){var t=this;this.loading.roles=!0,Object(c["a"])("listProjectRoles",{projectId:this.resource.id}).then((function(e){t.projectRoles=e.listprojectrolesresponse.projectrole||[]})).catch((function(e){t.$notifyError(e)})).finally((function(){t.loading.roles=!1}))},fetchProjectAccounts:function(t){var e=this;this.loading.projectAccount=!0,Object(c["a"])("listProjectAccounts",t).then((function(t){var o=t.listprojectaccountsresponse.projectaccount,n=t.listprojectaccountsresponse.count;if(o&&0!==o.length){var r=!0,c=!1,i=void 0;try{for(var a,s=o[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(e.imProjectAdmin=e.isLoggedInUserProjectAdmin(l),e.imProjectAdmin)break}}catch(u){c=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(c)throw i}}e.itemCount=n,e.dataSource=o}else e.dataSource=[]})).catch((function(t){e.$notifyError(t)})).finally((function(){e.loading.projectAccount=!1}))},onMakeProjectOwner:function(t){var e=this.$t("label.make.project.owner"),o=this.$message.loading(e+"".concat(this.$t("label.in.progress.for")," ")+t.account,0),n={};n.id=this.resource.id,n.account=t.account,this.updateProject(t,n,e,o)},promoteAccount:function(t){var e=this.$t("label.make.project.owner"),o=this.$message.loading(e+"".concat(this.$t("label.in.progress.for")," ")+t.account,0),n={};n.id=this.resource.id,t.userid?(n.userid=t.userid,e=this.$t("label.make.user.project.owner")):n.account=t.account,n.roletype=this.owner,n.swapowner=!1,this.updateProject(t,n,e,o)},demoteAccount:function(t){var e=this.$t("label.demote.project.owner"),o=this.$message.loading(e+"".concat(this.$t("label.in.progress.for")," ")+t.account,0),n={};t.userid?(n.userid=t.userid,e=this.$t("label.demote.project.owner.user")):n.account=t.account,n.id=this.resource.id,n.roletype="Regular",n.swapowner=!1,this.updateProject(t,n,e,o)},updateProject:function(t,e,o,n){var r=this;Object(c["a"])("updateProject",e).then((function(e){var n=r.checkForAddAsyncJob(e,o,t.account);n&&r.fetchData()})).catch((function(t){r.$notifyError(t)})).finally((function(){setTimeout(n,1e3),r.parentFetchData()}))},onShowConfirmDelete:function(t){var e=this,o="".concat(this.$t("label.deleteconfirm")," ").concat(this.$t("label.account"));this.$confirm({title:o,okText:this.$t("label.ok"),okType:"danger",cancelText:this.$t("label.cancel"),onOk:function(){e.removeAccount(t)}})},removeAccount:function(t){var e=this.$t("label.remove.project.account"),o=this.$message.loading(e+"".concat(this.$t("label.in.progress.for")," ")+t.account,0),n={};n.projectid=this.resource.id,t.userid?(n.userid=t.userid,this.deleteOperation("deleteUserFromProject",n,t,e,o)):(n.account=t.account,this.deleteOperation("deleteAccountFromProject",n,t,e,o))},deleteOperation:function(t,e,o,n,r){var i=this;Object(c["a"])(t,e).then((function(t){var e=i.checkForAddAsyncJob(t,n,o.account);e&&i.fetchData()})).catch((function(t){i.$notifyError(t)})).finally((function(){setTimeout(r,1e3)}))},checkForAddAsyncJob:function(t,e,o){var n=!1;for(var r in t)if(r.includes("response"))for(var c in t[r])if("jobid"===c){n=!0;var i=t[r][c];this.$store.dispatch("AddAsyncJob",{title:e,jobid:i,description:o,status:"progress"})}return n}}},a=i,s=(o("21a9"),o("2877")),l=Object(s["a"])(a,n,r,!1,null,"02c85c8a",null);e["default"]=l.exports},aae1:function(t,e,o){}}]);
//# sourceMappingURL=chunk-6c13189e.9cacb841.js.map