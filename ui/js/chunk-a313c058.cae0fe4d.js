(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a313c058"],{"0752":function(e,t,s){"use strict";var a=s("2ad5"),i=s.n(a);i.a},"2ad5":function(e,t,s){},c444:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a-spin",{attrs:{spinning:e.fetchLoading}},[s("a-button",{staticStyle:{width:"100%","margin-bottom":"15px"},attrs:{disabled:!("associateIpAddress"in e.$store.getters.apis),type:"dashed",icon:"plus"},on:{click:e.onShowAcquireIp}},[e._v(" "+e._s(e.$t("label.acquire.new.ip"))+" ")]),e.$route.path.startsWith("/vpc")?s("div",[e._v(" Select Tier: "),s("a-select",{staticStyle:{width:"40%","margin-left":"15px","margin-bottom":"15px"},attrs:{loading:e.fetchLoading,defaultActiveFirstOption:"",value:e.vpcTier},on:{change:e.handleTierSelect}},[s("a-select-option",{key:"all",attrs:{value:""}},[e._v(" "+e._s(e.$t("label.view.all"))+" ")]),e._l(e.networksList,(function(t){return s("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])}))],2)],1):e._e(),s("a-table",{staticStyle:{"overflow-y":"auto"},attrs:{size:"small",columns:e.columns,dataSource:e.ips,rowKey:function(e){return e.id},pagination:!1},scopedSlots:e._u([{key:"ipaddress",fn:function(t,a){return[s("router-link",{attrs:{to:{path:"/publicip/"+a.id}}},[e._v(e._s(t)+" ")]),!0===a.issourcenat?s("a-tag",[e._v("source-nat")]):e._e()]}},{key:"state",fn:function(e,t){return[s("status",{attrs:{text:t.state,displayText:""}})]}},{key:"virtualmachineid",fn:function(t,a){return[a.virtualmachineid?s("a-icon",{attrs:{type:"desktop"}}):e._e(),s("router-link",{attrs:{to:{path:"/vm/"+a.virtualmachineid}}},[e._v(" "+e._s(a.virtualmachinename||a.virtualmachineid)+" ")])]}},{key:"associatednetworkname",fn:function(t,a){return[s("router-link",{attrs:{to:{path:"/guestnetwork/"+a.associatednetworkid}}},[e._v(" "+e._s(a.associatednetworkname||a.associatednetworkid)+" ")])]}},{key:"action",fn:function(t,a){return[!0!==a.issourcenat?s("a-button",{attrs:{type:"danger",icon:"delete",shape:"circle",disabled:!("disassociateIpAddress"in e.$store.getters.apis)},on:{click:function(t){return e.releaseIpAddress(a)}}}):e._e()]}}])}),s("a-divider"),s("a-pagination",{staticClass:"row-element pagination",attrs:{size:"small",current:e.page,pageSize:e.pageSize,total:e.totalIps,showTotal:function(t){return e.$t("label.total")+" "+t+" "+e.$t("label.items")},pageSizeOptions:["10","20","40","80","100"],showSizeChanger:""},on:{change:e.changePage,showSizeChange:e.changePageSize},scopedSlots:e._u([{key:"buildOptionText",fn:function(t){return[s("span",[e._v(e._s(t.value)+" / "+e._s(e.$t("label.page")))])]}}])})],1),e.showAcquireIp?s("a-modal",{attrs:{visible:e.showAcquireIp,title:e.$t("label.acquire.new.ip"),closable:!0,okText:e.$t("label.ok"),cancelText:e.$t("label.cancel"),centered:"",width:"450px"},on:{cancel:e.onCloseModal,ok:e.acquireIpAddress}},[s("a-spin",{attrs:{spinning:e.acquireLoading}},[s("a-alert",{attrs:{message:e.$t("message.action.acquire.ip"),type:"warning"}}),s("a-form-item",{attrs:{label:e.$t("label.ipaddress")}},[s("a-select",{staticStyle:{width:"100%"},attrs:{showSearch:""},model:{value:e.acquireIp,callback:function(t){e.acquireIp=t},expression:"acquireIp"}},e._l(e.listPublicIpAddress,(function(t){return s("a-select-option",{key:t.ipaddress},[e._v(e._s(t.ipaddress))])})),1)],1)],1)],1):e._e()],1)},i=[],r=(s("99af"),s("4160"),s("b0c0"),s("d3b7"),s("2ca0"),s("159b"),s("96cf"),s("c964")),n=s("365c"),c=s("829c"),o={name:"IpAddressesTab",components:{Status:c["a"]},props:{resource:{type:Object,required:!0},loading:{type:Boolean,default:!1}},data:function(){return{fetchLoading:!1,ips:[],ipsTiers:[],networksList:[],defaultNetwork:"",vpcTier:"",page:1,pageSize:10,totalIps:0,tiersSelect:!1,columns:[{title:this.$t("label.ipaddress"),dataIndex:"ipaddress",scopedSlots:{customRender:"ipaddress"}},{title:this.$t("label.state"),dataIndex:"state",scopedSlots:{customRender:"state"}},{title:this.$t("label.vm"),dataIndex:"virtualmachineid",scopedSlots:{customRender:"virtualmachineid"}},{title:this.$t("label.network"),dataIndex:"associatednetworkname",scopedSlots:{customRender:"associatednetworkname"}},{title:"",scopedSlots:{customRender:"action"}}],showAcquireIp:!1,acquireLoading:!1,acquireIp:null,listPublicIpAddress:[]}},mounted:function(){this.fetchData()},watch:{resource:function(e,t){e&&e.id&&this.fetchData()}},methods:{fetchData:function(){var e=this,t={listall:!0,page:this.page,pagesize:this.pageSize};this.$route.path.startsWith("/vpc")?(this.networksList=this.resource.network,t.vpcid=this.resource.id,t.forvirtualnetwork=!0,this.vpcTier&&(t.associatednetworkid=this.vpcTier)):t.associatednetworkid=this.resource.id,this.fetchLoading=!0,Object(n["a"])("listPublicIpAddresses",t).then((function(t){e.totalIps=t.listpublicipaddressesresponse.count||0,e.ips=t.listpublicipaddressesresponse.publicipaddress||[]})).finally((function(){e.fetchLoading=!1}))},fetchListPublicIpAddress:function(){var e=this;return new Promise((function(t,s){var a={zoneid:e.resource.zoneid,domainid:e.resource.domainid,account:e.resource.account,forvirtualnetwork:!0,allocatedonly:!1};Object(n["a"])("listPublicIpAddresses",a).then((function(e){var s=e.listpublicipaddressesresponse.publicipaddress||[];t(s)})).catch(s)}))},handleTierSelect:function(e){this.vpcTier=e,this.fetchData()},changePage:function(e,t){this.page=e,this.pageSize=t,this.fetchData()},changePageSize:function(e,t){this.page=e,this.pageSize=t,this.fetchData()},acquireIpAddress:function(){var e=this,t={};this.$route.path.startsWith("/vpc")?(t.vpcid=this.resource.id,this.vpcTier&&(t.networkid=this.vpcTier)):t.networkid=this.resource.id,t.ipaddress=this.acquireIp,this.acquireLoading=!0,Object(n["a"])("associateIpAddress",t).then((function(t){e.$pollJob({jobId:t.associateipaddressresponse.jobid,successMessage:"".concat(e.$t("message.success.acquire.ip")," ").concat(e.$t("label.for")," ").concat(e.resource.name),successMethod:function(){e.fetchData()},errorMessage:e.$t("message.acquire.ip.failed"),errorMethod:function(){e.fetchData()},loadingMessage:"".concat(e.$t("label.acquiring.ip")," ").concat(e.$t("label.for")," ").concat(e.resource.name," ").concat(e.$t("label.is.in.progress")),catchMessage:e.$t("error.fetching.async.job.result")}),e.onCloseModal()})).catch((function(t){e.$notification.error({message:"".concat(e.$t("label.error")," ").concat(t.response.status),description:t.response.data.errorresponse.errortext,duration:0})})).finally((function(){e.acquireLoading=!1}))},releaseIpAddress:function(e){var t=this;this.fetchLoading=!0,Object(n["a"])("disassociateIpAddress",{id:e.id}).then((function(e){t.$pollJob({jobId:e.disassociateipaddressresponse.jobid,successMessage:t.$t("message.success.release.ip"),successMethod:function(){t.fetchData()},errorMessage:t.$t("message.release.ip.failed"),errorMethod:function(){t.fetchData()},loadingMessage:"".concat(t.$t("label.releasing.ip")," ").concat(t.$t("label.for")," ").concat(t.resource.name," ").concat(t.$t("label.is.in.progress")),catchMessage:t.$t("error.fetching.async.job.result")})})).catch((function(e){t.fetchLoading=!1,t.$notification.error({message:"".concat(t.$t("label.error")," ").concat(e.response.status),description:e.response.data.errorresponse.errortext,duration:0})}))},onShowAcquireIp:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showAcquireIp=!0,e.acquireLoading=!0,e.listPublicIpAddress=[],t.prev=3,t.next=6,e.fetchListPublicIpAddress();case 6:s=t.sent,s.forEach((function(t){"Free"===t.state&&e.listPublicIpAddress.push({ipaddress:t.ipaddress})})),e.listPublicIpAddress.sort((function(e,t){return e.ipaddress<t.ipaddress?-1:e.ipaddress>t.ipaddress?1:0})),e.acquireIp=e.listPublicIpAddress&&e.listPublicIpAddress.length>0?e.listPublicIpAddress[0].ipaddress:null,e.acquireLoading=!1,t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](3),e.acquireLoading=!1,e.$notifyError(t.t0);case 17:case"end":return t.stop()}}),t,null,[[3,13]])})))()},onCloseModal:function(){this.showAcquireIp=!1}}},d=o,l=(s("0752"),s("2877")),u=Object(l["a"])(d,a,i,!1,null,"48f7b13c",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-a313c058.cae0fe4d.js.map