{"version":3,"sources":["webpack:///./src/views/image/RegisterOrUploadIso.vue?be18","webpack:///./src/views/image/RegisterOrUploadIso.vue?a2d7","webpack:///src/views/image/RegisterOrUploadIso.vue","webpack:///./src/views/image/RegisterOrUploadIso.vue?f312","webpack:///./src/views/image/RegisterOrUploadIso.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","uploadPercentage","attrs","_v","_s","$t","loading","form","on","handleSubmit","currentForm","directives","name","rawName","value","rules","required","message","expression","apiParams","url","description","_e","fileList","handleRemove","beforeUpload","length","displaytext","allowed","initialValue","selectedZone","input","option","componentOptions","children","text","toLowerCase","indexOf","zoneLoading","zoneid","_l","opt","key","id","bootable","val","defaultOsType","osTypeLoading","ostypeid","optIndex","$store","getters","userInfo","roletype","features","userpublictemplateenabled","closeAction","staticRenderFns","props","resource","type","Object","action","data","zones","osTypes","uploadParams","currentAction","icon","beforeCreate","$form","createForm","apiConfig","apis","registerIso","params","forEach","created","mounted","fetchData","methods","fetchZoneData","fetchOsType","store","newFileList","splice","index","file","handleUpload","$notification","error","duration","formData","append","e","preventDefault","validateFields","err","undefined","zone","format","response","$emit","component"],"mappings":"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","file":"js/chunk-8a13d83e.3cfcd2de.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegisterOrUploadIso.vue?vue&type=style&index=0&id=0d633d81&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegisterOrUploadIso.vue?vue&type=style&index=0&id=0d633d81&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"form-layout\"},[(_vm.uploadPercentage > 0)?_c('span',[_c('a-icon',{attrs:{\"type\":\"loading\"}}),_vm._v(\" \"+_vm._s(_vm.$t('message.upload.file.processing'))+\" \"),_c('a-progress',{attrs:{\"percent\":_vm.uploadPercentage}})],1):_c('a-spin',{attrs:{\"spinning\":_vm.loading}},[_c('a-form',{attrs:{\"form\":_vm.form,\"layout\":\"vertical\"},on:{\"submit\":_vm.handleSubmit}},[(_vm.currentForm === 'Create')?_c('a-form-item',{attrs:{\"label\":_vm.$t('label.url')}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['url', {\n            rules: [{ required: true, message: (\"\" + (this.$t('label.upload.iso.from.local'))) }]\n          }]),expression:\"['url', {\\n            rules: [{ required: true, message: `${this.$t('label.upload.iso.from.local')}` }]\\n          }]\"}],attrs:{\"autoFocus\":\"\",\"placeholder\":_vm.apiParams.url.description}})],1):_vm._e(),(_vm.currentForm === 'Upload')?_c('a-form-item',{attrs:{\"label\":_vm.$t('label.templatefileupload')}},[_c('a-upload-dragger',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['file', {\n            rules: [{ required: true, message: (\"\" + (this.$t('message.error.required.input'))) }]\n          }]),expression:\"['file', {\\n            rules: [{ required: true, message: `${this.$t('message.error.required.input')}` }]\\n          }]\"}],attrs:{\"multiple\":false,\"fileList\":_vm.fileList,\"remove\":_vm.handleRemove,\"beforeUpload\":_vm.beforeUpload}},[_c('p',{staticClass:\"ant-upload-drag-icon\"},[_c('a-icon',{attrs:{\"type\":\"cloud-upload\"}})],1),(_vm.fileList.length === 0)?_c('p',{staticClass:\"ant-upload-text\"},[_vm._v(\" \"+_vm._s(_vm.$t('label.volume.volumefileupload.description'))+\" \")]):_vm._e()])],1):_vm._e(),_c('a-form-item',{attrs:{\"label\":_vm.$t('label.name')}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['name', {\n            rules: [{ required: true, message: (\"\" + (this.$t('message.error.required.input'))) }]\n          }]),expression:\"['name', {\\n            rules: [{ required: true, message: `${this.$t('message.error.required.input')}` }]\\n          }]\"}],attrs:{\"placeholder\":_vm.apiParams.name.description}})],1),_c('a-form-item',{attrs:{\"label\":_vm.$t('label.displaytext')}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['displaytext', {\n            rules: [{ required: true, message: (\"\" + (this.$t('message.error.required.input'))) }]\n          }]),expression:\"['displaytext', {\\n            rules: [{ required: true, message: `${this.$t('message.error.required.input')}` }]\\n          }]\"}],attrs:{\"placeholder\":_vm.apiParams.displaytext.description}})],1),(_vm.allowed && _vm.currentForm !== 'Upload')?_c('a-form-item',{attrs:{\"label\":_vm.$t('label.directdownload')}},[_c('a-switch',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['directdownload']),expression:\"['directdownload']\"}]})],1):_vm._e(),_c('a-form-item',{attrs:{\"label\":_vm.$t('label.zoneid')}},[_c('a-select',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['zoneid', {\n            initialValue: this.selectedZone,\n            rules: [\n              {\n                required: true,\n                message: (\"\" + (this.$t('message.error.select')))\n              }\n            ]\n          }]),expression:\"['zoneid', {\\n            initialValue: this.selectedZone,\\n            rules: [\\n              {\\n                required: true,\\n                message: `${this.$t('message.error.select')}`\\n              }\\n            ]\\n          }]\"}],attrs:{\"showSearch\":\"\",\"optionFilterProp\":\"children\",\"filterOption\":function (input, option) {\n            return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n          },\"loading\":_vm.zoneLoading,\"placeholder\":_vm.apiParams.zoneid.description}},_vm._l((_vm.zones),function(opt){return _c('a-select-option',{key:opt.id,attrs:{\"value\":opt.id}},[_vm._v(\" \"+_vm._s(opt.name || opt.description)+\" \")])}),1)],1),_c('a-form-item',{attrs:{\"label\":_vm.$t('label.bootable')}},[_c('a-switch',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['bootable', {\n            initialValue: true,\n          }]),expression:\"['bootable', {\\n            initialValue: true,\\n          }]\"}],attrs:{\"checked\":_vm.bootable},on:{\"change\":function (val) { return _vm.bootable = val; }}})],1),(_vm.bootable)?_c('a-form-item',{attrs:{\"label\":_vm.$t('label.ostypeid')}},[_c('a-select',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['ostypeid', {\n            initialValue: _vm.defaultOsType,\n            rules: [{ required: true, message: (\"\" + (this.$t('message.error.select'))) }]\n          }]),expression:\"['ostypeid', {\\n            initialValue: defaultOsType,\\n            rules: [{ required: true, message: `${this.$t('message.error.select')}` }]\\n          }]\"}],attrs:{\"showSearch\":\"\",\"optionFilterProp\":\"children\",\"filterOption\":function (input, option) {\n            return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n          },\"loading\":_vm.osTypeLoading,\"placeholder\":_vm.apiParams.ostypeid.description}},_vm._l((_vm.osTypes),function(opt,optIndex){return _c('a-select-option',{key:optIndex,attrs:{\"value\":opt.id}},[_vm._v(\" \"+_vm._s(opt.name || opt.description)+\" \")])}),1)],1):_vm._e(),_c('a-form-item',{attrs:{\"label\":_vm.$t('label.isextractable')}},[_c('a-switch',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['isextractable', {\n            initialValue: false\n          }]),expression:\"['isextractable', {\\n            initialValue: false\\n          }]\"}]})],1),(_vm.$store.getters.userInfo.roletype === 'Admin' || _vm.$store.getters.features.userpublictemplateenabled)?_c('a-form-item',{attrs:{\"label\":_vm.$t('label.ispublic')}},[_c('a-switch',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['ispublic', {\n            initialValue: false\n          }]),expression:\"['ispublic', {\\n            initialValue: false\\n          }]\"}]})],1):_vm._e(),_c('a-form-item',{attrs:{\"label\":_vm.$t('label.isfeatured')}},[_c('a-switch',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['isfeatured', {\n            initialValue: false\n          }]),expression:\"['isfeatured', {\\n            initialValue: false\\n          }]\"}]})],1),_c('div',{staticClass:\"action-button\",attrs:{\"span\":24}},[_c('a-button',{on:{\"click\":_vm.closeAction}},[_vm._v(_vm._s(this.$t('label.cancel')))]),_c('a-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},on:{\"click\":_vm.handleSubmit}},[_vm._v(_vm._s(this.$t('label.ok')))])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n<template>\n  <div class=\"form-layout\">\n    <span v-if=\"uploadPercentage > 0\">\n      <a-icon type=\"loading\" />\n      {{ $t('message.upload.file.processing') }}\n      <a-progress :percent=\"uploadPercentage\" />\n    </span>\n    <a-spin :spinning=\"loading\" v-else>\n      <a-form\n        :form=\"form\"\n        @submit=\"handleSubmit\"\n        layout=\"vertical\">\n        <a-form-item v-if=\"currentForm === 'Create'\" :label=\"$t('label.url')\">\n          <a-input\n            autoFocus\n            v-decorator=\"['url', {\n              rules: [{ required: true, message: `${this.$t('label.upload.iso.from.local')}` }]\n            }]\"\n            :placeholder=\"apiParams.url.description\" />\n        </a-form-item>\n        <a-form-item v-if=\"currentForm === 'Upload'\" :label=\"$t('label.templatefileupload')\">\n          <a-upload-dragger\n            :multiple=\"false\"\n            :fileList=\"fileList\"\n            :remove=\"handleRemove\"\n            :beforeUpload=\"beforeUpload\"\n            v-decorator=\"['file', {\n              rules: [{ required: true, message: `${this.$t('message.error.required.input')}` }]\n            }]\">\n            <p class=\"ant-upload-drag-icon\">\n              <a-icon type=\"cloud-upload\" />\n            </p>\n            <p class=\"ant-upload-text\" v-if=\"fileList.length === 0\">\n              {{ $t('label.volume.volumefileupload.description') }}\n            </p>\n          </a-upload-dragger>\n        </a-form-item>\n        <a-form-item :label=\"$t('label.name')\">\n          <a-input\n            v-decorator=\"['name', {\n              rules: [{ required: true, message: `${this.$t('message.error.required.input')}` }]\n            }]\"\n            :placeholder=\"apiParams.name.description\" />\n        </a-form-item>\n\n        <a-form-item :label=\"$t('label.displaytext')\">\n          <a-input\n            v-decorator=\"['displaytext', {\n              rules: [{ required: true, message: `${this.$t('message.error.required.input')}` }]\n            }]\"\n            :placeholder=\"apiParams.displaytext.description\" />\n        </a-form-item>\n\n        <a-form-item v-if=\"allowed && currentForm !== 'Upload'\" :label=\"$t('label.directdownload')\">\n          <a-switch v-decorator=\"['directdownload']\"/>\n        </a-form-item>\n\n        <a-form-item :label=\"$t('label.zoneid')\">\n          <a-select\n            v-decorator=\"['zoneid', {\n              initialValue: this.selectedZone,\n              rules: [\n                {\n                  required: true,\n                  message: `${this.$t('message.error.select')}`\n                }\n              ]\n            }]\"\n            showSearch\n            optionFilterProp=\"children\"\n            :filterOption=\"(input, option) => {\n              return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n            }\"\n            :loading=\"zoneLoading\"\n            :placeholder=\"apiParams.zoneid.description\">\n            <a-select-option :value=\"opt.id\" v-for=\"opt in zones\" :key=\"opt.id\">\n              {{ opt.name || opt.description }}\n            </a-select-option>\n          </a-select>\n        </a-form-item>\n\n        <a-form-item :label=\"$t('label.bootable')\">\n          <a-switch\n            v-decorator=\"['bootable', {\n              initialValue: true,\n            }]\"\n            :checked=\"bootable\"\n            @change=\"val => bootable = val\"/>\n        </a-form-item>\n\n        <a-form-item v-if=\"bootable\" :label=\"$t('label.ostypeid')\">\n          <a-select\n            v-decorator=\"['ostypeid', {\n              initialValue: defaultOsType,\n              rules: [{ required: true, message: `${this.$t('message.error.select')}` }]\n            }]\"\n            showSearch\n            optionFilterProp=\"children\"\n            :filterOption=\"(input, option) => {\n              return option.componentOptions.children[0].text.toLowerCase().indexOf(input.toLowerCase()) >= 0\n            }\"\n            :loading=\"osTypeLoading\"\n            :placeholder=\"apiParams.ostypeid.description\">\n            <a-select-option :value=\"opt.id\" v-for=\"(opt, optIndex) in osTypes\" :key=\"optIndex\">\n              {{ opt.name || opt.description }}\n            </a-select-option>\n          </a-select>\n        </a-form-item>\n\n        <a-form-item :label=\"$t('label.isextractable')\">\n          <a-switch\n            v-decorator=\"['isextractable', {\n              initialValue: false\n            }]\" />\n        </a-form-item>\n\n        <a-form-item\n          :label=\"$t('label.ispublic')\"\n          v-if=\"$store.getters.userInfo.roletype === 'Admin' || $store.getters.features.userpublictemplateenabled\" >\n          <a-switch\n            v-decorator=\"['ispublic', {\n              initialValue: false\n            }]\" />\n        </a-form-item>\n\n        <a-form-item :label=\"$t('label.isfeatured')\">\n          <a-switch\n            v-decorator=\"['isfeatured', {\n              initialValue: false\n            }]\" />\n        </a-form-item>\n\n        <div :span=\"24\" class=\"action-button\">\n          <a-button @click=\"closeAction\">{{ this.$t('label.cancel') }}</a-button>\n          <a-button :loading=\"loading\" type=\"primary\" @click=\"handleSubmit\">{{ this.$t('label.ok') }}</a-button>\n        </div>\n      </a-form>\n    </a-spin>\n  </div>\n</template>\n\n<script>\nimport { api } from '@/api'\nimport store from '@/store'\nimport { axios } from '../../utils/request'\n\nexport default {\n  name: 'RegisterIso',\n  props: {\n    resource: {\n      type: Object,\n      required: true\n    },\n    action: {\n      type: Object,\n      required: true\n    }\n  },\n  data () {\n    return {\n      fileList: [],\n      zones: [],\n      osTypes: [],\n      zoneLoading: false,\n      osTypeLoading: false,\n      defaultOsType: '',\n      loading: false,\n      allowed: false,\n      bootable: true,\n      selectedZone: '',\n      uploadParams: null,\n      uploadPercentage: 0,\n      currentForm: this.action.currentAction.icon === 'plus' ? 'Create' : 'Upload'\n    }\n  },\n  beforeCreate () {\n    this.form = this.$form.createForm(this)\n    this.apiConfig = this.$store.getters.apis.registerIso || {}\n    this.apiParams = {}\n    this.apiConfig.params.forEach(param => {\n      this.apiParams[param.name] = param\n    })\n  },\n  created () {\n    this.zones = []\n    if (this.$store.getters.userInfo.roletype === 'Admin' && this.currentForm === 'Create') {\n      this.zones = [\n        {\n          id: '-1',\n          name: this.$t('label.all.zone')\n        }\n      ]\n    }\n  },\n  mounted () {\n    this.fetchData()\n  },\n  methods: {\n    fetchData () {\n      this.fetchZoneData()\n      this.fetchOsType()\n    },\n    fetchZoneData () {\n      const params = {}\n      params.listAll = true\n\n      this.zoneLoading = true\n      if (store.getters.userInfo.roletype === this.rootAdmin) {\n        this.allowed = true\n      }\n      api('listZones', params).then(json => {\n        const listZones = json.listzonesresponse.zone\n        this.zones = this.zones.concat(listZones)\n      }).finally(() => {\n        this.zoneLoading = false\n        this.selectedZone = (this.zones[0].id ? this.zones[0].id : '')\n      })\n    },\n    fetchOsType () {\n      const params = {}\n      params.listAll = true\n\n      this.osTypeLoading = true\n\n      api('listOsTypes', params).then(json => {\n        const listOsTypes = json.listostypesresponse.ostype\n        this.osTypes = this.osTypes.concat(listOsTypes)\n      }).finally(() => {\n        this.osTypeLoading = false\n        this.defaultOsType = this.osTypes[0].id\n      })\n    },\n    handleRemove (file) {\n      const index = this.fileList.indexOf(file)\n      const newFileList = this.fileList.slice()\n      newFileList.splice(index, 1)\n      this.fileList = newFileList\n    },\n    beforeUpload (file) {\n      this.fileList = [file]\n      return false\n    },\n    handleUpload () {\n      const { fileList } = this\n      if (this.fileList.length > 1) {\n        this.$notification.error({\n          message: this.$t('message.upload.iso.failed'),\n          description: this.$t('message.error.upload.iso.description'),\n          duration: 0\n        })\n      }\n      const formData = new FormData()\n      fileList.forEach(file => {\n        formData.append('files[]', file)\n      })\n      this.uploadPercentage = 0\n      axios.post(this.uploadParams.postURL,\n        formData,\n        {\n          headers: {\n            'Content-Type': 'multipart/form-data',\n            'X-signature': this.uploadParams.signature,\n            'X-expires': this.uploadParams.expires,\n            'X-metadata': this.uploadParams.metadata\n          },\n          onUploadProgress: (progressEvent) => {\n            this.uploadPercentage = Number(parseFloat(100 * progressEvent.loaded / progressEvent.total).toFixed(1))\n          },\n          timeout: 86400000\n        }).then((json) => {\n        this.$notification.success({\n          message: this.$t('message.success.upload'),\n          description: this.$t('message.success.upload.description')\n        })\n        this.closeAction()\n        this.$emit('refresh-data')\n      }).catch(e => {\n        this.$notification.error({\n          message: this.$t('message.upload.failed'),\n          description: `${this.$t('message.upload.iso.failed.description')} -  ${e}`,\n          duration: 0\n        })\n      })\n    },\n    handleSubmit (e) {\n      e.preventDefault()\n      this.form.validateFields((err, values) => {\n        if (err) {\n          return\n        }\n        const params = {}\n        for (const key in values) {\n          const input = values[key]\n          if (input === undefined) {\n            continue\n          }\n          if (key === 'file') {\n            continue\n          }\n          switch (key) {\n            case 'zoneid':\n              var zone = this.zones.filter(zone => zone.id === input)\n              params[key] = zone[0].id\n              break\n            case 'ostypeid':\n              params[key] = input\n              break\n            default:\n              params[key] = input\n              break\n          }\n        }\n\n        if (this.currentForm === 'Create') {\n          this.loading = true\n          api('registerIso', params).then(json => {\n            this.$notification.success({\n              message: this.$t('label.action.register.iso'),\n              description: `${this.$t('message.success.register.iso')} ${params.name}`\n            })\n            this.closeAction()\n            this.$emit('refresh-data')\n          }).catch(error => {\n            this.$notifyError(error)\n          }).finally(() => {\n            this.loading = false\n          })\n        } else {\n          if (this.fileList.length !== 1) {\n            return\n          }\n          params.format = 'ISO'\n          this.loading = true\n          api('getUploadParamsForIso', params).then(json => {\n            this.uploadParams = (json.postuploadisoresponse && json.postuploadisoresponse.getuploadparams) ? json.postuploadisoresponse.getuploadparams : ''\n            const response = this.handleUpload()\n            if (response === 'upload successful') {\n              this.$notification.success({\n                message: this.$t('message.success.upload'),\n                description: this.$t('message.success.upload.iso.description')\n              })\n            }\n          }).catch(error => {\n            this.$notifyError(error)\n          }).finally(() => {\n            this.loading = false\n            this.$emit('refresh-data')\n          })\n        }\n      })\n    },\n    closeAction () {\n      this.$emit('close-action')\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n  .form-layout {\n    width: 80vw;\n\n    @media (min-width: 700px) {\n      width: 550px;\n    }\n  }\n\n  .action-button {\n    text-align: right;\n\n    button {\n      margin-right: 5px;\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegisterOrUploadIso.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegisterOrUploadIso.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RegisterOrUploadIso.vue?vue&type=template&id=0d633d81&scoped=true&\"\nimport script from \"./RegisterOrUploadIso.vue?vue&type=script&lang=js&\"\nexport * from \"./RegisterOrUploadIso.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RegisterOrUploadIso.vue?vue&type=style&index=0&id=0d633d81&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0d633d81\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}