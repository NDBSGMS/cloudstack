(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13a7ac46"],{"0d96":function(e,t,a){"use strict";var s=a("ee3a"),o=a.n(s);o.a},aacc:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-layout"},[e.uploadPercentage>0?a("span",[a("a-icon",{attrs:{type:"loading"}}),e._v(" "+e._s(e.$t("message.upload.file.processing"))+" "),a("a-progress",{attrs:{percent:e.uploadPercentage}})],1):a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",{attrs:{form:e.form,layout:"vertical"},on:{submit:e.handleSubmit}},[a("a-form-item",{attrs:{label:e.$t("label.templatefileupload")}},[a("a-upload-dragger",{directives:[{name:"decorator",rawName:"v-decorator",value:["file",{rules:[{required:!0,message:""+this.$t("message.error.required.input")}]}],expression:"['file', {\n            rules: [{ required: true, message: `${this.$t('message.error.required.input')}`}]\n          }]"}],attrs:{multiple:!1,fileList:e.fileList,remove:e.handleRemove,beforeUpload:e.beforeUpload}},[a("p",{staticClass:"ant-upload-drag-icon"},[a("a-icon",{attrs:{type:"cloud-upload"}})],1),0===e.fileList.length?a("p",{staticClass:"ant-upload-text"},[e._v(" "+e._s(e.$t("label.volume.volumefileupload.description"))+" ")]):e._e()])],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.$t("label.name"))+" "),a("a-tooltip",{attrs:{title:e.apiParams.name.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:e.$t("message.error.volume.name")}]}],expression:"['name', {\n            rules: [{ required: true, message: $t('message.error.volume.name') }]\n          }]"}],attrs:{placeholder:e.$t("label.volumename")}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.$t("label.zone"))+" "),a("a-tooltip",{attrs:{title:e.apiParams.zoneid.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["zoneId",{initialValue:e.zoneSelected,rules:[{required:!0,message:""+this.$t("message.error.select")}]}],expression:"['zoneId', {\n            initialValue: zoneSelected,\n            rules: [\n              {\n                required: true,\n                message: `${this.$t('message.error.select')}`\n              }\n            ]\n          }]"}]},e._l(e.zones,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name||t.description)+" ")])})),1)],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.$t("label.format"))+" "),a("a-tooltip",{attrs:{title:e.apiParams.format.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["format",{initialValue:e.formats[0],rules:[{required:!1,message:""+this.$t("message.error.select")}]}],expression:"['format', {\n            initialValue: formats[0],\n            rules: [\n              {\n                required: false,\n                message: `${this.$t('message.error.select')}`\n              }\n            ]\n          }]"}]},e._l(e.formats,(function(t){return a("a-select-option",{key:t},[e._v(" "+e._s(t)+" ")])})),1)],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.$t("label.volumechecksum"))+" "),a("a-tooltip",{attrs:{title:e.apiParams.checksum.description}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.45)"},attrs:{type:"info-circle"}})],1)],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["checksum"],expression:"['checksum']"}],attrs:{placeholder:e.$t("label.volumechecksum.description")}})],1),a("div",{staticClass:"action-button",attrs:{span:24}},[a("a-button",{on:{click:e.closeAction}},[e._v(e._s(this.$t("label.cancel")))]),a("a-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(this.$t("label.ok")))])],1)],1)],1)],1)},o=[],i=(a("99af"),a("4160"),a("c975"),a("fb6a"),a("a434"),a("b0c0"),a("a9e3"),a("b6802"),a("d3b7"),a("159b"),a("d0ff")),r=a("365c"),l=a("b775"),n={name:"UploadLocalVolume",data:function(){return{fileList:[],zones:[],formats:["RAW","VHD","VHDX","OVA","QCOW2"],zoneSelected:"",uploadParams:null,loading:!1,uploadPercentage:0}},beforeCreate:function(){var e=this;this.form=this.$form.createForm(this),this.apiParams={};var t=this.$store.getters.apis.getUploadParamsForVolume||{};t.params.forEach((function(t){e.apiParams[t.name]=t}))},mounted:function(){this.listZones()},methods:{listZones:function(){var e=this;Object(r["a"])("listZones").then((function(t){t&&t.listzonesresponse&&t.listzonesresponse.zone&&(e.zones=t.listzonesresponse.zone,e.zones.length>0&&(e.zoneSelected=e.zones[0].id))}))},handleRemove:function(e){var t=this.fileList.indexOf(e),a=this.fileList.slice();a.splice(t,1),this.fileList=a},beforeUpload:function(e){return this.fileList=[].concat(Object(i["a"])(this.fileList),[e]),!1},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,a){if(!e){var s={};for(var o in a){var i=a[o];void 0!==i&&("file"!==o&&(s[o]=i))}Object(r["a"])("getUploadParamsForVolume",s).then((function(e){t.uploadParams=e.postuploadvolumeresponse&&e.postuploadvolumeresponse.getuploadparams?e.postuploadvolumeresponse.getuploadparams:"";var a=t.fileList;t.fileList.length>1&&t.$notification.error({message:t.$t("message.upload.volume.failed"),description:t.$t("message.upload.file.limit"),duration:0});var s=new FormData;a.forEach((function(e){s.append("files[]",e)})),t.loading=!0,t.uploadPercentage=0,l["b"].post(t.uploadParams.postURL,s,{headers:{"Content-Type":"multipart/form-data","X-signature":t.uploadParams.signature,"X-expires":t.uploadParams.expires,"X-metadata":t.uploadParams.metadata},onUploadProgress:function(e){t.uploadPercentage=Number(parseFloat(100*e.loaded/e.total).toFixed(1))},timeout:864e5}).then((function(e){t.$notification.success({message:t.$t("message.success.upload"),description:t.$t("message.success.upload.volume.description")}),t.closeAction()})).catch((function(e){t.$notification.error({message:t.$t("message.upload.failed"),description:"".concat(t.$t("message.upload.iso.failed.description")," -  ").concat(e),duration:0})})).finally((function(){t.loading=!1}))}))}}))},closeAction:function(){this.$emit("close-action")}}},c=n,u=(a("0d96"),a("2877")),m=Object(u["a"])(c,s,o,!1,null,"9edcc56c",null);t["default"]=m.exports},ee3a:function(e,t,a){}}]);
//# sourceMappingURL=chunk-13a7ac46.05131351.js.map